(window.webpackJsonp=window.webpackJsonp||[]).push([[5,8],{384:function(e,t,r){e.exports=r(768)()},412:function(e,t){e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}},424:function(e,t){e.exports=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}},425:function(e,t,r){var a=r(767);e.exports=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){a(e,t,r[t])}))}return e}},426:function(e,t){function r(){return e.exports=r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},r.apply(this,arguments)}e.exports=r},427:function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},482:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return c})),r.d(t,"exampleConfig",(function(){return u}));var a=r(170),n=r(16),o=r(362),i=r.n(o);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function l(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function c(e){let{children:t,className:r,isInline:a,isOptional:o,optionalLabel:c}=e,u=l(e,["children","className","isInline","isOptional","optionalLabel"]);return n.createElement("div",s({},u,{className:i()({"cl-field-label":!0,"cl-field-label--is-inline":a,"cl-field-label--is-optional":o},r)}),n.createElement("span",{className:"cl-field-label__content"},t),o&&n.createElement("span",{className:"cl-field-label__optional"},c))}c.defaultProps={isInline:!1,isOptional:!1,optionalLabel:Object(a.b)(e=>e.componentLibrary.form.fieldLabel.optionalLabel)};const u={fields:[{name:"isInline",desc:"Position the component inline with other elements (like a radio button)",value:{type:"boolean",default:c.defaultProps.isInline}},{name:"isOptional",desc:"Whether the field is optional",value:{type:"boolean",default:c.defaultProps.isOptional}},{name:"children",desc:"Content to be displayed within the component",value:{type:"jsx",default:"",transform:e=>n.createElement("span",{dangerouslySetInnerHTML:{__html:e}})}},{name:"optionalLabel",desc:"Content to be displayed within the component",value:{type:"jsx",default:c.defaultProps.optionalLabel,transform:e=>n.createElement("span",{dangerouslySetInnerHTML:{__html:e}})}}],examples:[{title:"Required",desc:"Label for a field which is required",props:{children:"Email Address"}},{title:"Optional (default)",desc:"Label for a field which is optional",props:{children:"Affiliation",isOptional:!0}},{title:"Optional (custom)",desc:"Label for a field which is optional",props:{children:"Affiliation",isOptional:!0,optionalLabel:"If you have one"}},{title:"Checkbox",desc:"Label for a checkbox",props:{children:"Checkbox",isInline:!0},render:e=>n.createElement("label",null,n.createElement("input",{type:"checkbox",className:"legacy__input",style:{marginRight:"7px"}}),e)}],events:{}}},524:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var a,n,o,i=r(7),s=r.n(i),l=r(16),c=r.n(l);class u extends l.PureComponent{render(){return c.a.createElement("div",{className:"container flex-row"},this.props.children)}}a=u,n="propTypes",o={children:s.a.array.isRequired},n in a?Object.defineProperty(a,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):a[n]=o},528:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var a,n,o,i=r(362),s=r.n(i),l=r(7),c=r.n(l),u=r(16),d=r.n(u);class h extends u.PureComponent{render(){const e=s()("main-column",this.props.className);return d.a.createElement("main",{className:e},this.props.children)}}a=h,n="propTypes",o={children:c.a.node,className:c.a.string},n in a?Object.defineProperty(a,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):a[n]=o},530:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var a,n,o,i=r(362),s=r.n(i),l=r(7),c=r.n(l),u=r(16),d=r.n(u);class h extends u.PureComponent{render(){const{side:e,className:t,children:r}=this.props;return d.a.createElement("section",{className:"sidebar sidebar-".concat(e)},d.a.createElement("div",{className:s()("column-wrapper",t)},r))}}a=h,n="propTypes",o={className:c.a.string,side:c.a.string.isRequired,children:c.a.node},n in a?Object.defineProperty(a,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):a[n]=o},607:function(e,t,r){"use strict";r.d(t,"a",(function(){return x}));var a=r(463),n=r(600),o=r(602),i=r(601),s=r(363),l=r(392),c=r(180),u=r(371),d=r(59),h=r(378),p=r(90),m=r(401),b=r(8),g=r(95),f=r(33),_=r(65),y=r(27),E=r(362),O=r.n(E),S=r(7),v=r.n(S),C=r(16),w=r.n(C);function P(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class x extends C.PureComponent{constructor(){super(...arguments),this.trackStatHoverEvent=this.trackStatHoverEvent.bind(this)}trackStatHoverEvent(e){const t=this.context.analyticsLocation;if(t){const{id:r,index:a}=this.props,n=p.a.getIn(t,"STAT");Object(_.a)(m.a.create(n,{statName:e,id:r,index:a}))}else b.a.warn("You need to add analyticsLocation to context so that we know where this action event happened.")}statCssClass(e){let t="search-result__stat";return this.props.showSortStat&&(t=O()("search-result__stat",{"is-active":this.context.queryStore.getQuery().sort===e})),t}renderCitationVelocity(){if(this.props.citationStats.citationVelocity.shouldDisplay()){const e=w.a.createElement(o.a,{width:350,id:this.props.id+"Popover",citationStats:this.props.citationStats,entityId:this.props.id,searchResultIndex:this.props.index});return w.a.createElement("li",{className:this.statCssClass(f.a.CITATION_VELOCITY.id),"data-selenium-selector":"search-result-citation-velocity"},w.a.createElement(l.a,{tooltipClassName:"tooltip--default-size",tooltipContent:e,tooltipPosition:"bottom-left",onShow:()=>{this.trackStatHoverEvent("Citation Velocity")}},w.a.createElement(s.a,{width:"15",height:"15",icon:"chart",className:"fill--orange"}),h.f(this.props.citationStats.citationVelocity)))}return null}renderInfluentialCitations(){if(this.props.citationStats.hasKeyCitations()){const e=this.props.citationStats.numKeyCitations,t=d.a.getString("citations.influential.text"),r=y.l(e,d.a.getString("citations.influential.label")),n=w.a.createElement(w.a.Fragment,null,w.a.createElement("h4",null,r),w.a.createElement(u.a,{content:t}));return w.a.createElement("li",{className:this.statCssClass(f.a.INFLUENTIAL_CITATIONS.id),"data-selenium-selector":"search-result-influential-citations"},w.a.createElement(l.a,{tooltipClassName:"tooltip--default-size",className:"flex-row-vcenter",tooltipContent:n,tooltipPosition:"bottom-left",onShow:()=>{this.trackStatHoverEvent(a.INFLUENTIAL_CITATIONS)},seleniumSelector:"influential-citations-stat"},w.a.createElement(s.a,{icon:"theorems",width:"12",height:"12",className:"fill--orange"}),y.e(this.props.citationStats.numKeyCitations)))}return null}renderCitationAcceleration(){if(this.props.citationStats.citationAcceleration.shouldDisplay()){const e=this.props.citationStats.citationAcceleration.value,t=w.a.createElement(n.a,{width:350,id:this.props.id+"Popover",citationStats:this.props.citationStats,entityId:this.props.id,searchResultIndex:this.props.index});let r="trending-neutral";return e>0&&(r="trending-up"),e<0&&(r="trending-down"),w.a.createElement("li",{className:this.statCssClass(f.a.CITATION_ACCELERATION.id),"data-selenium-selector":"search-result-citation-acceleration"},w.a.createElement(l.a,{tooltipClassName:"tooltip--default-size",tooltipContent:t,tooltipPosition:"bottom-left",onShow:()=>{this.trackStatHoverEvent("Citation Acceleration")}},w.a.createElement(s.a,{icon:r,width:"15",height:"15",className:"fill--orange"}),h.e(e)))}return null}renderTotalCitations(){const e=this.props.citationStats.numCitations>0?w.a.createElement(i.a,{width:350,id:this.props.id+"Popover",citationStats:this.props.citationStats,entityId:this.props.id,searchResultIndex:this.props.index}):null,t=w.a.createElement(w.a.Fragment,null,w.a.createElement(s.a,{icon:"scorecard-cited-by",width:"12",height:"12",className:"fill--orange"}),h.g(this.props.citationStats.numCitations));return w.a.createElement("li",{className:this.statCssClass(f.a.TOTAL_CITATIONS.id),"data-selenium-selector":"search-result-total-citations"},w.a.createElement(l.a,{tooltipClassName:"tooltip--default-size",className:"flex-row-vcenter",tooltipContent:e,onShow:()=>{this.trackStatHoverEvent(a.TOTAL_CITATIONS)},tooltipPosition:"bottom-left",seleniumSelector:"total-citations-stat"},t))}renderSortStat(){if(!this.props.showSortStat)return null;switch(this.context.queryStore.getQuery().sort){case f.a.CITATION_ACCELERATION.id:return this.renderCitationAcceleration();case f.a.INFLUENTIAL_CITATIONS.id:return this.renderInfluentialCitations();case f.a.CITATION_VELOCITY.id:return this.renderCitationVelocity();default:return null}}render(){return this.props.citationStats.numCitations>0?w.a.createElement("div",{className:"search-result__stats flex-row"},this.renderTotalCitations(),this.renderSortStat()):null}}P(x,"propTypes",{citationStats:v.a.object.isRequired,id:v.a.string.isRequired,index:v.a.number.isRequired,showSortStat:v.a.bool,externalContentStats:v.a.objectOf(c.a)}),P(x,"contextTypes",{queryStore:v.a.instanceOf(g.a).isRequired,analyticsLocation:v.a.object})},678:function(e,t,r){"use strict";var a,n,o,i=r(605),s=r(606),l=r(363),c=r(382),u=r(443),d=r(362),h=r.n(d),p=r(7),m=r.n(p),b=r(16),g=r.n(b);class f extends b.PureComponent{constructor(){super(...arguments),this.state={showMenu:!1}}triggerDropdownMenu(){this.setState({showMenu:!this.state.showMenu})}render(){const e=h()("icon-button dropdown-button dropdown-button--left-anchored",this.props.className);return g.a.createElement("span",{className:e,"data-selenium-selector":this.props.seleniumSelector},g.a.createElement("span",{className:"dropdown-button__content"},this.props.buttonContent),g.a.createElement(u.a,{content:this.props.dropdownContent,showMenu:this.state.showMenu},g.a.createElement("span",{className:"icon-wrapper"},g.a.createElement(l.a,{icon:"disclosure",width:"12",height:"12",className:"icon--down"}))))}}a=f,n="propTypes",o={buttonContent:m.a.node.isRequired,className:m.a.string,dropdownContent:m.a.node.isRequired,seleniumSelector:m.a.string.isRequired},n in a?Object.defineProperty(a,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):a[n]=o;var _=r(365),y=r(171),E=r(428),O=r(128),S=r(44),v=r(20);function C(){return(C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function w(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P(e){let t;switch(e){case O.a.ARXIV:case O.a.S2:case O.a.EDUCAUSE:t="fa-pdf";break;default:t="fa-link-out"}return{icon:t,width:"15",height:"15"}}class x extends b.PureComponent{getLinkClickHandler(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const{onLinkClick:a}=this.props;return()=>{a(...t)}}getPropsForLink(e){let{linkType:t,url:r}=e;return{onClick:this.getLinkClickHandler({linkType:t,linkUrl:r}),onContextMenu:this.getLinkClickHandler({linkType:t,linkUrl:r,isRightClick:!0}),target:"_blank",href:r}}getPrimaryExternalLink(){const{paper:e,className:t}=this.props,r=e.links.first(),a=E.d(r.url);return g.a.createElement(_.b,{heapProps:{id:y.v,"link-type":r.linkType,"direct-pdf-link":a,"unpaywall-link":!1,"primary-link":!0,"paper-id":e.id}},g.a.createElement(c.a,C({tagName:"a",className:h()("paper-link",t),iconProps:P(r.linkType),seleniumSelector:"paper-link",text:E.c(r)},this.getPropsForLink(r))))}getExternalLink(e){const t=E.c(e);return g.a.createElement("li",{key:e.url},g.a.createElement("a",C({"data-selenium-selector":"paper-link",className:"flex-row-vcenter paper-link"},this.getPropsForLink(e)),g.a.createElement(l.a,P(e.linkType)),t))}getExternalLinkList(e){return g.a.createElement("ul",{className:"paper-link-list truncate-line"},e.map(e=>this.getExternalLink(e)))}renderLinks(e,t){return t.isEmpty()?e:g.a.createElement(f,{buttonContent:e,className:h()("paper-link-dropdown",this.props.className),dropdownContent:this.getExternalLinkList(t),seleniumSelector:"paper-links-dropdown"})}render(){const{paper:{links:e}}=this.props;return e.isEmpty()?null:this.renderLinks(this.getPrimaryExternalLink(),e.slice(1))}}w(x,"contextTypes",{dispatcher:m.a.instanceOf(v.a).isRequired}),w(x,"propTypes",{className:m.a.string,paper:m.a.instanceOf(S.b),onLinkClick:m.a.func.isRequired});var R=r(403),N=r(32),j=r(95),T=r(94),A=r(104),I=r(3),F=r.n(I);function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){L(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function L(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,"a",(function(){return M}));class M extends b.PureComponent{constructor(){super(...arguments),L(this,"getBaseClickContext",()=>{const{paper:e,rowIndex:t}=this.props,r=[this.context.queryStore,{paperSha:e.id,paperIndex:t}];return Object(A.a)(...r)}),L(this,"handleCiteClick",()=>{const{trackActionClick:e,paper:t}=this.props;Object(A.d)(D({},this.getBaseClickContext())),e("CITE"),this.context.dispatcher.dispatch(Object(T.b)({id:N.b.CITE,data:t}))}),L(this,"handlePaperLinkClick",e=>{var t,r;const{paper:a}=this.props;F()(a.primaryPaperLink&&"object"==typeof a.primaryPaperLink,"handlePaperLinkClick called without primaryPaperLink"),Object(A.f)(D({},this.getBaseClickContext(),{linkType:null!=(r=a)&&null!=(r=r.primaryPaperLink)?r.linkType:r,linkUrl:null!=(t=a)&&null!=(t=t.primaryPaperLink)?t.url:t})),this.props.trackActionClick("PAPER_LINK",e)}),L(this,"handleLibraryClick",()=>{Object(A.e)(D({},this.getBaseClickContext()))})}render(){const{trackActionClick:e,paper:t}=this.props;return b.createElement("div",{className:"paper-actions flex-row"},b.createElement(x,{onLinkClick:this.handlePaperLinkClick,paper:t}),b.createElement(i.a,{paper:t,onClick:this.handleCiteClick}),b.createElement(R.b,{paper:t,onSaveClick:this.handleLibraryClick,trackLibraryClick:e}),b.createElement(s.a,{paper:t}))}}L(M,"contextTypes",{dispatcher:m.a.instanceOf(v.a).isRequired,queryStore:m.a.instanceOf(j.a).isRequired})},767:function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},768:function(e,t,r){"use strict";var a=r(769);function n(){}function o(){}o.resetWarningCache=n,e.exports=function(){function e(e,t,r,n,o,i){if(i!==a){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:n};return r.PropTypes=r,r}},769:function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},772:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return E}));var a=r(16),n=r(376),o=r(7),i=r.n(o),s=r(17),l=r(387),c=r(148),u=r(363),d=r(129),h=r(502),p=r(65),m=r(401);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const _=n.a.div.withConfig({displayName:"FeedScoredAuthorOverview__Bar",componentId:"sc-1o0ppv4-0"})(["border:0px;height:30px;width:50%;margin:"," 2.5% 0px;background-color:black;float:left;cursor:pointer;background:-webkit-linear-gradient(left,"," ",",white 0%);background:-moz-linear-gradient(left,"," ",",white 0%);background:-ms-linear-gradient(left,"," ",",white 0%});background:linear-gradient(left,"," ",",white 0%);.infoIcon{margin:7.5px 0 0;}"],e=>{let{marginTop:t="15px"}=e;return"".concat(t,"px")},e=>{let{colorValue:t="#555"}=e;return t},e=>{let{widthPercent:t="0%"}=e;return"".concat(t,"%")},e=>{let{colorValue:t="#555"}=e;return t},e=>{let{widthPercent:t="0%"}=e;return"".concat(t,"%")},e=>{let{colorValue:t="#555"}=e;return t},e=>{let{widthPercent:t="0%"}=e;return"".concat(t,"%")},e=>{let{colorValue:t="#555"}=e;return t},e=>{let{widthPercent:t="0%"}=e;return"".concat(t,"%")}),y=n.a.div.withConfig({displayName:"FeedScoredAuthorOverview__BarTitle",componentId:"sc-1o0ppv4-1"})(["border:0px;width:40%;margin:"," 2.5% 0px;float:left;font-size:16px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;"],e=>{let{marginTop:t="20px"}=e;return"".concat(t,"px")});class E extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.state=g({},this.getStateFromAllAuthorsStore(),{},this.getStateFromFeedListStore()),this.context.allAuthorsPerPageStore.registerComponent(this,()=>{this.setState(this.getStateFromAllAuthorsStore())}),this.context.feedListStore.registerComponent(this,()=>{this.setState(this.getStateFromFeedListStore)})}getStateFromAllAuthorsStore(){const e=this.context.allAuthorsPerPageStore,t=parseInt(this.props.authorId,10);return{feedScoredResults:e.getFeedScoredPaperIdsState(t)}}getStateFromFeedListStore(){const e=this.context.feedListStore;return{isFeedListLoading:e.isLoading(),feeds:Array.from(e.getFeeds())}}componentDidMount(){e(()=>this.getFeeds())}componentDidUpdate(e,t){t.feeds.length!==this.state.feeds.length&&this.state.feeds.length>0&&this.setState(g({},this.getStateFromAllAuthorsStore()))}async getFeeds(){if(this.context.feedListStore.isUninitialized()){const e=this.context.feedApi,t=await e.getFeeds();this.setState(g({feeds:t.resultData},this.getStateFromAllAuthorsStore()))}else this.state.isFeedListLoading||this.setState(g({},this.getStateFromAllAuthorsStore()))}renderToolTipExplanation(e,t){return e?a.createElement("p",null,"This author is related to this feed ",a.createElement("br",null)," because of the following topics: ",a.createElement("br",null)," ",a.createElement("strong",null,t)," "):a.createElement("div",{style:{width:150}},a.createElement("p",null,"Insufficient feed data. Please rate at least 5 positive and 3 negative papers for this feed."))}renderAuthorOverviewFeedBar(e,t,r,n,o){const i=h.a,s=this.props.authorId;return t>=this.state.feeds.length?null:a.createElement("div",{key:t},0===t?a.createElement(y,{marginTop:20}," ",e," "):a.createElement(y,{marginTop:5}," ",e," "),0===n?0===t?a.createElement(l.default,{placement:l.PLACEMENT.RIGHT,tooltipContent:this.renderToolTipExplanation(!0,o),onMouseEnter:()=>{Object(p.a)(m.a.create("ahpFeedsExperiment.authorOverview",{authorId:s}))}},a.createElement(_,{widthPercent:r>=100?100:r,colorValue:i[t],marginTop:15})):a.createElement(l.default,{placement:l.PLACEMENT.RIGHT,tooltipContent:this.renderToolTipExplanation(!0,o),onMouseEnter:()=>{Object(p.a)(m.a.create("ahpFeedsExperiment.authorOverview",{authorId:s}))}},a.createElement(_,{widthPercent:r>=100?100:r,colorValue:i[t],marginTop:0})):0===t?a.createElement(l.default,{placement:l.PLACEMENT.RIGHT,tooltipContent:this.renderToolTipExplanation(!1),onMouseEnter:()=>{Object(p.a)(m.a.create("ahpFeedsExperiment.authorOverview",{authorId:s}))}},a.createElement(_,{widthPercent:100,colorValue:"#f5f6f7",marginTop:15},a.createElement("div",{className:"infoIcon"},a.createElement(u.a,{icon:"information",style:{width:15,height:15}})))):a.createElement(l.default,{placement:l.PLACEMENT.RIGHT,tooltipContent:this.renderToolTipExplanation(!1),onMouseEnter:()=>{Object(p.a)(m.a.create("ahpFeedsExperiment.authorOverview",{authorId:s}))}},a.createElement(_,{widthPercent:100,colorValue:"#f5f6f7",marginTop:0},a.createElement("div",{className:"infoIcon"},a.createElement(u.a,{icon:"information",style:{width:15,height:15}})))))}render(){const e=this.context.allAuthorsPerPageStore,t=parseInt(this.props.authorId,10);if(0===this.state.feeds.length)return a.createElement("h4",null,"Loading...");if(this.state.feedScoredResults.scoredPaperIds.length!==this.state.feeds.length)return a.createElement("h4",null,"Loading...");{e.setStateLoadedForAuthorId(t);const r=e.getFeedScoredPaperIdsState(t).scoredPaperIds;r.sort((e,t)=>e[0]-t[0]);const n=new Map(r.map(e=>[e[0],[e[1].map(e=>e.score>=0?1:0).reduce((function(e,t){return e+t})),e[2]]])),o=new Map;for(const e of r){const t=new Map;for(const r of e[1])for(const e of r.explanation)if(t.has(e.word)){const r=t.get(e.word);t.set(e.word,r+e.score)}else t.set(e.word,e.score);o.set(e[0],t)}const i=new Map;for(let[e,t]of o){const r=new Map([...t.entries()].sort((e,t)=>t[1]-e[1]));i.set(e,Array.from(r.keys()).slice(0,3).join(", "))}const s=new Map(this.state.feeds.map(e=>[e.id,e.name]));switch(this.props.displayScale){case"log":return a.createElement("div",null,a.createElement("h2",{style:{marginBottom:0,textAlign:"center"}},"Author Overview"),r.map((e,t)=>this.renderAuthorOverviewFeedBar(s.get(e[0]),t,0!==n.get(e[0])[0]?100*Math.log10(n.get(e[0])[0])/Math.log10(this.props.displayScaleMaxValue):0,n.get(e[0])[1],i.get(e[0]))));case"count":return a.createElement("div",null,a.createElement("h2",{style:{marginBottom:0,textAlign:"center"}},"Author Overview"),r.map((e,t)=>this.renderAuthorOverviewFeedBar(s.get(e[0]),t,0!==n.get(e[0])[0]?100*n.get(e[0])[0]/this.props.displayScaleMaxValue:0,n.get(e[0])[1],i.get(e[0]))))}return null}}}f(E,"contextTypes",{feedApi:i.a.instanceOf(s.a).isRequired,feedListStore:i.a.instanceOf(d.a).isRequired,allAuthorsPerPageStore:i.a.instanceOf(c.a).isRequired})}).call(this,r(457).setImmediate)},773:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return f}));var a=r(16),n=r(7),o=r.n(n),i=r(17),s=r(0),l=r.n(s),c=r(774),u=r(44),d=r(129),h=r(775),p=r(65),m=r(366);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class f extends a.Component{constructor(e,t){super(e,t),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({relevanceBasedPapers:[],feedBasedSortPapers:[],recencySortPapers:[],currentSort:"Highly Influential Citations"},this.getStateFromFeedListStore()),this.context.feedListStore.registerComponent(this,()=>{this.setState(this.getStateFromFeedListStore)})}getStateFromFeedListStore(){const{feedListStore:e}=this.context;return{isFeedListLoading:e.isLoading(),feeds:Array.from(e.getFeeds())}}componentDidMount(){e(()=>this.getFeeds())}componentDidUpdate(e,t){t.feeds.length!==this.state.feeds.length&&this.state.feeds.length>0&&this.getAuthorPapersForSorting()}async getFeeds(){const{feedListStore:e}=this.context;if(e.isUninitialized()){const{feedApi:e}=this.context,t=await e.getFeeds();this.setState({feeds:t.resultData},()=>{this.getAuthorPapersForSorting()})}else this.state.isFeedListLoading||this.getAuthorPapersForSorting()}getFeedIdByName(e){return[...new Map(this.state.feeds.map(e=>[e.id,e.name])).entries()].filter(t=>{let{1:r}=t;return r===e}).map(e=>{let[t]=e;return t})[0]}getPapersForRecencySort(){const{feedApi:e}=this.context,t=this.state.feeds[0].id;e.rerankAuthorPapersByFeed(t,this.props.authorId,"Paper").then(e=>this.setState({recencySortPapers:e.resultData.scoredPapers}))}getAuthorPapersForSorting(){if(0!==this.state.feeds.length){const{feedApi:e}=this.context;if("Highly Influential Citations"===this.state.currentSort)this.setState({relevanceBasedPapers:Array.from(this.props.results)});else if("Recency"===this.state.currentSort)this.getPapersForRecencySort();else{this.setState({feedBasedSortPapers:[]});const t=this.getFeedIdByName(this.state.currentSort);e.rerankAuthorPapersByFeed(t,this.props.authorId,"Paper").then(e=>this.setState({feedBasedSortPapers:e.resultData.scoredPapers}))}}}onChangeSort(e){const t="string"==typeof e?e:e.target.value;this.setState({currentSort:t},()=>this.getAuthorPapersForSorting()),Object(p.a)(m.a.create("ahpFeedsExperiment.sort",{sortName:t}))}sortPapersByRecency(){let e=new Map;for(const t of this.state.recencySortPapers){const r=t.paper.id,a=parseInt(t.paper.year.text,10),n=t.paper.earliestAcquisitionsDate;if(e.has(a)){let t=e.get(a);Array.isArray(t)||(t=[]),t.push([r,n]),e.set(a,t)}else e.set(a,[[r,n]])}const t=new Map(this.state.recencySortPapers.map(e=>[e.paper.id,e.paper])),r=new Map([...e.entries()].sort((function(e,t){return t[0]-e[0]})));let a=[];for(const e of r.keys()){let n=r.get(e);Array.isArray(n)||(n=[]),n.sort((function(e,t){return t[1]-e[1]})),r.set(e,n);for(const e of n)a.push(t.get(e[0]))}return a}sortByCurrentSortOption(e){const t=(this.props.query.page-1)*this.props.query.pageSize;if("Highly Influential Citations"===this.state.currentSort)return this.renderSort(this.props.results,e);if("Recency"===this.state.currentSort){if(0===this.state.recencySortPapers.length)return a.createElement("h2",null,"Loading...");let r=this.sortPapersByRecency().slice(t,t+10);return r=l.a.List(r.map(e=>u.b.fromJs(e))),this.renderSort(r,e)}{if(0===this.state.feedBasedSortPapers.length)return a.createElement("h2",null,"Loading...");let r=this.state.feedBasedSortPapers.slice(t,t+10);return r=r.map(e=>e.paper),r=l.a.List(r.map(e=>u.b.fromJs(e))),this.renderSort(r,e)}}renderSort(e,t){return a.createElement("div",null,a.createElement("div",{style:{display:"flex",alignItems:"right"}},a.createElement(c.a,{currentSort:this.state.currentSort,sortOptions:t,onChangeFunc:this.onChangeSort.bind(this)})),a.createElement(h.a,{results:e,authorId:this.props.authorId,query:this.props.query,layout:this.props.layout,maxFeedsToDisplay:this.props.maxFeedsToDisplay}))}render(){let e=["Highly Influential Citations","Recency"];return this.state.feeds.map(t=>e.push(t.name)),this.state.isFeedListLoading?a.createElement("h2",null,"Loading..."):this.sortByCurrentSortOption(e)}}g(f,"contextTypes",{feedApi:o.a.instanceOf(i.a).isRequired,feedListStore:o.a.instanceOf(d.a).isRequired})}).call(this,r(457).setImmediate)},774:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var a=r(16),n=r(362),o=r.n(n);class i extends a.PureComponent{handleChangeSort(e){const t="string"==typeof e?e:e.target.value;this.props.onChangeFunc(t)}render(){const{className:e}=this.props,t=o()(e,"search-sort flex-row-vcenter filter-bar__sort-selector");return a.createElement("div",{className:t,style:{marginBottom:10,marginTop:10,marginLeft:"Auto",marginRight:0}},a.createElement("select",{className:"legacy__select search-sort-select",onChange:this.handleChangeSort.bind(this),value:this.props.currentSort},this.props.sortOptions.map(e=>"Highly Influential Citations"!==e&&"Recency"!==e?a.createElement("option",{value:e,key:e},"Sort by Feed: ",e):a.createElement("option",{value:e,key:e},"Sort by ",e))))}}},775:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return d}));var a=r(16),n=r(7),o=r.n(n),i=r(776),s=r(17),l=(r(0),r(129));function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class d extends a.Component{constructor(e,t){super(e,t),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({scoredPapersMap:new Map,feedRelevanceThresholds:{}},this.getStateFromFeedListStore()),this.context.feedListStore.registerComponent(this,()=>{this.setState(this.getStateFromFeedListStore)})}getStateFromFeedListStore(){const e=this.context.feedListStore;return{isFeedListLoading:e.isLoading(),feeds:Array.from(e.getFeeds())}}componentDidMount(){e(()=>this.getFeeds())}componentDidUpdate(t,r){t.results!==this.props.results&&e(()=>this.getScoredCandidatePapers()),r.feeds.length!==this.state.feeds.length&&this.state.feeds.length>0&&this.getScoredCandidatePapers()}async getFeeds(){if(this.context.feedListStore.isUninitialized()){const e=this.context.feedApi,t=await e.getFeeds();this.setState({feeds:t.resultData},()=>{this.getScoredCandidatePapers()})}else this.state.isFeedListLoading||this.getScoredCandidatePapers()}getScoredCandidatePapers(){if(!this.state.isFeedListLoading){const e=this.context.feedApi,t=Array.from(this.props.results,e=>e.id);e.rerankCandidatePapersByFeed(t,!0).then(e=>this.setState({scoredPapersMap:new Map(e.resultData.multiscoredPapers.map(e=>[e.paperId,e.feedScores])),feedRelevanceThresholds:e.resultData.feedRelevanceThresholds}))}}renderFeedScoresAndExplanations(e){const t=this.state.feeds.map(e=>parseInt(e.id,10));t.sort();const r=[],a=[],n=this.state.scoredPapersMap.get(e.id);if(n){for(const e of t)if(e in n)if(void 0!==this.state.feedRelevanceThresholds[e]&&0===this.state.feedRelevanceThresholds[e]){const t=n[e].score<0?0:Math.min(.5*n[e].score/.05+.5,1),o=n[e].explanation.slice(0,3);r.push(t),a.push(o)}else r.push(0)}else{let e;for(e=0;e<t.length;e++)r.push(0)}return new Map([["score",r],["explanation",a]])}renderFeedScoreRow(){return a.createElement("div",null,this.props.results.map((e,t)=>a.createElement(i.a,{result:e,key:e.id,index:(this.props.query.page-1)*this.props.query.pageSize+t,layout:this.props.layout,ref:"search-result-".concat(t),scoresAndExplanations:this.renderFeedScoresAndExplanations(e),location:t,maxFeedsToDisplay:this.props.maxFeedsToDisplay})))}render(){return this.state.isFeedListLoading?null:0===this.state.scoredPapersMap.size?null:this.renderFeedScoreRow()}}u(d,"contextTypes",{feedApi:o.a.instanceOf(s.a).isRequired,feedListStore:o.a.instanceOf(l.a).isRequired})}).call(this,r(457).setImmediate)},776:function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var a=r(16),n=r(7),o=r.n(n),i=r(17),s=r(607),l=r(678),c=r(90),u=r(65),d=r(366),h=r(550),p=r(8),m=r(376),b=r(502),g=r(387);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const y=m.a.div.withConfig({displayName:"AHPFeedResult__Square",componentId:"sc-41175i-0"})(["border:0px;height:25px;width:25px;margin:5px 5px 0px auto;background-color:",";float:left;display:inline-block;"],e=>{let{colorValue:t="#555"}=e;return t}),E=m.a.div.withConfig({displayName:"AHPFeedResult__Score",componentId:"sc-41175i-1"})(["float:left;margin:0px 5px 0px;"]);class O extends a.Component{constructor(){super(...arguments),_(this,"trackActionClick",(e,t)=>{this.handleAnalyticsEvent("Action",e,t)})}handleAnalyticsEvent(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=this.context.analyticsLocation,{index:n,result:o}=this.props,i=o.id;if(a){const o=c.a.getIn(a,e,t),s=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){_(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},r,{index:n,paperId:i});Object(u.a)(d.a.create(o,s))}else p.a.warn("You need to add analyticsLocation to context so that we know where this action event happened.")}renderTooltipContent(e,t){return a.createElement("div",null,"This paper has a score of ",e," ",a.createElement("br",null)," because it discusses topics: ",a.createElement("br",null)," ",a.createElement("strong",null,t.join(", ")))}renderFeedScoresRow(){const e=b.a,{scoresAndExplanations:t}=this.props,r=void 0!==t.get("score")?t.get("score"):[];let n=[];if(void 0!==r)for(let e=0;e<r.length;e++){const a=Number(r[e].toFixed(1));if(a>0){const r=t.get("explanation")[e].map(e=>e.word);n.push([a,r,e])}}return n.length>this.props.maxFeedsToDisplay&&(n=n.slice(0,this.props.maxFeedsToDisplay)),a.createElement("div",{style:{display:"inline-flex",marginLeft:"auto"}},n.map(t=>a.createElement(g.default,{key:t[2],placement:g.PLACEMENT.TOP_LEFT,tooltipContent:this.renderTooltipContent(t[0],t[1])},a.createElement("div",{style:{width:70}},a.createElement(y,{colorValue:e[t[2]]}),a.createElement(E,null,a.createElement("p",null,t[0]))))))}render(){const{result:e,className:t,onTitleClick:r,children:n,index:o,layout:i}=this.props,c=a.createElement(a.Fragment,null,a.createElement(s.a,{citationStats:e.citationStats,externalContentStats:e.externalContentStats,id:e.id,index:o,showSortStat:i.showSortStat}),a.createElement(l.a,{paper:e,rowIndex:o,trackActionClick:this.trackActionClick}),this.renderFeedScoresRow());return a.createElement(h.a,{paper:e,index:o,onTitleClick:r,className:t,children:n,paperActions:c})}}_(O,"contextTypes",{feedApi:o.a.instanceOf(i.a).isRequired,analyticsLocation:o.a.object})},809:function(e,t,r){"use strict";r.r(t);var a=r(16),n=r.n(a);function o(e){let{children:t}=e;if(!t)return null;const r=a.Children.toArray(t);return a.createElement("div",{className:"account-bar"},a.createElement("div",{className:"account-bar__columns"},a.createElement("div",{className:"account-bar__column account-bar__left"},r.find(e=>e.type===i)),a.createElement("div",{className:"account-bar__column account-bar__message"},r.find(e=>e.type===l)),a.createElement("div",{className:"account-bar__column account-bar__right"},r.find(e=>e.type===s))))}function i(e){let{children:t}=e;return t}function s(e){let{children:t}=e;return t}function l(e){let{children:t}=e;return t}var c=r(372),u=r(373),d=r(482),h=r(483),p=r(371),m=r(363),b=r(182),g=r(485),f=r(170);var _=e=>{let{onCancel:t,onSubmit:r}=e;const[n,o]=a.useState(!1),[i,s]=a.useState("");function l(){return!!i&&b.a.test(i)}function _(){l&&(r(i),s(""))}return a.createElement("div",{className:"author-add-papers__paper"},a.createElement("div",{className:"author-add-papers__paper__remove-button",onClick:function(){s(""),t()}},a.createElement(m.a,{icon:"circle-plus"})),a.createElement("div",{className:"author-add-papers__paper__content"},a.createElement("div",{className:"author-add-papers__paper__section author-add-papers__paper__details"},a.createElement(d.default,{className:"author-add-papers__paper__title"},Object(f.b)(e=>e.authorAddPapers.indexRequests.add.urlField.label)),a.createElement("div",{className:"author-add-papers__index-request-form"},a.createElement("div",{className:"author-add-papers__index-request-form__inputs"},a.createElement(h.default,{placeholder:Object(f.b)(e=>e.authorAddPapers.indexRequests.add.urlField.placeholder),value:i,onChange:e=>s(e.target.value),onKeyDown:function(e){switch(e.keyCode){case g.a:e.preventDefault(),_()}}}),a.createElement(c.default,{className:"author-add-papers__index-request-form__add_btn",type:c.TYPE.PRIMARY,label:Object(f.b)(e=>e.authorAddPapers.indexRequests.add.submitButton),onClick:_,disabled:!l()})),n?a.createElement(a.Fragment,null,a.createElement("ol",{className:"author-add-papers__index-request-form__tips_list"},Object(f.c)(e=>e.authorAddPapers.indexRequests.add.tips).map(e=>a.createElement("li",null,a.createElement(p.a,{tag:"span",content:e})))),a.createElement(u.default,{icon:a.createElement(m.a,{icon:"square-minus",height:"10",width:"10"}),label:Object(f.b)(e=>e.authorAddPapers.indexRequests.add.hideTips),className:"author-add-papers__index-request-form__tips_btn",type:c.TYPE.TERTIARY,onClick:()=>o(!1)})):a.createElement(u.default,{icon:a.createElement(m.a,{icon:"square-plus",height:"10",width:"10"}),label:Object(f.b)(e=>e.authorAddPapers.indexRequests.add.expandTips),className:"author-add-papers__index-request-form__tips_btn",type:c.TYPE.TERTIARY,onClick:()=>o(!0)})))))},y=r(174);function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const v=e=>Object(y.b)(O({},e,{id:"author_add_paper_position_select"})),C=e=>Object(y.b)(O({},e,{},e,{id:"author_add_paper_position_unselect"}));var w=r(8);function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}class x extends a.PureComponent{constructor(){var e,t,r;super(...arguments),r=e=>{const{onChangePosition:t,position:r}=this.props;if(t)try{const a=JSON.parse(e.currentTarget.getAttribute("data-position")||"");a!==r&&t(a)}catch(e){w.a.error("failed to parse position",e)}},(t="onClickPosition")in(e=this)?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}render(){const{paper:e,position:t,reason:r,viewerFullName:n}=this.props;return a.createElement("div",{className:"author-add-papers__position__between"},e.authors.map(e=>e.alias.name).map((o,i)=>a.createElement(a.Fragment,{key:"".concat(e.id,"|").concat(o,"|").concat(i)},t===i?a.createElement(N,{viewerFullName:n,reason:r,position:i,onClick:this.onClickPosition}):a.createElement(R,{reason:r,position:i,onClick:this.onClickPosition}),a.createElement("div",{className:"author-add-papers__position__between__name"},o))),t===e.authors.size?a.createElement(N,{viewerFullName:n,reason:r,position:e.authors.size,onClick:this.onClickPosition}):a.createElement(R,{reason:r,position:e.authors.size,onClick:this.onClickPosition}))}}const R=e=>{let{reason:t,position:r,onClick:n}=e;return a.createElement("div",P({className:"author-add-papers__position__between__placement","data-position":r},v({reason:t,position:r}),{onClick:n}))},N=e=>{let{viewerFullName:t,reason:r,position:n,onClick:o}=e;return a.createElement("div",P({className:"author-add-papers__position__between__selected","data-position":"null"},C({reason:r,position:n}),{onClick:o}),a.createElement("div",{className:"author-add-papers__position__between__selected__author-name"},t),a.createElement("div",{className:"author-add-papers__position__you-tag"},Object(f.b)(e=>e.authorAddPapers.youTagLabel)))};function j(){return(j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}const T=Object.freeze({NOT_LISTED:"notListed",WRONG_AUTHOR:"wrongAuthor",WRONG_NAME:"wrongName"}),A=Object.freeze(Object.keys(T).map(e=>e)),I=Object.freeze(A.map(e=>T[e]));class F extends a.PureComponent{constructor(){var e,t,r;super(...arguments),r=()=>{const{reason:e,onSelect:t}=this.props;t(e)},(t="onClickReason")in(e=this)?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}render(){const{label:e,reason:t}=this.props;return a.createElement("div",j({},(r={reason:t},Object(y.b)(O({},r,{id:"author_add_paper_reason"}))),{className:"author-add-papers__position-reason"}),a.createElement("div",{className:"author-add-papers__position-reason__label",onClick:this.onClickReason},e));var r}}var k=r(362),D=r.n(k);function L(){return(L=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function M(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class q extends a.PureComponent{constructor(){super(...arguments),M(this,"onClickPosition",e=>{const{onChangePosition:t,position:r}=this.props;if(t)try{const a=JSON.parse(e.currentTarget.getAttribute("data-position")||"");a!==r&&t(a)}catch(e){w.a.error("failed to parse position",e)}})}render(){const{paper:e,position:t,reason:r,viewerFullName:n,showReplacedName:o}=this.props;return a.createElement("div",{className:"author-add-papers__position__replace"},e.authors.map(e=>e.alias.name).map((i,s)=>{const l=s===t,c=o||!l;return a.createElement("div",L({className:D()({"author-add-papers__position__replace__name":!0,"author-add-papers__position__replace__is-selected":l}),key:"".concat(e.id,"|").concat(i,"|").concat(s),"data-position":l?"null":s},l?C({reason:r,position:s}):v({reason:r,position:s}),{onClick:this.onClickPosition}),c&&a.createElement("div",{className:"author-add-papers__position__replace__name__author-name"},i),a.createElement("div",{className:"author-add-papers__position__replace__name__viewer-name"},n),a.createElement("div",{className:"author-add-papers__position__you-tag"},Object(f.b)(e=>e.authorAddPapers.youTagLabel)))}))}}M(q,"defaultProps",{showReplacedName:!1});var H=r(126),z=r(125),U=r(102),B=r(3),V=r.n(B),Y=r(7),W=r.n(Y);function K(){return(K=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function G(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class X extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),G(this,"onClickBack",()=>{const{onChangeReason:e}=this.props;e&&e(null)}),G(this,"onSelectReason",e=>{const{onChangeReason:t}=this.props;t&&t(e)}),G(this,"onSelectPosition",e=>{const{reason:t,onChangePosition:r}=this.props;r&&(V()(t,"reason was not selected before a position was"),r(t,e))}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){G(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthorProfileStore(),{},this.getStateFromAuthorCorrectionsStore(),{},this.getStateFromAuthorStore()),this.context.authorProfileStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorProfileStore())}),this.context.authorCorrectionsStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorCorrectionsStore())}),this.context.authorStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorStore())})}getStateFromAuthorProfileStore(){const{authorProfileStore:e}=this.context,t=e.getAuthorProfile();return{viewerFullName:t?t.fullName:null}}getStateFromAuthorCorrectionsStore(){const{authorCorrectionsStore:e}=this.context;return{moderatorCorrectionsAuthorId:e.getModeratorCorrectionsAuthorId(),isModeratorCorrecting:e.isModeratorCorrecting()}}getStateFromAuthorStore(){var e;const{authorStore:t}=this.context;return{authorName:null!=(e=t)&&null!=(e=e.authorDetail)&&null!=(e=e.author)?e.name:e}}render(){const{paper:e,reason:t,position:r}=this.props,{viewerFullName:n,authorName:o,isModeratorCorrecting:i}=this.state,s=i?o:n;return a.createElement("div",{className:"author-add-papers__position"},a.createElement("div",{className:"author-add-papers__position__instructions"},t?a.createElement(a.Fragment,null,a.createElement("span",{className:"author-add-papers__position__instructions__label"},Object(f.b)(e=>e.authorAddPapers.reason.choices[t].instructions)),a.createElement("span",{className:"author-add-papers__position__instructions__back"},"(",a.createElement("a",K({onClick:this.onClickBack},(l={reason:t},Object(y.b)(O({},l,{id:"author_add_paper_reason_back"})))),Object(f.b)(e=>e.authorAddPapers.reason.backLabel)),")")):a.createElement("span",{className:"author-add-papers__position__instructions__label"},Object(f.b)(e=>e.authorAddPapers.reason.instructions))),a.createElement("div",{className:"author-add-papers__position__controls"},(()=>{switch(t){case T.NOT_LISTED:return a.createElement(x,{paper:e,position:r,reason:T.NOT_LISTED,viewerFullName:s,onChangePosition:this.onSelectPosition});case T.WRONG_AUTHOR:return a.createElement(q,{paper:e,position:r,reason:T.WRONG_AUTHOR,viewerFullName:s,onChangePosition:this.onSelectPosition,showReplacedName:!0});case T.WRONG_NAME:return a.createElement(q,{paper:e,position:r,reason:T.WRONG_NAME,viewerFullName:s,onChangePosition:this.onSelectPosition});default:return I.map(e=>a.createElement(F,{key:e,onSelect:this.onSelectReason,reason:e,label:Object(f.b)(t=>t.authorAddPapers.reason.choices[e].reasonLabel)}))}})()));var l}}function J(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}G(X,"contextTypes",{authorProfileStore:W.a.instanceOf(U.a).isRequired,authorCorrectionsStore:W.a.instanceOf(z.a).isRequired,authorStore:W.a.instanceOf(H.a).isRequired});class Z extends a.PureComponent{constructor(){super(...arguments),J(this,"onClickRemove",()=>{const{paper:e,onRemovePaper:t}=this.props;t&&t(e)}),J(this,"onChangeReason",e=>{const{paper:t,onChangeReason:r}=this.props;r&&r(t,e)}),J(this,"onChangePosition",(e,t)=>{const{paper:r,onChangePosition:a}=this.props;a&&a(r,e,t)})}render(){const{paper:e,position:t,reason:r}=this.props,n=!r||"number"!=typeof t;return a.createElement("div",{"data-paper-id":e.id,className:D()({"author-add-papers__paper":!0,"author-add-papers__paper__is-draft":n})},a.createElement("div",{className:"author-add-papers__paper__remove-button",onClick:this.onClickRemove},a.createElement(m.a,{icon:"circle-plus"})),a.createElement("div",{className:"author-add-papers__paper__content"},a.createElement("div",{className:"author-add-papers__paper__section author-add-papers__paper__details"},a.createElement("div",{className:"author-add-papers__paper__title"},e.title.text),!r&&a.createElement("div",{className:"author-add-papers__paper__authors"},e.authors.map(e=>e.alias.name).join(", "))),a.createElement("div",{className:"author-add-papers__paper__section author-add-papers__paper__position"},a.createElement(X,{paper:e,position:t,reason:r,onChangeReason:this.onChangeReason,onChangePosition:this.onChangePosition}))))}}function $(){return($=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function ee(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class te extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),ee(this,"onFocusSearch",()=>{const{onFocus:e}=this.props;e&&e()}),ee(this,"onInputSearch",e=>{const{onChange:t}=this.props;if(t){const{value:r}=e.currentTarget;this.setState({searchText:r}),t(r)}}),this.state={searchText:""}}render(){const{isLoading:e}=this.props,{searchText:t}=this.state;return a.createElement("div",{className:D()({"author-add-papers__search":!0,"author-add-papers__search__is-loading":e})},a.createElement("input",$({className:"legacy__input author-add-papers__search__input",type:"text",value:t,placeholder:Object(f.b)(e=>e.authorAddPapers.searchLabel)},Object(y.b)({id:"author_add_paper_search"}),{onFocus:this.onFocusSearch,onChange:this.onInputSearch})),a.createElement(m.a,{icon:e?"gear":"search-small"}))}}var re,ae,ne,oe=r(406),ie=r(370),se=r(374),le=r(0),ce=r.n(le);function ue(){return(ue=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}class de extends a.PureComponent{render(){const{onAddPaper:e,onIndexRequest:t,papers:r}=this.props;return a.createElement("div",{className:"author-add-papers__results"},r.isEmpty()?a.createElement("div",{className:"author-add-papers__results__empty"},a.createElement("div",{className:"author-add-papers__results__emptyMsg"},Object(f.b)(e=>e.authorAddPapers.noResultsLabel)),a.createElement(ie.c,{feature:e=>e.AuthorAddPapersIndexRequests},a.createElement(ie.b,null,a.createElement(oe.default,{label:Object(f.b)(e=>e.authorAddPapers.indexRequests.add.expandLink),onClick:t})))):a.createElement(a.Fragment,null,a.createElement("div",{className:"author-add-papers__results__list"},a.createElement("ul",{className:"author-add-papers__results__paper-list"},r.map(t=>a.createElement(he,{key:t.id,onAddPaper:e,paper:t})))),a.createElement(ie.c,{feature:e=>e.AuthorAddPapersIndexRequests},a.createElement(ie.b,null,a.createElement("div",{className:"author-add-papers__results__index-paper",onClick:t},a.createElement(oe.default,{label:Object(f.b)(e=>e.authorAddPapers.indexRequests.add.expandLink),onClick:t}))))))}}function he(e){let{onAddPaper:t,paper:r}=e;const n=function(e){let{venue:t,year:r}=e;if(t&&r)return Object(f.b)(e=>e.authorRemovePapers.publisher.bothYearAndVenue,r.text,t.text);if(r)return Object(f.b)(e=>e.authorRemovePapers.publisher.onlyYear,r.text);if(t)return Object(f.b)(e=>e.authorRemovePapers.publisher.onlyVenue,t.text);return null}({year:r.year,venue:r.venue});return a.createElement("li",ue({className:"author-add-papers__results__paper"},Object(y.b)({id:"author_add_paper_result"}),{onClick:()=>t(r)}),a.createElement("div",{className:"author-add-papers__results__paper__title"},a.createElement(se.a,{field:r.title})),a.createElement("div",{className:"author-add-papers__results__paper__author-list"},r.authors.map(e=>a.createElement(se.a,{key:"".concat(r.id,"|").concat(e.alias.ids.join(","),"|").concat(e.alias.slug),className:"author-add-papers__results__paper__author",field:e.highlightedField}))),n&&a.createElement("div",{className:"author-add-papers__results__paper__publisher"},n))}re=de,ae="contextTypes",ne={authorCorrectionsStore:W.a.instanceOf(z.a).isRequired},ae in re?Object.defineProperty(re,ae,{value:ne,enumerable:!0,configurable:!0,writable:!0}):re[ae]=ne;class pe extends a.PureComponent{render(){return a.createElement("div",{className:"author-add-papers__blank-state"},a.createElement("div",{className:"author-add-papers__blank-state__content"},a.createElement(m.a,{className:"author-add-papers__blank-state__icon",icon:"paper-magnifying-glass",width:"60",height:"77.5"}),a.createElement("div",{className:"author-add-papers__blank-state__description"},Object(f.b)(e=>e.authorAddPapers.blankLabel))))}}var me=e=>{let{url:t,onRemove:r}=e;return a.createElement("div",{className:D()("author-add-papers__paper")},a.createElement("div",{className:"author-add-papers__paper__remove-button",onClick:()=>r(t)},a.createElement(m.a,{icon:"circle-plus"})),a.createElement("div",{className:"author-add-papers__paper__content"},a.createElement("div",{className:"author-add-papers__paper__section author-add-papers__paper__details"},a.createElement("div",{className:"author-add-papers__paper__title"},Object(f.b)(e=>e.authorAddPapers.indexRequests.listItem.label)),a.createElement("div",{className:"author-add-papers__index-request-url__url"},t))))},be=r(393),ge=r(42),fe=r(123),_e=r(44),ye=r(12),Ee=r(71),Oe=r.n(Ee);function Se(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ve extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),Se(this,"onKeyDown",e=>{switch(e.keyCode){case g.b:this.setState({canResultsBeVisible:!1})}}),Se(this,"onChangeSearch",e=>{this.setState({searchText:e},()=>{e?this.searchPapers().catch(e=>this.onApiError(e)):this.setState({searchPapers:le.List()})})}),Se(this,"onFocusSearch",()=>{this.setState({canResultsBeVisible:!0})}),Se(this,"onAddPaper",e=>{const{authorCorrectionsStore:t}=this.context,{addedPapers:r}=this.state;this.setState({canResultsBeVisible:!1,addedPapers:r.set(e.id,{paper:e,position:null,reason:null})}),t.addDraftPaperId(e.id)}),Se(this,"onRemovePaper",e=>{const{addedPapers:t}=this.state;this.setState({addedPapers:t.delete(e.id)});const{authorCorrectionsStore:r}=this.context;r.cancelPendingCorrectionByPaperId(e.id)}),Se(this,"onShowIndexRequest",()=>{this.setState({isIndexRequestVisible:!0,canResultsBeVisible:!1})}),Se(this,"onCloseIndexRequest",()=>{this.setState({isIndexRequestVisible:!1})}),Se(this,"onAddIndexUrl",e=>{const{addedPapers:t}=this.state,r=t.set(e,e);this.setState({addedPapers:r});const{authorCorrectionsStore:a}=this.context;a.addPendingIndexRequestUrl(e)}),Se(this,"onRemoveIndexUrl",e=>{const{addedPapers:t}=this.state;this.setState({addedPapers:t.delete(e)});const{authorCorrectionsStore:r}=this.context;r.removePendingIndexRequestUrl(e)}),Se(this,"onChangeReason",(e,t)=>{const{addedPapers:r}=this.state;this.setState({addedPapers:r.set(e.id,{paper:e,position:null,reason:t})});const{authorCorrectionsStore:a}=this.context;a.cancelPendingCorrectionByPaperId(e.id),a.addDraftPaperId(e.id)}),Se(this,"onChangePosition",(e,t,r)=>{const{addedPapers:a}=this.state;this.setState({addedPapers:a.set(e.id,{paper:e,position:r,reason:t})});const{authorCorrectionsStore:n}=this.context;if("number"==typeof r)switch(t){case T.NOT_LISTED:n.enqueueAddPaperCorrection({paperId:e.id,position:r});break;case T.WRONG_AUTHOR:case T.WRONG_NAME:{const t=e.authors.get(r).alias.canonicalId(),a=t?parseInt(t,10):null;n.enqueueSwapPaperCorrection({fromAuthorId:a,paperId:e.id,position:r});break}}else n.cancelPendingCorrectionByPaperId(e.id),n.addDraftPaperId(e.id)}),Se(this,"onClickCapture",e=>{e.preventDefault(),e.stopPropagation(),this.setState({canResultsBeVisible:!1})}),this.state={isLoading:!1,errorMessage:null,canResultsBeVisible:!1,isIndexRequestVisible:!1,hasFetchedPapers:!1,addedPapers:le.OrderedMap(),searchPapers:le.List(),searchText:""},this.onChangeSearchThrottled=Object(be.a)(this.onChangeSearch,1e3,{leading:!0,trailing:!0})}onApiError(e){w.a.error("Api Error",e),this.setState({errorMessage:Object(f.b)(e=>e.authorRemovePapers.error.apiQueryFailed),isLoading:!1})}async searchPapers(){var e;await Object(ge.e)(this,{isLoading:!0,canResultsBeVisible:!0});const{authorId:t}=this.props,{api:r}=this.context,{searchText:a}=this.state;let n=a;const{protocol:o,pathname:i}=Oe.a.parse(a);if(o){const e=ye.a.PAPER_DETAIL.exec(i)[2];e&&(n=e)}const s=await r.searchPapers({query:n,page:1,limit:10,excludeAuthorId:t,model:"Paper",prependSuggestions:!0});if(this.state.searchText!==a)return void w.a.info("Search results dropped, text is no longer ".concat(a));await Object(ge.e)(this,{isLoading:!1,hasFetchedPapers:!0});const l=le.List((null!=(e=s)&&null!=(e=e.resultData)?e.papers:e)||[]).map(_e.b.fromJs);await Object(ge.e)(this,{searchPapers:l})}render(){const{showDraftAsError:e}=this.props,{isLoading:t,hasFetchedPapers:r,addedPapers:n,searchPapers:o,searchText:i,isIndexRequestVisible:s,canResultsBeVisible:l}=this.state,c=l&&r&&i;return a.createElement("div",{onKeyDown:this.onKeyDown,className:D()({"author-add-papers":!0,"author-add-papers__is-empty":!1,"author-add-papers__is-loading":t,"author-add-papers__show-draft-as-error":e})},c&&a.createElement("div",{className:"author-add-papers__click-capture",onClick:this.onClickCapture}),a.createElement("div",{className:"author-add-papers__controls"},a.createElement(te,{isLoading:t,onChange:this.onChangeSearchThrottled,onFocus:this.onFocusSearch}),c&&a.createElement(de,{onAddPaper:this.onAddPaper,onIndexRequest:this.onShowIndexRequest,papers:o})),a.createElement("div",{className:"author-add-papers__paper-list"},a.createElement(ie.c,{feature:e=>e.AuthorAddPapersIndexRequests},a.createElement(ie.b,null,s&&a.createElement(_,{onCancel:this.onCloseIndexRequest,onSubmit:this.onAddIndexUrl}))),n.valueSeq().reverse().map(e=>"string"==typeof e?a.createElement(me,{key:e,url:e,onRemove:this.onRemoveIndexUrl}):a.createElement(Z,{key:e.paper.id,paper:e.paper,position:e.position,reason:e.reason,onRemovePaper:this.onRemovePaper,onChangeReason:this.onChangeReason,onChangePosition:this.onChangePosition}))),n.isEmpty()&&a.createElement(pe,null))}}Se(ve,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,authorCorrectionsStore:W.a.instanceOf(z.a).isRequired});var Ce=r(368),we=r(36);class Pe extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.state={isLoading:!0,authorPapers:le.List()}}componentDidMount(){this.fetchAuthorPapers().catch(e=>this.onApiError(e))}onApiError(e){w.a.error("Api Error",e),this.setState({isLoading:!1})}async fetchAuthorPapers(){var e,t;await Object(ge.e)(this,{isLoading:!0});const{authorId:r}=this.props,{api:a}=this.context,n=await a.fetchPapersWithCorrectionsAppliedForAuthor({authorId:r,model:"PaperLite"});await Object(ge.e)(this,{isLoading:!1});const o=null!=(t=n)&&null!=(t=t.resultData)?t.authorId:t;V()(r===o,"browser and server author IDs do not match");const i=le.List((null!=(e=n)&&null!=(e=e.resultData)?e.paperLites:e)||[]).map(we.a.fromJs);await Object(ge.e)(this,{authorPapers:i})}render(){const{isLoading:e,authorPapers:t}=this.state;return e?a.createElement(Ce.a,null):a.createElement("div",null,a.createElement("h2",null,Object(f.a)(e=>e.correctionsCurrentPapers.headerText,t.size)),a.createElement("ul",null,t.map(e=>a.createElement("li",{key:e.id,className:"corrections-curent-papers__paper"},e.title))))}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Pe,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired});var xe=r(91),Re=r(68),Ne=r(79),je=r(54),Te=r.n(je);function Ae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ie(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Fe=function(e){function t(){return Ae(this,t),Ie(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.enable=function(e){this.unblock&&this.unblock(),this.unblock=this.context.router.history.block(e)},t.prototype.disable=function(){this.unblock&&(this.unblock(),this.unblock=null)},t.prototype.componentWillMount=function(){V()(this.context.router,"You should not use <Prompt> outside a <Router>"),this.props.when&&this.enable(this.props.message)},t.prototype.componentWillReceiveProps=function(e){e.when?this.props.when&&this.props.message===e.message||this.enable(e.message):this.disable()},t.prototype.componentWillUnmount=function(){this.disable()},t.prototype.render=function(){return null},t}(n.a.Component);Fe.propTypes={when:Te.a.bool,message:Te.a.oneOfType([Te.a.func,Te.a.string]).isRequired},Fe.defaultProps={when:!0},Fe.contextTypes={router:Te.a.shape({history:Te.a.shape({block:Te.a.func.isRequired}).isRequired}).isRequired};var ke=Fe,De=r(5);function Le(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Me(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const qe=[Re.a.AddAuthorship,Re.a.SwapAuthorship];class He extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),Me(this,"onSubmitForm",e=>{e.preventDefault(),this.state.hasDraftPapers?this.setState({hasAttemptedSubmit:!0,errorMessage:Object(f.b)(e=>e.authorAddPapers.error.papersInDraft)},()=>{Object(De.a)()&&this.scrollToPaper(this.context.authorCorrectionsStore.getDraftPaperIds().first())}):this.setState({hasAttemptedSubmit:!0},()=>{this.attemptSubmit()})}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(r),!0).forEach((function(t){Me(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Le(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({isSending:!1,errorMessage:null,successMessage:null,hasAttemptedSubmit:!1},this.getStateFromAuthStore(),{},this.getStateFromAuthorCorrectionsStore(),{},this.getStateFromAuthorStore()),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())}),this.context.authorCorrectionsStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorCorrectionsStore())}),this.context.authorStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorStore())}),this.state.authorId=this.state.isModeratorCorrecting?this.state.moderatorCorrectionsAuthorId:this.state.authorId}getStateFromAuthStore(){const{authStore:e}=this.context;return{authorId:e.getClaimedAuthorId()}}getStateFromAuthorCorrectionsStore(){const{authorCorrectionsStore:e}=this.context,t=e.hasDraftPapers();return{isFormDirty:e.hasPendingCorrections()||t,pendingCorrections:e.getPendingCorrections().filter(e=>qe.includes(e.correctionType)),hasDraftPapers:t,isModeratorCorrecting:e.isModeratorCorrecting(),moderatorCorrectionsAuthorId:e.getModeratorCorrectionsAuthorId()}}getStateFromAuthorStore(){var e;const{authorStore:t}=this.context;return{authorName:null!=(e=t)&&null!=(e=e.authorDetail)&&null!=(e=e.author)?e.name:e}}scrollToPaper(e){if(!e)return!1;const t=document.querySelector('.author-add-papers__paper[data-paper-id="'.concat(e,'"]'));return!!t&&(t.scrollIntoView({behavior:"smooth"}),!0)}async attemptSubmit(){const{authorId:e,pendingCorrections:t,isModeratorCorrecting:r}=this.state,{api:a,authorCorrectionsStore:n}=this.context,o=n.getPendingIndexRequestUrls();await Object(ge.e)(this,{isSending:!0,errorMessage:null,successMessage:null});try{t&&await a.submitPaperAuthorCorrections({authorId:e,corrections:t.toJS()}),o&&await a.submitAuthorIndexRequests({urls:o.toJS()}),n.clearPendingCorrections(),n.clearPendingIndexRequests();const{history:i}=this.context,s=r?"AUTHOR_CORRECTIONS_TOOL_STATUS":"ACCOUNT_CORRECTIONS";i.push(Object(ye.d)({routeName:s}))}catch(e){w.a.error("Failed to submit paper changes",e),this.setState({isSending:!1,errorMessage:Object(f.b)(e=>e.authorAddPapers.error.apiSubmitFailed),successMessage:null})}}renderMessage(){const{errorMessage:e,successMessage:t}=this.state;return e?a.createElement("div",{className:"account__error-msg"},e):t?a.createElement("div",{className:"account__success-msg"},t):null}render(){const{authorId:e,isSending:t,hasDraftPapers:r,hasAttemptedSubmit:n,isFormDirty:i,isModeratorCorrecting:c,authorName:u}=this.state,d=Object(ye.d)({routeName:"AUTHOR_PROFILE_BY_ID",params:{authorId:e}}),h=c?Object(f.b)(e=>e.moderatorCorrections.addPapers.pageHeading,u):Object(f.b)(e=>e.account.page.addPapers.pageHeading),b=c?Object(f.b)(e=>e.moderatorCorrections.addPapers.pageDescription):Object(f.b)(e=>e.account.page.addPapers.pageDescription,d);return a.createElement("div",{className:"account-add-papers"},a.createElement("h2",{className:"account-add-papers__headline"},h),a.createElement("div",{className:"account-add-papers__description"},a.createElement(p.a,{content:b})),a.createElement("hr",{className:"account__divider"}),e&&a.createElement(ve,{key:e,showDraftAsError:n&&r,authorId:e}),a.createElement(o,null,a.createElement(l,null,this.renderMessage()),a.createElement(s,null,t&&a.createElement(m.a,{className:"account__loading",icon:"gear"}),a.createElement("button",{className:"account-add-papers__submit-button button button--primary",onClick:this.onSubmitForm},Object(f.b)(e=>e.account.button.submit)))),e&&a.createElement(Pe,{authorId:e}),a.createElement(ke,{when:i,message:Object(f.b)(e=>e.authorAddPapers.error.dirtyForm)}))}}Me(He,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,authStore:W.a.instanceOf(xe.a).isRequired,authorCorrectionsStore:W.a.instanceOf(z.a).isRequired,authorStore:W.a.instanceOf(H.a).isRequired,history:W.a.instanceOf(Ne.a).isRequired});var ze=r(122);function Ue(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("shared-AccountAddPapersPage"),a.createElement(He,e)}class Be extends a.Component{render(){return a.createElement(Ue,null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Be,"getPageTitle",()=>Object(f.b)(e=>e.account.page.addPapers.pageTitle));var Ve=r(364);function Ye(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function We(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ke extends a.Component{constructor(e,t){super(e,t),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(r),!0).forEach((function(t){We(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ye(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthStore()),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())})}getStateFromAuthStore(){const{authStore:e}=this.context;return{claimedAuthorId:e.getClaimedAuthorId()}}render(){const{claimedAuthorId:e}=this.state;return e?a.createElement("div",{className:"account-author-claim-pending"},a.createElement("h2",null,Object(f.b)(e=>e.account.page.authorClaimPending.pageHeading)),a.createElement("div",{className:"account-author-claim-pending__description"},Object(f.b)(e=>e.authorClaimPending.description)),a.createElement("div",{className:"account-author-claim-pending__banner"},a.createElement(m.a,{icon:"status-waiting"}),a.createElement("div",{className:"account-author-claim-pending__banner__label"},Object(f.b)(e=>e.authorClaimPending.bannerLabel))),a.createElement("hr",{className:"account-author-claim-pending__rule"}),a.createElement("div",{className:"account-author-claim-pending__status-instructions"},a.createElement(p.a,{content:Object(f.b)(e=>e.authorClaimPending.statusInstruction)})),a.createElement("div",{className:"account-author-claim-pending__button-row"},a.createElement(Ve.a,{to:"AUTHOR_PROFILE_BY_ID",params:{authorId:e},className:"button button--secondary"},Object(f.b)(e=>e.authorClaimPending.authorLinkLabel)))):null}}function Qe(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("shared-AccountAuthorClaimPendingPage"),a.createElement(Ke,e)}We(Ke,"contextTypes",{authStore:W.a.instanceOf(xe.a).isRequired});class Ge extends a.Component{render(){return a.createElement(Qe,null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Ge,"getPageTitle",()=>Object(f.b)(e=>e.account.page.authorClaimPending.pageTitle));var Xe=r(6),Je=r(146),Ze=r.n(Je);function $e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function et(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$e(Object(r),!0).forEach((function(t){tt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$e(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function tt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const{EventEmitter:rt}=Ze.a;class at extends Xe.a{constructor(e){super(),this._api=e,this._formEventEmitter=new rt,this._registeredFields=new Map,this._stateOfFields=new Map,this._isSending=!1,this._formErrorMsg=null,this._formEventEmitter.setMaxListeners(1e3)}destroy(){this._formEventEmitter.removeAllListeners(),this._stateOfFields.clear(),this._registeredFields.clear()}subscribe(e,t){return this._addListener(e,t),()=>{this._removeListener(e,t)}}triggerSubmit(){this._emit("submit")}async submitToApi(e){this._isSending&&w.a.warn("Second attempt to submit a form while data is sending to API."),this.setSending(!0);try{const t=this.getFormValues(),r=await e(this._api,t);return this._cleanFormValues(),r}catch(e){this.setFormErrorMessage(e.message)}finally{this.setSending(!1)}}_addListener(e,t){this._formEventEmitter.addListener(e,t)}_removeListener(e,t){this._formEventEmitter.removeListener(e,t)}_emit(e){this._formEventEmitter.emit(e)}registerField(e){const{fieldName:t,initialValue:r,onChange:a,onClear:n,onReset:o}=e;V()(!this._registeredFields.has(t),"Field ".concat(t," already exists in FormStore")),this._registeredFields.set(t,e),this._stateOfFields.set(t,{errorMessage:null,fieldName:t,value:r}),a&&this._addListener("change-".concat(t),a),n&&this._addListener("clear",n),o&&this._addListener("reset",o)}unregisterField(e){const t=this._registeredFields.get(e);t&&(this._registeredFields.delete(e),this._stateOfFields.delete(e),t.onChange&&this._removeListener("change-".concat(e),t.onChange),t.onClear&&this._removeListener("clear",t.onClear),t.onReset&&this._removeListener("reset",t.onReset))}getFieldNames(){return[...this._registeredFields.keys()]}setFieldErrorMessage(e,t){const r=this._stateOfFields.get(e);V()(r,"Field ".concat(e," cannot set error message, it's missing from state")),r.errorMessage!==t&&(this._stateOfFields.set(e,et({},r,{errorMessage:t})),this._emit("change-".concat(e)),this.emitChange())}getFieldErrorMessage(e){const t=this._stateOfFields.get(e);return V()(t,"Field ".concat(e," cannot get error message, it's missing from state")),t.errorMessage||null}getFieldsWithErrors(){return[...this._stateOfFields.values()].filter(e=>!!e.errorMessage).map(e=>e.fieldName)}hasFieldError(e){return!!this.getFieldErrorMessage(e)}hasFieldErrors(){return this.getFieldsWithErrors().length>0}setInitialFieldValue(e,t){const r=this._registeredFields.get(e);return V()(r,"Field ".concat(e," was unable to set initial value because it was not yet registered.")),this.isFieldDirty(e)?(w.a.warn("Was unable to set the initial field value for ".concat(e," because it was dirty")),!1):(this._registeredFields.set(e,et({},r,{initialValue:t})),this.setFieldValue(e,t),!0)}getFieldValue(e){const t=this._stateOfFields.get(e);return V()(t,"Field ".concat(e," cannot get value, it's missing from state")),t.value}setFieldValue(e,t){this._setFieldValue(e,t)&&this._emit("change-".concat(e))}_setFieldValue(e,t){const r=this._stateOfFields.get(e);return V()(r,"Field ".concat(e," cannot be updated, it's missing from state")),r.value!==t&&(this._stateOfFields.set(e,et({},r,{errorMessage:null,value:t})),!0)}resetFieldValue(e){this._resetFieldValue(e)&&this._emit("change-".concat(e))}_resetFieldValue(e){const t=this._registeredFields.get(e);return V()(t,"Field ".concat(e," cannot be reset, it's missing from state")),V()(void 0!==t.initialValue,"Field ".concat(e," cannot be reset, it's initial value is undefined")),this._setFieldValue(e,t.initialValue)}clearFieldValue(e){this._clearFieldValue(e)&&this._emit("change-".concat(e))}_clearFieldValue(e){return this._setFieldValue(e,null)}resetForm(){const e=[];for(const[t]of this._stateOfFields)this._resetFieldValue(t)&&e.push(t);for(const t of e)this._emit("change-".concat(t));this._emit("reset")}clearForm(){const e=[];for(const[t]of this._stateOfFields)this._clearFieldValue(t)&&e.push(t);for(const t of e)this._emit("change-".concat(t));this._emit("clear")}hasError(){return!!this.getFormErrorMessage()||this.hasFieldErrors()}getFormErrorMessage(){return this._formErrorMsg||null}setFormErrorMessage(e){this._formErrorMsg!==e&&(this._formErrorMsg=e||null,this.emitChange())}_clearFormErrorMessage(){this._formErrorMsg=null}getFormValues(){const e={};for(const[t,r]of this._stateOfFields)e[t]=r.value;return e}getDirtyFieldNames(){return this.getFieldNames().filter(e=>this.isFieldDirty(e))}_cleanFormValues(){for(const[e]of this._stateOfFields){const t=this._registeredFields.get(e),r=this._stateOfFields.get(e);V()(t&&r,"Field ".concat(e," was missing when attempting to clean the fieldValue.")),this._registeredFields.set(e,et({},t,{initialValue:r.value}))}}isFieldDirty(e){const t=this._registeredFields.get(e),r=this._stateOfFields.get(e);return V()(t&&r,"Field ".concat(e," was not registered at the time of checking dirty state.")),t.initialValue&&"function"==typeof t.initialValue.equals?!t.initialValue.equals(r.value):t.initialValue!==r.value}isFormDirty(){const e=this.getFieldNames();for(const t of e)if(this.isFieldDirty(t))return!0;return!1}isSending(){return this._isSending}setSending(e){this._isSending!==e&&(this._isSending=e,this.emitChange())}async validate(){this._clearFormErrorMessage();const e=[...this._registeredFields.values()].filter(e=>e.onValidate),t=0===(await Promise.all(e.map(e=>e.onValidate&&e.onValidate(this).then(t=>(this.setFieldErrorMessage(e.fieldName,t),!t),t=>(t instanceof Error?(w.a.error("Failed to validate ".concat(e.fieldName,": threw Error"),t),this.setFieldErrorMessage(e.fieldName,t.message)):"string"==typeof t?this.setFieldErrorMessage(e.fieldName,t):t?(w.a.error("Failed to validate ".concat(e.fieldName,": unexpected error message type"),t),this.setFieldErrorMessage(e.fieldName,t.toString())):(w.a.error("Failed to validate ".concat(e.fieldName,": message was falsy"),t),this.setFieldErrorMessage(e.fieldName,"Field is invalid.")),!1))))).filter(e=>!e).length;return this._emit("validate"),t}}function nt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ot(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class it extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.onChange=this.onChange.bind(this);const{fieldName:n,initialValue:o}=this.props;this.context.formStore.registerField({fieldName:n,initialValue:o,onValidate:e.onValidate,onChange:()=>this.setState(this.getStateFromFormStore())}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?nt(Object(r),!0).forEach((function(t){ot(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromFormStore())}componentDidUpdate(e){const{formStore:t}=this.context,r=this.props.initialValue||"";e.initialValue!==r&&t.setInitialFieldValue(e.fieldName,r)}componentWillUnmount(){const{formStore:e}=this.context;e.unregisterField(this.props.fieldName)}getStateFromFormStore(){const{formStore:e}=this.context,{fieldName:t}=this.props;return{value:e.getFieldValue(t)||"",error:e.getFieldErrorMessage(t)}}onChange(e){const{formStore:t}=this.context,{fieldName:r}=this.props,{value:a}=e.currentTarget;t.setFieldValue(r,a)}render(){const{fieldName:e,label:t,placeholder:r,isRequired:n}=this.props,{value:o,error:i}=this.state;return a.createElement("label",{className:D()("author-edit__field",{"author-edit__has-error":i})},a.createElement("div",{className:"author-edit__field__label"},a.createElement("span",{className:"author-edit__field__label-text"},t),!n&&a.createElement("span",{className:"author-edit__field__label-optional"},Object(f.b)(e=>e.authorEdit.form.optional))),a.createElement("div",{className:"author-edit__field__input"},a.createElement("input",{type:"text",name:e,className:"legacy__input author-edit__field__input-text",value:o,onChange:this.onChange,placeholder:r}),a.createElement("div",{className:"author-edit__field__error"},i)))}}function st(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function lt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}ot(it,"contextTypes",{formStore:W.a.instanceOf(at).isRequired});class ct extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?st(Object(r),!0).forEach((function(t){lt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):st(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthorProfileStore()),this.context.authorProfileStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorProfileStore())})}getStateFromAuthorProfileStore(){const{authorProfileStore:e}=this.context,t=e.getAuthorProfile();return t?{initialFirstName:t.firstName,initialMiddleNames:t.middleNames.join(" "),initialLastName:t.lastName}:{initialFirstName:"",initialMiddleNames:"",initialLastName:""}}render(){const{initialFirstName:e,initialMiddleNames:t,initialLastName:r}=this.state;return a.createElement(a.Fragment,null,a.createElement(it,{fieldName:"firstName",initialValue:e,label:Object(f.b)(e=>e.authorEdit.form.firstNameLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.firstNamePlaceholder),isRequired:!1}),a.createElement(it,{fieldName:"middleNames",initialValue:t,label:Object(f.b)(e=>e.authorEdit.form.middleNamesLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.middleNamesPlaceholder),isRequired:!1}),a.createElement(it,{fieldName:"lastName",initialValue:r,label:Object(f.b)(e=>e.authorEdit.form.lastNameLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.lastNamePlaceholder),onValidate:ut,isRequired:!0}))}}async function ut(e){const t=e.getFieldValue("lastName");return"string"!=typeof t||0===t.trim().length?Object(f.b)(e=>e.authorEdit.error.lastNameMissing):null}lt(ct,"contextTypes",{authorProfileStore:W.a.instanceOf(U.a).isRequired});var dt=r(487),ht=r(488);function pt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function mt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class bt extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pt(Object(r),!0).forEach((function(t){mt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthorProfileStore()),this.context.authorProfileStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorProfileStore())})}getStateFromAuthorProfileStore(){const{authorProfileStore:e}=this.context,t=e.getAuthorProfile();if(!t)return{initialAffiliation:"",initialOrcidId:"",initialHomepageUrl:""};const{affiliations:r=[],orcidId:a="",homepageUrl:n=""}=t;return{initialAffiliation:r.join("; "),initialOrcidId:a,initialHomepageUrl:n}}render(){const{initialAffiliation:e,initialOrcidId:t,initialHomepageUrl:r}=this.state;return a.createElement(a.Fragment,null,a.createElement(it,{fieldName:"affiliation",initialValue:e,label:Object(f.b)(e=>e.authorEdit.form.affiliationLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.affiliationPlaceholder),isRequired:!1}),a.createElement(it,{fieldName:"orcidId",initialValue:t,label:Object(f.b)(e=>e.authorEdit.form.orcidIdLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.orcidIdPlaceholder),onValidate:gt,isRequired:!1}),a.createElement(it,{fieldName:"homepageUrl",initialValue:r,label:Object(f.b)(e=>e.authorEdit.form.homepageUrlLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.homepageUrlPlaceholder),onValidate:ft,isRequired:!1}))}}async function gt(e){const t=e.getFieldValue("orcidId");return t?(V()("string"==typeof t,"value of orcid id was not a string"),t&&!ht.a.test(t)?Object(f.b)(e=>e.authorEdit.error.orcidIdInvalid):null):null}async function ft(e){const t=e.getFieldValue("homepageUrl");return t?(V()("string"==typeof t,"value of homepage was not a string"),t&&!dt.a.test(t)?Object(f.b)(e=>e.authorEdit.error.homepageUrlInvalid):null):null}function _t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function yt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}mt(bt,"contextTypes",{authorProfileStore:W.a.instanceOf(U.a).isRequired});class Et extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(r),!0).forEach((function(t){yt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromFormStore()),this.context.formStore.registerComponent(this,()=>{this.setState(this.getStateFromFormStore())})}getStateFromFormStore(){const{formStore:e}=this.context;return{isSending:e.isSending()}}render(){return a.createElement("div",{className:"author-edit"},a.createElement("div",{className:"author-edit__fields"},a.createElement(ct,null),a.createElement("hr",{className:"author-edit__divider"}),a.createElement(bt,null)))}}yt(Et,"contextTypes",{formStore:W.a.instanceOf(at).isRequired});var Ot=r(173),St=r(30);function vt(){return(vt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Ct(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Pt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class xt extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wt(Object(r),!0).forEach((function(t){Pt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({successMessage:null},this.getStateFromFormStore(),{},this.getStateFromAuthorCorrectionsStore(),{},this.getStateFromAuthorStore()),this.props.formStore.registerComponent(this,()=>{this.setState(this.getStateFromFormStore())}),this.props.formStore.subscribe("submit",()=>{this.attemptSubmit()}),this.context.authorCorrectionsStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorCorrectionsStore())}),this.context.authorStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorStore())}),this.onClickUnclaim=this.onClickUnclaim.bind(this),this.onSubmitForm=this.onSubmitForm.bind(this)}getStateFromFormStore(){const{formStore:e}=this.props;return{errorMessage:e.getFormErrorMessage(),isFormDirty:e.isFormDirty(),isSending:e.isSending()}}getStateFromAuthorCorrectionsStore(){const{authorCorrectionsStore:e}=this.context;return{moderatorCorrectionsAuthorId:e.getModeratorCorrectionsAuthorId(),isModeratorCorrecting:e.isModeratorCorrecting()}}getStateFromAuthorStore(){var e;const{authorStore:t}=this.context;return{authorName:null!=(e=t)&&null!=(e=e.authorDetail)&&null!=(e=e.author)?e.name:e}}onSubmitForm(e){e.preventDefault(),this.attemptSubmit()}onClickUnclaim(e){e.preventDefault(),window.confirm(Object(f.b)(e=>e.authorEdit.unclaimDialogue))&&this.attemptUnclaim()}navigateToUnclaimPage(e){const{history:t}=this.context;t.push(Object(ye.d)({routeName:"ACCOUNT_AUTHOR_UNCLAIM_SUCCESS",params:{authorId:e.toString()}}))}async attemptSubmit(){const{formStore:e}=this.props,{moderatorCorrectionsAuthorId:t,isModeratorCorrecting:r}=this.state,{history:a}=this.context;if(!await e.validate())return;const n=t||this.context.authStore.getClaimedAuthorId();if(!n)return void e.setFormErrorMessage(Object(f.b)(e=>e.authorEdit.error.noAuthorClaimed));await e.submitToApi(async(e,t)=>{try{await Promise.all([e.updateAuthorProfile({authorId:n,lastName:(t.lastName||"").trim(),middleNames:(t.middleNames||"").split(/\s+/).map(e=>e.trim()),firstName:(t.firstName||"").trim(),affiliation:(t.affiliation||"").split("; ").map(e=>e.trim()),homepageUrl:(t.homepageUrl||"").trim(),orcidId:(t.orcidId||"").trim()}),Object(ge.b)(2e3)])}catch(e){throw new Error(Object(f.b)(e=>e.authorEdit.error.apiFailed))}});const o=r?"AUTHOR_CORRECTIONS_TOOL_STATUS":"ACCOUNT_CORRECTIONS",i=new St.a({routeName:o,replace:!0,status:302});Object(Ot.a)({redirect:i,history:a})}async attemptUnclaim(){const{formStore:e}=this.props,{authStore:t}=this.context,r=t.getClaimedAuthorId();if(!r)return void e.setFormErrorMessage(Object(f.b)(e=>e.authorEdit.error.noAuthorClaimed));const{api:a}=this.context;await a.unclaimAuthorProfile({authorId:r}),await a.fetchUserInfo(),this.navigateToUnclaimPage(r)}renderMessage(){const{errorMessage:e,successMessage:t}=this.state;return e?a.createElement("div",{className:"account__error-msg"},e):t?a.createElement("div",{className:"account__success-msg"},t):null}render(){const{isSending:e,isFormDirty:t,isModeratorCorrecting:r}=this.state,{pageHeading:n,pageDescription:c}=(()=>{if(r){const{authorName:e}=this.state;return{pageHeading:Object(f.b)(e=>e.moderatorCorrections.contactInfo.pageHeading,e),pageDescription:Object(f.b)(e=>e.moderatorCorrections.contactInfo.pageDescription)}}const e=this.context.authStore.getClaimedAuthorId(),t=e?Object(ye.d)({routeName:"AUTHOR_PROFILE_BY_ID",params:{authorId:e}}):"/me/author";return{pageHeading:Object(f.b)(e=>e.account.page.authorContact.pageHeading),pageDescription:Object(f.b)(e=>e.account.page.authorContact.pageDescription,t)}})();return a.createElement("div",{className:"account-author-contact"},a.createElement("div",{className:"account-author-contact__headline"},n),a.createElement("div",{className:"account-author-contact__description"},a.createElement(p.a,{content:c})),a.createElement("hr",{className:"account__divider"}),a.createElement("form",{onSubmit:this.onSubmitForm},a.createElement(Et,null),a.createElement(o,null,a.createElement(l,null,this.renderMessage()),a.createElement(s,null,e&&a.createElement(m.a,{className:"account__loading",icon:"gear"}),a.createElement("button",{className:"account-author-contact__submit-button button button--primary",onClick:this.onSubmitForm,type:"submit"},Object(f.b)(e=>e.account.button.submit))),a.createElement(i,null,!r&&a.createElement("button",{className:"button button--tertiary",onClick:this.onClickUnclaim,type:"button"},Object(f.b)(e=>e.authorEdit.form.unlinkLabel))))),a.createElement(ke,{when:t,message:Object(f.b)(e=>e.authorEdit.error.dirtyForm)}))}}Pt(xt,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,authorCorrectionsStore:W.a.instanceOf(z.a).isRequired,authorProfileStore:W.a.instanceOf(U.a).isRequired,authStore:W.a.instanceOf(xe.a).isRequired,authorStore:W.a.instanceOf(H.a).isRequired,history:W.a.instanceOf(Ne.a).isRequired});var Rt=function(e){class t extends a.Component{constructor(e,t){super(e,t);const r=new at(this.context.api);this.state={formStore:r},e.getFormStore&&e.getFormStore(r)}getChildContext(){const{formStore:e}=this.state;return{formStore:e}}render(){return a.createElement(e,vt({},this.props,{formStore:this.state.formStore}))}}return Ct(t,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired}),Ct(t,"childContextTypes",{formStore:W.a.instanceOf(at)}),new Proxy(t,{get:(t,r)=>r in t?t[r]:r in e?e[r]:void 0})}(xt);function Nt(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("shared-AccountAuthorContactPage"),a.createElement(Rt,e)}class jt extends a.Component{static async willRouteTo(e){let{api:t,authStore:r,authorProfileStore:a,authorCorrectionsStore:n}=e;if(n.isModeratorCorrecting()){const e=n.getModeratorCorrectionsAuthorId();if(e)return t.fetchAuthorDetail(e,null,!1)}else{const e=r.getClaimedAuthorId(),n=a.getAuthorProfile();if(!e)return new St.a({routeName:"ACCOUNT_CONTACT",replace:!0,status:302});if(!n)return t.fetchAuthorProfile({authorId:e})}}render(){return a.createElement(Nt,null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(jt,"getPageTitle",()=>Object(f.b)(e=>e.account.page.authorContact.pageTitle));class Tt extends a.Component{render(){const{authorId:e}=this.props;return e?a.createElement("div",{className:"account-author-unclaim-success"},a.createElement("h2",null,Object(f.b)(e=>e.account.page.authorUnclaimSuccess.pageHeading)),a.createElement("div",{className:"account-author-unclaim-success__description"},Object(f.b)(e=>e.account.page.authorUnclaimSuccess.pageDescription,e)),a.createElement("div",{className:"account-author-unclaim-success__actions"},a.createElement(Ve.a,{to:"AUTHOR_PROFILE_BY_ID",params:{authorId:e.toString()}},Object(f.b)(e=>e.account.page.authorUnclaimSuccess.authorLinkLabel)))):null}}function At(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("shared-AccountAuthorUnclaimSuccessPage"),a.createElement(Tt,e)}class It extends a.Component{render(){const{match:e}=this.props,t=function(e){const t=function(e){var t;const r=(null!=(t=e)&&null!=(t=t.params)?t.authorId:t)||"";return/^\d+$/.test(r)?parseInt(r,10):null}(e);return V()(t,"param 'authorId' must be a number"),t}(e);return a.createElement(At,{authorId:t})}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(It,"getPageTitle",()=>Object(f.b)(e=>e.account.page.authorUnclaimSuccess.pageTitle));var Ft=r(69),kt=r(140);function Dt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Lt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Mt extends a.PureComponent{constructor(){super(...arguments),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Dt(Object(r),!0).forEach((function(t){Lt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthStore(),{},this.getStateFromCorrectionsStore()),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())}),this.context.correctionsStore.registerComponent(this,()=>{this.setState(this.getStateFromCorrectionsStore())})}getStateFromAuthStore(){const{authStore:e}=this.context;return{viewerClaimedAuthorId:e.getClaimedAuthorId()}}getStateFromCorrectionsStore(){const{correctionsStore:e}=this.context,{correction:t}=this.props;return{paper:e.getCorrectedPaperById(t.paperHash)}}buildViewerAuthor(){const{correction:{authorId:e}}=this.props,{correctionsStore:t}=this.context,r=t.getAuthorCorrections().findLast(e=>e.fieldNames&&e.fieldNames.includes("authorName"));if(r&&r.fieldCorrections){const t=r.fieldCorrections.find(e=>"authorName"===e.field);if(t&&t.changeValue){const{first:r,middle:a,last:n}=t.changeValue;return Ft.a.fromJs({ids:[e],name:[r,...a,n].join(" ")})}}const{authorProfileStore:a}=this.context,n=a.getAuthorProfile();return n?Ft.a.fromJs({ids:[e],name:n.fullName}):Ft.a.fromJs({ids:[e],name:"You"})}renderAuthor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{correction:r}=this.props,n=e.canonicalId()===this.state.viewerClaimedAuthorId;return a.createElement("li",{key:[r.paperHash,e.canonicalId()].join("|"),className:D()({"corrections-summary__paper-correction__author":!0,"corrections-summary__paper-correction__author__added":t.isAdd,"corrections-summary__paper-correction__author__removed":t.isRemove})},a.createElement("span",{className:"corrections-summary__paper-correction__author__name"},e.name),n&&a.createElement("span",{className:"corrections-summary__paper-correction__author__viewer-claimed-tag"},Object(f.b)(e=>e.correctionSummary.viewerClaimedLabel)))}renderAddAuthorship(e){const{correction:t}=this.props,r=t.position,n=e.slice(0,r),o=e.slice(r);return a.createElement("ul",{className:"corrections-summary__paper-correction__author-list corrections-summary__paper-correction__add-authorship"},n.map(e=>this.renderAuthor(e)),this.renderAuthor(this.buildViewerAuthor(),{isAdd:!0}),o.map(e=>this.renderAuthor(e)))}renderRemoveAuthorship(e){const{correction:t}=this.props,r=t.position,n=e.slice(0,r),o=e.slice(r+1),i=e.get(r);return a.createElement("ul",{className:"corrections-summary__paper-correction__author-list corrections-summary__paper-correction__remove-authorship"},n.map(e=>this.renderAuthor(e)),this.renderAuthor(i,{isRemove:!0}),o.map(e=>this.renderAuthor(e)))}renderSwapAuthorship(e){const{correction:t}=this.props,r=t.position,n=e.slice(0,r),o=e.slice(r+1),i=e.get(r);return a.createElement("ul",{className:"corrections-summary__paper-correction__author-list corrections-summary__paper-correction__swap-authorship"},n.map(e=>this.renderAuthor(e)),this.renderAuthor(i,{isRemove:!0}),this.renderAuthor(this.buildViewerAuthor(),{isAdd:!0}),o.map(e=>this.renderAuthor(e)))}render(){const{correction:e}=this.props,{paper:t}=this.state;if(!t)return null;const r=t.authors.map(e=>e.alias);return a.createElement("div",{className:"corrections-summary__paper-correction"},a.createElement("div",{className:"corrections-summary__paper-correction__title"},a.createElement(Ve.a,{to:"PAPER_DETAIL",params:{paperId:t.id,slug:t.slug}},t.title)),(()=>{switch(e.correctionType){case Re.a.AddAuthorship:return this.renderAddAuthorship(r);case Re.a.SwapAuthorship:return this.renderSwapAuthorship(r)}})())}}Lt(Mt,"contextTypes",{authStore:W.a.instanceOf(xe.a).isRequired,authorProfileStore:W.a.instanceOf(U.a).isRequired,correctionsStore:W.a.instanceOf(kt.a).isRequired});r(318);const qt={ChangeNameField:"authorName",ChangeOrcidField:"orcidId",ChangeHomepageField:"homepage",ChangeAffiliationField:"affiliations"},Ht=Object.keys(qt).reduce((e,t)=>(e[qt[t]]=t,e),{});var zt=Object.freeze(qt);Object.freeze(Ht);var Ut=r(39);function Bt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Vt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Yt=[Re.a.AddAuthorship,Re.a.SwapAuthorship],Wt=[Re.a.RemoveAuthorship];class Kt extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Bt(Object(r),!0).forEach((function(t){Vt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({errorMessage:null},this.getStateFromAuthStore(),{},this.getStateFromCorrectionsStore()),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())}),this.context.correctionsStore.registerComponent(this,()=>{this.setState(this.getStateFromCorrectionsStore())})}getStateFromAuthStore(){const{authStore:e}=this.context;return{authorId:e.getClaimedAuthorId()}}getStateFromCorrectionsStore(){const{correctionsStore:e}=this.context;return{isLoading:e.isLoading(),authorCorrectionsStatus:e.getAuthorCorrectionsStatus(),nameFieldCorrections:e.getFieldCorrectionsByName(zt.ChangeNameField),affiliationsFieldCorrections:e.getFieldCorrectionsByName(zt.ChangeAffiliationField),homepageFieldCorrections:e.getFieldCorrectionsByName(zt.ChangeHomepageField),orcidFieldCorrections:e.getFieldCorrectionsByName(zt.ChangeOrcidField),addCorrections:e.getPaperAuthorCorrectionsByTypes(Yt),addCorrectionsStatus:e.getPaperAuthorCorrectionsStatusByTypes(Yt),removeCorrections:e.getPaperAuthorCorrectionsByTypes(Wt),removeCorrectionsStatus:e.getPaperAuthorCorrectionsStatusByTypes(Wt)}}renderNameFieldCorrection(){const{nameFieldCorrections:e}=this.state;if(e.isEmpty())return null;const{previousValue:t}=e.first(),{changeValue:r}=e.last(),n=[t.first,...t.middle,t.last].join(" "),o=[r.first,...r.middle,r.last].join(" ");return a.createElement("li",{key:"name-field",className:"corrections-summary__author-corrections__item"},a.createElement("div",{className:"corrections-summary__author-corrections__item-label"},Object(f.b)(e=>e.correctionSummary.authorCorrections.nameFieldLabel)),a.createElement("div",{className:"corrections-summary__author-corrections__item-change"},a.createElement("div",{className:"corrections-summary__author-corrections__item-change__old-value"},n),a.createElement("div",{className:"corrections-summary__author-corrections__item-change__new-value"},o)))}renderAffiliationsFieldCorrection(){const{affiliationsFieldCorrections:e}=this.state;if(e.isEmpty())return null;const{previousValue:t}=e.first(),{changeValue:r}=e.last(),n=r.filter(e=>!t.includes(e)),o=t.filter(e=>!r.includes(e));return n.length+o.length===0?null:a.createElement("li",{key:"affiliations-field",className:"corrections-summary__author-corrections__item"},a.createElement("div",{className:"corrections-summary__author-corrections__item-label"},Object(f.b)(e=>e.correctionSummary.authorCorrections.affiliationsFieldLabel)),a.createElement("div",{className:"corrections-summary__author-corrections__item-change"},o.map(e=>a.createElement("div",{key:e,className:"corrections-summary__author-corrections__item-change__remove-value"},e)),n.map(e=>a.createElement("div",{key:e,className:"corrections-summary__author-corrections__item-change__add-value"},e))))}renderOrcidFieldCorrection(){var e,t;const{orcidFieldCorrections:r}=this.state;if(r.isEmpty())return null;const n=null!=(t=r.first())&&null!=(t=t.previousValue)?t.id:t,o=null!=(e=r.last())&&null!=(e=e.changeValue)?e.id:e;return a.createElement("li",{key:"orcid-field",className:"corrections-summary__author-corrections__item"},a.createElement("div",{className:"corrections-summary__author-corrections__item-label"},Object(f.b)(e=>e.correctionSummary.authorCorrections.orcidFieldLabel)),a.createElement("div",{className:"corrections-summary__author-corrections__item-change"},n&&a.createElement("div",{className:"corrections-summary__author-corrections__item-change__old-value"},n),o&&a.createElement("div",{className:"corrections-summary__author-corrections__item-change__new-value"},o)))}renderHomepageFieldCorrection(){const{homepageFieldCorrections:e}=this.state;if(e.isEmpty())return null;const t=e.first().previousValue,r=e.last().changeValue;return a.createElement("li",{key:"homepage-field",className:"corrections-summary__author-corrections__item"},a.createElement("div",{className:"corrections-summary__author-corrections__item-label"},Object(f.b)(e=>e.correctionSummary.authorCorrections.homepageFieldLabel)),a.createElement("div",{className:"corrections-summary__author-corrections__item-change"},t&&a.createElement("div",{className:"corrections-summary__author-corrections__item-change__old-value"},t),r&&a.createElement("div",{className:"corrections-summary__author-corrections__item-change__new-value"},r)))}renderAuthorCorrections(){const{authorCorrectionsStatus:e}=this.state,t=[this.renderNameFieldCorrection(),this.renderAffiliationsFieldCorrection(),this.renderOrcidFieldCorrection(),this.renderHomepageFieldCorrection()].filter(e=>!!e);return 0===t.length?null:a.createElement("section",{className:"corrections-summary__section corrections-summary__author-corrections"},a.createElement("h3",{className:"corrections-summary__correction-headline"},a.createElement("span",{className:"corrections-summary__correction-headline__text"},Object(f.b)(e=>e.correctionSummary.authorCorrections.headerText))),a.createElement(Qt,{status:e}),a.createElement("ul",{className:"corrections-summary__author-corrections__list"},t))}renderAddCorrections(){const{addCorrections:e}=this.state;return e.isEmpty()?null:a.createElement("section",{className:"corrections-summary__section corrections-summary__paper-corrections corrections-summary__add-corrections"},a.createElement("h3",{className:"corrections-summary__correction-headline"},a.createElement("span",{className:"corrections-summary__correction-headline__text"},Object(f.a)(e=>e.correctionSummary.addCorrections.headerText,e.size))),a.createElement("ul",{className:"corrections-summary__paper-corrections__list"},e.map(e=>a.createElement("li",{key:"add-"+(e.id||0),className:"corrections-summary__paper-corrections__item"},a.createElement(Qt,{status:e.completionStatus}),a.createElement(Mt,{correction:e})))))}renderRemoveCorrections(){const{removeCorrections:e}=this.state;return e.isEmpty()?null:a.createElement("section",{className:"corrections-summary__section corrections-summary__paper-corrections corrections-summary__remove-corrections"},a.createElement("h3",{className:"corrections-summary__correction-headline"},a.createElement("span",{className:"corrections-summary__correction-headline__text"},Object(f.a)(e=>e.correctionSummary.removeCorrections.headerText,e.size))),a.createElement("ul",{className:"corrections-summary__paper-corrections__list"},e.map(e=>a.createElement("li",{key:"remove-"+(e.id||0),className:"corrections-summary__paper-corrections__item"},a.createElement(Qt,{status:e.completionStatus}),a.createElement(Mt,{correction:e})))))}render(){return a.createElement("div",{className:"corrections-summary"},this.renderAuthorCorrections(),this.renderRemoveCorrections(),this.renderAddCorrections())}}function Qt(e){let{status:t}=e;return t?a.createElement("span",{className:"corrections-summary__correction-headline__status"},a.createElement("span",{className:"corrections-summary__correction-headline__status__label"},Object(f.b)(e=>e.correctionSummary.statusLabel[t])),(()=>{switch(t){default:return null;case Ut.a.Submitted:case Ut.a.Processing:return a.createElement(m.a,{icon:"status-waiting"});case Ut.a.Cancelled:case Ut.a.Failed:return a.createElement(m.a,{icon:"status-warning"});case Ut.a.Succeeded:return a.createElement(m.a,{icon:"status-approved"})}})()):null}function Gt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Xt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Vt(Kt,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,authStore:W.a.instanceOf(xe.a).isRequired,correctionsStore:W.a.instanceOf(kt.a).isRequired});class Jt extends a.Component{constructor(e,t){super(e,t),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Gt(Object(r),!0).forEach((function(t){Xt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthStore(),{},this.getStateFromAuthorCorrectionsStore()),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())}),this.context.authorCorrectionsStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorCorrectionsStore())})}getStateFromAuthStore(){const{authStore:e}=this.context;return{claimedAuthorId:e.getClaimedAuthorId()}}getStateFromAuthorCorrectionsStore(){const{authorCorrectionsStore:e}=this.context;return{isModeratorCorrecting:e.isModeratorCorrecting(),moderatorCorrectionsAuthorId:e.getModeratorCorrectionsAuthorId()}}render(){const{claimedAuthorId:e,isModeratorCorrecting:t,moderatorCorrectionsAuthorId:r}=this.state,n=t?r:e,i=Object(ye.d)({routeName:"AUTHOR_PROFILE_BY_ID",params:{authorId:n}});return a.createElement("div",{className:"account-correction-summary"},a.createElement("h2",{className:"account-correction-summary__headline"},Object(f.b)(e=>e.account.page.corrections.pageHeading)),a.createElement("div",{className:"account-correction-summary__description"},a.createElement(p.a,{content:Object(f.b)(e=>e.account.page.corrections.pageDescription,i)})),a.createElement(Kt,null),a.createElement(o,null,a.createElement(s,null,!!n&&a.createElement(Ve.a,{className:"account-correction-summary__link-button button button--primary",to:"AUTHOR_PROFILE_BY_ID",params:{authorId:n}},Object(f.b)(e=>e.account.page.corrections.authorPageLink)))))}}function Zt(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("shared-AccountCorrectionsStatusPage"),a.createElement(Jt,e)}Xt(Jt,"getPageTitle",()=>Object(f.b)(e=>e.account.page.corrections.pageTitle)),Xt(Jt,"contextTypes",{authStore:W.a.instanceOf(xe.a).isRequired,authorCorrectionsStore:W.a.instanceOf(z.a).isRequired});class $t extends a.Component{static async willRouteTo(e){let{api:t,authorCorrectionsStore:r}=e;const a=r.isModeratorCorrecting?r.getModeratorCorrectionsAuthorId():null;if(a)return Promise.all([t.fetchAuthorCorrectionsForAuthor({authorId:a}),t.fetchPaperAuthorCorrectionsForAuthor({authorId:a,includePaperModel:"PaperLite"})])}render(){return a.createElement(Zt,null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}($t,"getPageTitle",()=>Object(f.b)(e=>e.account.page.corrections.pageTitle));var er=r(659),tr=r(664),rr=r(665);function ar(){return(ar=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}class nr extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"onInputFilter",e=>{const{value:t}=e.currentTarget;this.setState({filterText:t}),this.props.onChange(t)}),this.state={filterText:""}}render(){const{filterText:e}=this.state;return a.createElement("div",{className:"author-remove-papers__filter"},a.createElement("input",ar({id:"remove-filter-input",className:"legacy__input author-remove-papers__filter__input",type:"text",value:e,placeholder:Object(f.b)(e=>e.authorRemovePapers.filterLabel)},Object(y.b)({id:"author_remove_paper_filter"}),{onChange:this.onInputFilter})),a.createElement(m.a,{icon:"filter"}))}}function or(){if(!Object(De.a)())return;const e=window.document.getElementById("remove-filter-input");e&&(e.value="",e.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})),e.focus())}class ir extends a.PureComponent{getClearFilterButton(){return a.createElement("div",{className:"author-remove-papers__blank-state__clear-filter"},a.createElement("button",{className:"author-remove-papers__blank-state__clear-filter-button button button--secondary",onClick:or},Object(f.b)(e=>e.authorRemovePapers.clearFilter)))}render(){const{hasAuthorPapers:e,filterText:t}=this.props,r=e?Object(f.b)(e=>e.authorRemovePapers.blankFilterLabel,t):Object(f.b)(e=>e.authorRemovePapers.blankPaperLabel);return a.createElement("div",{className:"author-remove-papers__blank-state"},a.createElement("div",{className:"author-remove-papers__blank-state__content"},a.createElement(m.a,{className:"author-remove-papers__blank-state__icon",icon:"paper-question-mark",width:"60",height:"77.5"}),a.createElement("div",{className:"author-remove-papers__blank-state__description"},r),e&&this.getClearFilterButton()))}}function sr(){return(sr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function lr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function cr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ur extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),cr(this,"onClickRemove",e=>{e.preventDefault();const{authorCorrectionsStore:t}=this.context,{paperLite:r,viewerAuthorId:a}=this.props;t.enqueueRemovePaperCorrection({paperId:r.id,position:dr(a,r)})}),cr(this,"onClickUndo",e=>{e.preventDefault();const{authorCorrectionsStore:t}=this.context,{paperLite:r}=this.props;t.cancelPendingCorrectionByPaperId(r.id)}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?lr(Object(r),!0).forEach((function(t){cr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthorCorrectionsStore()),this.context.authorCorrectionsStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorCorrectionsStore())})}getStateFromAuthorCorrectionsStore(){const{authorCorrectionsStore:e}=this.context,{paperLite:t}=this.props;return{hasPendingRemove:e.getPendingCorrectionTypeForPaperId(t.id)===Re.a.RemoveAuthorship}}render(){const{paperLite:e,viewerAuthorId:t}=this.props,{hasPendingRemove:r}=this.state,n=function(e){let{venue:t,year:r}=e;if(t&&r)return Object(f.b)(e=>e.authorRemovePapers.publisher.bothYearAndVenue,r,t);if(r)return Object(f.b)(e=>e.authorRemovePapers.publisher.onlyYear,r);if(t)return Object(f.b)(e=>e.authorRemovePapers.publisher.onlyVenue,t);return null}({year:e.year,venue:e.venue}),o=function(e,t){return"number"==typeof dr(e,t)}(t,e);return a.createElement("div",{className:D()({"author-remove-papers__paper":!0,"author-remove-papers__paper__has-pending-remove":r,"author-remove-papers__paper__locked":!o})},!o&&a.createElement("div",{className:"author-remove-papers__paper__status-message"},Object(f.b)(e=>e.authorRemovePapers.error.correctionPending)),a.createElement("div",{className:"author-remove-papers__paper__controls-left"},a.createElement("div",sr({role:"button",className:"author-remove-papers__paper__remove-button"},Object(y.b)({id:"author_remove_paper_remove"}),{onClick:o?this.onClickRemove:null}),a.createElement(m.a,{icon:"circle-plus"}))),a.createElement("div",{className:"author-remove-papers__paper__details"},a.createElement("div",{className:"author-remove-papers__paper__title"},e.title),a.createElement("div",{className:"author-remove-papers__paper__authors"},e.authors.map(e=>e.alias.name).join(", ")),n&&a.createElement("div",{className:"author-remove-papers__paper__publisher"},n)),a.createElement("div",{className:"author-remove-papers__paper__controls-right"},a.createElement("div",sr({role:"button",className:"author-remove-papers__paper__undo-button"},Object(y.b)({id:"author_remove_paper_undo"}),{onClick:this.onClickUndo}),Object(f.b)(e=>e.authorRemovePapers.undoLabel))))}}function dr(e,t){const r=e.toString(),a=t.authors.findIndex(e=>e.alias.ids.includes(r));return a>=0?a:null}function hr(e){let{numPapers:t,onRemoveAll:r}=e;return a.createElement("div",{className:"author-remove-papers__results-header"},a.createElement("div",{className:"author-remove-papers__results-header__left"},Object(f.a)(e=>e.authorRemovePapers.numResults,t)),a.createElement("div",{className:"author-remove-papers__results-header__right"},a.createElement("button",{className:"author-remove-papers__results-header__link-button",onClick:r,disabled:0===t,type:"button"},Object(f.b)(e=>e.authorRemovePapers.removeAllLabel))))}function pr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}cr(ur,"contextTypes",{authorCorrectionsStore:W.a.instanceOf(z.a).isRequired});class mr extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),pr(this,"onRemoveAll",()=>{const{authorId:e}=this.props,{authorPapers:t,filteredPaperIds:r}=this.state,{authorCorrectionsStore:a}=this.context;(r?t.filter(e=>r.has(e.id)):t).forEach(t=>{const r=t.authors.findIndex(t=>t.alias.ids.includes(e.toString()));V()(r>=0,"viewing author is not in paper's list of authors"),a.enqueueRemovePaperCorrection({paperId:t.id,position:r})})}),this.state={isLoading:!1,isInitialLoad:!0,errorMessage:null,authorPapers:le.List(),filteredPaperIds:null,filterText:""},this.onChangeFilterThrottled=Object(be.a)(this.onChangeFilter.bind(this),1e3,{leading:!0,trailing:!0})}componentDidMount(){this.fetchAuthorPapers().catch(e=>this.onApiError(e))}onApiError(e){w.a.error("Api Error",e),this.setState({errorMessage:Object(f.b)(e=>e.authorRemovePapers.error.apiQueryFailed),isLoading:!1,isInitialLoad:!1})}onChangeFilter(e){this.setState({filterText:e},()=>{this.filterAuthorPapers().catch(e=>this.onApiError(e))})}async fetchAuthorPapers(){var e,t;await Object(ge.e)(this,{isLoading:!0});const{authorId:r}=this.props,{api:a}=this.context,n=await a.fetchPapersWithCorrectionsAppliedForAuthor({authorId:r,model:"PaperLite"});await Object(ge.e)(this,{isLoading:!1,isInitialLoad:!1});const o=null!=(t=n)&&null!=(t=t.resultData)?t.authorId:t;V()(r===o,"browser and server author IDs do not match");const i=le.List((null!=(e=n)&&null!=(e=e.resultData)?e.paperLites:e)||[]).map(we.a.fromJs);await Object(ge.e)(this,{authorPapers:i})}async filterAuthorPapers(){var e,t;const{filterText:r}=this.state;if(!r)return Object(ge.e)(this,{filteredPaperIds:null});const{authorId:a}=this.props,{api:n}=this.context;await Object(ge.e)(this,{isLoading:!0,isInitialLoad:!0});const o=await n.fetchPapersWithCorrectionsAppliedForAuthor({authorId:a,model:"PaperId",filterText:r});await Object(ge.e)(this,{isLoading:!1,isInitialLoad:!1});const i=null!=(t=o)&&null!=(t=t.resultData)?t.authorId:t;if(V()(a===i,"browser and server author IDs do not match"),r!==this.state.filterText)return void w.a.info("Dropping old filter data",{queryFilterText:r,currentFilterText:this.state.filterText});const s=le.Set(((null!=(e=o)&&null!=(e=e.resultData)?e.paperIds:e)||[]).map(e=>e.id));await Object(ge.e)(this,{filteredPaperIds:s})}render(){const{authorId:e}=this.props,{isLoading:t,isInitialLoad:r,authorPapers:n,filteredPaperIds:o,filterText:i}=this.state,s=o?n.filter(e=>o.has(e.id)):n;return a.createElement("div",{className:D()({"author-remove-papers":!0,"author-remove-papers__is-empty":n.isEmpty(),"author-remove-papers__is-loading":t})},a.createElement("div",{className:"author-remove-papers__controls"},a.createElement(hr,{numPapers:s.size,onRemoveAll:this.onRemoveAll}),a.createElement(nr,{onChange:this.onChangeFilterThrottled})),s.isEmpty()&&!r&&a.createElement(ir,{hasAuthorPapers:!n.isEmpty(),filterText:i}),a.createElement("div",{className:D()({"author-remove-papers__papers":!0,"author-remove-papers__papers-loading":t})},t&&a.createElement(Ce.a,null),!t&&s.map(t=>a.createElement(ur,{key:t.id,paperLite:t,viewerAuthorId:e}))))}}function br(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function gr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}pr(mr,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,authorCorrectionsStore:W.a.instanceOf(z.a).isRequired});class fr extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),gr(this,"handleReset",()=>{const{authorCorrectionsStore:e}=this.context;e.clearPendingCorrections(Re.a.RemoveAuthorship)}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?br(Object(r),!0).forEach((function(t){gr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):br(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthorCorrectionsStore(),{},this.getStateFromAuthorStore()),this.context.authorCorrectionsStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorCorrectionsStore())}),this.context.authorStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorStore())})}getStateFromAuthorCorrectionsStore(){const{authorCorrectionsStore:e}=this.context;return{stagedPapersCount:e.getPendingCorrections().filter(e=>e.correctionType===Re.a.RemoveAuthorship).size,isModeratorCorrecting:e.isModeratorCorrecting()}}getStateFromAuthorStore(){var e;const{authorStore:t}=this.context;return{authorName:null!=(e=t)&&null!=(e=e.authorDetail)&&null!=(e=e.author)?e.name:e}}render(){const{stagedPapersCount:e,isModeratorCorrecting:t,authorName:r}=this.state;if(!e)return null;const n=t?Object(f.a)(e=>e.moderatorCorrections.removePapers.status,e,r):Object(f.a)(e=>e.authorRemovePapers.stagedRemoveCorrections,e);return a.createElement("div",{className:"author-remove-papers-papers-count"},a.createElement(p.a,{content:n}),a.createElement("span",{className:"middot"},""),a.createElement("button",{className:"author-remove-papers-papers-count__link-button",onClick:this.handleReset},Object(f.b)(e=>e.authorRemovePapers.resetStagedLabel)))}}function _r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function yr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}gr(fr,"contextTypes",{authorCorrectionsStore:W.a.instanceOf(z.a).isRequired,authorStore:W.a.instanceOf(H.a).isRequired});class Er extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),yr(this,"onSubmitForm",e=>{e.preventDefault(),this.attemptSubmit()}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_r(Object(r),!0).forEach((function(t){yr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_r(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({isSending:!1,errorMessage:null,successMessage:null},this.getStateFromAuthStore(),{},this.getStateFromAuthorCorrectionsStore(),{},this.getStateFromAuthorStore()),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())}),this.context.authorCorrectionsStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorCorrectionsStore())}),this.context.authorStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorStore())}),this.state.authorId=this.state.isModeratorCorrecting?this.state.moderatorCorrectionsAuthorId:this.state.authorId}getStateFromAuthStore(){const{authStore:e}=this.context;return{authorId:e.getClaimedAuthorId()}}getStateFromAuthorCorrectionsStore(){const{authorCorrectionsStore:e}=this.context;return{isFormDirty:e.hasPendingCorrections()||e.hasDraftPapers(),pendingCorrections:e.getPendingCorrections().filter(e=>e.correctionType===Re.a.RemoveAuthorship),isModeratorCorrecting:e.isModeratorCorrecting(),moderatorCorrectionsAuthorId:e.getModeratorCorrectionsAuthorId()}}getStateFromAuthorStore(){var e;const{authorStore:t}=this.context;return{authorName:null!=(e=t)&&null!=(e=e.authorDetail)&&null!=(e=e.author)?e.name:e}}async attemptSubmit(){const{authorId:e,pendingCorrections:t,isModeratorCorrecting:r}=this.state,{api:a,authorCorrectionsStore:n}=this.context;await Object(ge.e)(this,{isSending:!0,errorMessage:null,successMessage:null});try{await a.submitPaperAuthorCorrections({authorId:e,corrections:t.toJS()}),await n.clearPendingCorrections();const{history:o}=this.context,i=r?"AUTHOR_CORRECTIONS_TOOL_STATUS":"ACCOUNT_CORRECTIONS";o.push(Object(ye.d)({routeName:i}))}catch(e){w.a.error("Failed to submit paper changes",e),this.setState({isSending:!1,errorMessage:Object(f.b)(e=>e.authorRemovePapers.error.apiSubmitFailed),successMessage:null})}}renderMessage(){const{errorMessage:e,successMessage:t}=this.state;return e?a.createElement("div",{className:"account__error-msg"},e):t?a.createElement("div",{className:"account__success-msg"},t):null}render(){const{authorId:e,isSending:t,isFormDirty:r,isModeratorCorrecting:n,authorName:c}=this.state,u=Object(ye.d)({routeName:"AUTHOR_PROFILE_BY_ID",params:{authorId:e}}),d=n?Object(f.b)(e=>e.moderatorCorrections.removePapers.pageHeading,c):Object(f.b)(e=>e.account.page.removePapers.pageHeading),h=n?Object(f.b)(e=>e.moderatorCorrections.removePapers.pageDescription):Object(f.b)(e=>e.account.page.removePapers.pageDescription,u);return a.createElement("div",{className:"account-remove-papers"},a.createElement("div",{className:"account-remove-papers__headline"},d),a.createElement("div",{className:"account-remove-papers__description"},a.createElement(p.a,{content:h})),a.createElement("hr",{className:"account__divider"}),e&&a.createElement(mr,{key:e,authorId:e}),a.createElement(o,null,a.createElement(i,null,a.createElement(fr,null)),a.createElement(l,null,this.renderMessage()),a.createElement(s,null,t&&a.createElement(m.a,{className:"account__loading",icon:"gear"}),a.createElement("button",{className:"account-remove-papers__submit-button button button--primary",onClick:this.onSubmitForm},Object(f.b)(e=>e.account.button.submit)))),a.createElement(ke,{when:r,message:Object(f.b)(e=>e.authorRemovePapers.error.dirtyForm)}))}}function Or(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("shared-AccountRemovePapersPage"),a.createElement(Er,e)}yr(Er,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,authStore:W.a.instanceOf(xe.a).isRequired,authorCorrectionsStore:W.a.instanceOf(z.a).isRequired,authorStore:W.a.instanceOf(H.a).isRequired,history:W.a.instanceOf(Ne.a).isRequired});class Sr extends a.Component{render(){return a.createElement(Or,null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Sr,"getPageTitle",()=>Object(f.b)(e=>e.account.page.removePapers.pageTitle));var vr=r(567);class Cr extends a.PureComponent{render(){const{navItems:e,activeRouteName:t}=this.props;return a.createElement("nav",{className:"admin-nav"},a.createElement("ul",{className:"admin-nav__list"},e.map((e,r)=>{let{routeName:n,label:o}=e;const i=n===t;return a.createElement("li",{key:r,className:D()({"admin-nav__item":!0,"admin-nav__is-active":i})},a.createElement(Ve.a,{to:n},o))})))}}var wr=r(405),Pr=r(369),xr=r(100);function Rr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Nr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class jr extends a.Component{componentDidMount(){const{history:e}=this.context;if("ADMIN"===Object(ye.c)(e.location.pathname)){const t=new St.a(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Rr(Object(r),!0).forEach((function(t){Nr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.pickRedirectRoute(),{replace:!0,status:302}));Object(Ot.a)({redirect:t,history:e})}}pickRedirectRoute(){return{routeName:"ADMIN_EXPERIMENTS"}}getActiveRouteName(){var e;const{history:t}=this.context,{route:r}=this.props,a=null!=(e=Object(xr.a)(r.routes,t.location.pathname))&&null!=(e=e[0])&&null!=(e=e.route)?e.path:e;return Object(ye.c)(a)||"ADMIN_EXPERIMENTS"}getNavItems(){return[{routeName:"ADMIN_EXPERIMENTS",label:Object(f.b)(e=>e.admin.nav.experimentsLabel)},{routeName:"ADMIN_FEATURE_FLAGS",label:Object(f.b)(e=>e.admin.nav.featureFlagsLabel)}]}render(){const{route:e}=this.props,t=this.getNavItems(),r=this.getActiveRouteName();return a.createElement(Pr.a,{header:a.createElement(wr.a,{isAdminPage:!0})},a.createElement("div",{className:"admin",role:"main"},a.createElement("h2",{className:"admin__header"},Object(f.b)(e=>e.admin.headerLabel)),a.createElement(Cr,{navItems:t,activeRouteName:r}),a.createElement("div",{className:"admin__sub-page"},Object(xr.b)(e.routes))))}}function Tr(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AdminPage"),a.createElement(jr,e)}function Ar(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Nr(jr,"contextTypes",{history:W.a.instanceOf(Ne.a).isRequired});class Ir extends a.Component{render(){return a.createElement(Tr,this.props)}}function Fr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Ar(Ir,"getPageTitle",()=>Object(f.b)(e=>e.moderation.pageTitle)),Ar(Ir,"requiresAuthentication",()=>!0);class kr extends a.PureComponent{constructor(){super(...arguments),Fr(this,"onChangePercentage",e=>{const{onChange:t,name:r}=this.props;if(t){t(r,parseFloat(e.currentTarget.value)/100)}}),Fr(this,"onChangeValue",e=>{const{onChange:t,name:r}=this.props;if(t){t(r,parseFloat(e.currentTarget.value))}})}render(){const{min:e,max:t,step:r,value:n,name:o,showPercentage:i,showValue:s,isDisabled:l}=this.props;return a.createElement("div",{className:"admin__ratio-slider"},a.createElement("input",{className:"legacy__input admin__ratio-slider__range",type:"range",name:o+"__range",min:e,max:t,step:r,value:n,onChange:this.onChangeValue,disabled:l}),i&&a.createElement("input",{className:"legacy__input admin__ratio-slider__input admin__ratio-slider__percentage",type:"text",name:o+"__value",min:e,max:t,value:(100*n|0)+"%",onChange:this.onChangePercentage,disabled:l}),s&&a.createElement("input",{className:"legacy__input admin__ratio-slider__input admin__ratio-slider__value",type:"text",name:o+"__value",min:e,max:t,value:n,onChange:this.onChangeValue,disabled:l}))}}Fr(kr,"defaultProps",{max:1,min:0,showPercentage:!0,showValue:!1,step:.01,isDisabled:!1});var Dr=r(154);function Lr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Mr extends a.PureComponent{constructor(){super(...arguments),Lr(this,"onChangeVariationRatio",(e,t)=>{const{experiment:r,onChange:a}=this.props;a(r.KEY,t.KEY,parseFloat(e.currentTarget.value)/100)})}getVariationRatio(e){const{experiment:t,variationRatios:r}=this.props,a=r.get(t.KEY);return a?parseFloat(a.get(e)):0}render(){const{experiment:e,isDisabled:t}=this.props;return a.createElement(a.Fragment,null,a.createElement("span",{className:"admin__experiment__details__label"},Object(f.b)(e=>e.admin.experiments.variationsLabel)),a.createElement("ul",null,e.variations.map(r=>a.createElement("li",{key:r.KEY},r.KEY===e.defaultVariation?r.KEY+"*":r.KEY,a.createElement("input",{type:"text",value:(100*this.getVariationRatio(r.KEY)|0)+"%",onChange:e=>this.onChangeVariationRatio(e,r),className:"legacy__input admin__variation-input",disabled:t})))))}}Lr(Mr,"contextTypes",{experimentsStore:W.a.instanceOf(Dr.a).isRequired}),Lr(Mr,"defaultProps",{isDisabled:!1});var qr=r(18),Hr=r(92),zr=(r(329),r(46)),Ur=r(32),Br=r(94),Vr=r(98);function Yr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Wr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Kr extends a.Component{constructor(e,t){super(e,t),Wr(this,"onChangeRatio",(e,t)=>{const{ratios:r}=this.state;r.set(e,t),this.setState({ratios:new Map(r)})}),Wr(this,"clearErrors",()=>{this.setState({errors:new Map})}),Wr(this,"onChangeVariationRatio",(e,t,r)=>{const a=this.state.variationRatios,n=a.get(e);n?n.set(t,r):a.set(e,new Map([[t,r]])),this.setState({variationRatios:new Map(a)})}),Wr(this,"onSubmitUpdate",async e=>{var t;const{ratios:r,experimentStates:a,errors:n}=this.state,{api:o}=this.context,i=a.get(e.KEY),s=Gr(a.get(e.KEY)),l=this.generateVariationRatios(e.KEY,e.variations),c=(null!=(t=i)?t.trafficRatio:t)||0,u=r.get(e.KEY),d=u||c,h=u?u-c:0;if(this.validateSubmission(l.sum,h,e,s),0===n.size){const t={key:e.KEY,variations:l.ratios,trafficRatio:d,status:d>0?zr.d:zr.c,salt:e.KEY};try{await o.setExperimentState(t),await o.getExperiments()}catch(t){this.setState({errors:n.set(e.KEY,Object(f.b)(e=>e.admin.errors.apiError))})}}}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Yr(Object(r),!0).forEach((function(t){Wr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({errors:new Map},this.getStateFromExperimentsStore()),this.context.experimentsStore.registerComponent(this,()=>{this.setState(this.getStateFromExperimentsStore())})}getStateFromExperimentsStore(){const{experimentsStore:e}=this.context,t=e.getExperimentStates()?new Map(Object.entries(e.getExperimentStates())):new Map,r=new Map,a=new Map;return t.forEach((e,t)=>{const n=e.trafficRatio;r.set(t,n);const o=new Map;e.variations.forEach(e=>{o.set(e.key,e.ratio)}),a.set(e.key,o)}),{experimentStates:t,ratios:r,variationRatios:a}}terminateExperiment(e){this.clearErrors();const{dispatcher:t}=this.context;t.dispatch(Object(Br.b)({id:Ur.b.TERMINATE_EXPERIMENT,data:e}))}validateSubmission(e,t,r,a){const{errors:n}=this.state;switch(this.clearErrors(),Math.abs(e-1)>Number.EPSILON&&(n.set(r.KEY,Object(f.b)(e=>e.admin.errors.validVariationRatios)),this.setState({errors:new Map(n)})),a){case zr.d:t<0&&(n.set(r.KEY,Object(f.b)(e=>e.admin.errors.alreadyRunning)),this.setState({errors:new Map(n)}));break;case zr.a:n.set(r.KEY,Object(f.b)(e=>e.admin.errors.finishedExperiment)),this.setState({errors:new Map(n)})}}generateVariationRatios(e,t){const r=this.state.variationRatios.get(e),a=[];let n=0;return t.forEach(e=>{const t=r?r.get(e.KEY):0;a.push({key:e.KEY,ratio:t||0}),n+=t||0}),{ratios:a,sum:n}}render(){const{ratios:e,experimentStates:t,variationRatios:r,errors:n}=this.state,{envInfo:{hostname:o}}=this.context;return a.createElement("div",{className:"admin__experiments"},a.createElement("ul",{className:"admin__experiments__experiment-list"},Object(qr.e)(qr.b).map(i=>a.createElement("li",{key:i.KEY,className:"admin__experiments__experiment"},a.createElement(Qr,{error:n.get(i.KEY),hostname:o,experiment:i,onChangeRatio:this.onChangeRatio,onSubmitUpdate:this.onSubmitUpdate,experimentStoreModel:t.get(i.KEY),onClickTerminate:()=>this.terminateExperiment(i),ratio:e.get(i.KEY)||0,variationRatios:r,onChangeVariationRatio:this.onChangeVariationRatio})))))}}function Qr(e){let{error:t,experiment:r,hostname:n,ratio:o,onChangeRatio:i,onSubmitUpdate:s,onClickTerminate:l,variationRatios:c,onChangeVariationRatio:u,experimentStoreModel:d}=e;const h=Object(De.c)(n),p=Object(De.d)(n),m=!h&&!p,b=Gr(d),g=function(e){var t;const r=(e&&(null!=(t=e)?t.variations:t)||[]).find(e=>1==e.ratio)||null;return r?r.key:null}(d),_=r.defaultVariation,y=g!==_,E=b===zr.a,O=b===zr.d,S=b===zr.c;return a.createElement("div",{className:D()("admin__experiment",{"admin__experiment__finished ":E})},a.createElement("div",{className:"admin__experiment__details"},a.createElement("div",{className:"admin__experiment__details__row admin__experiment__key"},r.KEY," ",a.createElement(Ve.a,{to:"ADMIN_EXPERIMENT_AUDIT",params:{key:r.KEY}},"audit")),r.description?a.createElement("div",{className:"admin__experiment__details__row admin__experiment__desc"},r.description):a.createElement("div",{className:"admin__experiment__details__row admin__experiment__desc admin__experiment__desc--not-set"},Object(f.b)(e=>e.admin.experiments.descNotSetLabel)),a.createElement("div",{className:"admin__experiment__details__row admin__experiment__variations"},a.createElement(Mr,{experiment:r,max:100,min:0,variationRatios:c,onChange:u,isDisabled:O||E})),a.createElement("div",{className:"admin__experiment__details__row admin__experiment__status"},a.createElement("span",{className:"admin__experiment__details__label"},Object(f.b)(e=>e.admin.experiments.statusLabel)),a.createElement("span",{className:D()("admin__experiment__details__value",{"admin-experiment__status-running":b===zr.d,"admin-experiment__status-pending":b===zr.c,"admin-experiment__status-finished":b===zr.a})},b),E&&g&&a.createElement("div",{className:"admin__experiment__details__row admin__experiment__default"},a.createElement("span",{className:"admin__experiment__details__label"},Object(f.b)(e=>e.admin.experiments.defaultVariationLabel)),a.createElement("span",{className:"admin__experiment__details__default__value"},g,y&&a.createElement("div",null,a.createElement("div",{className:"admin-warning"},'WARNING - HARDCODED DEFAULT IS STILL "',_,'"'),a.createElement("div",null,"Please remove the experiment or update the defaultVariation in code so tests/local reflect reality."))))),r.path&&a.createElement("div",{className:"admin__experiment__details__row admin__experiment__path"},a.createElement("span",{className:"admin__experiment__details__label"},Object(f.b)(e=>e.admin.experiments.pathLabel)),a.createElement("span",{className:"admin__experiment__details__value"},r.path)),r.manualExposure&&a.createElement("div",{className:"admin__experiment__details__row admin__experiment__manual-exposure"},a.createElement("span",{className:"admin__experiment__details__label"},Object(f.b)(e=>e.admin.experiments.manuallyExposedLabel)),a.createElement("span",{className:"admin__experiment__details__value"},r.manualExposure.toString()))),a.createElement("div",{className:"admin__experiment__inputs"},h&&a.createElement("div",{className:"admin__experiment__slider"},a.createElement("div",{className:"admin__experiment__slider__label"},Object(f.b)(e=>e.admin.experiments.localLabel)),a.createElement(kr,{name:"".concat(r.KEY),value:o,onChange:i,showPercentage:!0,isDisabled:E}),a.createElement("button",{className:"admin__experiment__update button button--secondary",disabled:E,onClick:()=>s(r)},Object(f.b)(e=>e.admin.updateButton))),m&&a.createElement("div",{className:"admin__experiment__slider"},a.createElement("div",{className:"admin__experiment__slider__label"},Object(f.b)(e=>e.admin.experiments.devLabel)),a.createElement(kr,{name:"".concat(r.KEY),value:o,onChange:i,showPercentage:!0,isDisabled:E}),a.createElement("button",{className:"admin__experiment__update button button--secondary",disabled:E,onClick:()=>s(r)},Object(f.b)(e=>e.admin.updateButton))),p&&a.createElement("div",{className:"admin__experiment__slider"},a.createElement("div",{className:"admin__experiment__slider__label"},Object(f.b)(e=>e.admin.experiments.prodLabel)),a.createElement(kr,{name:"".concat(r.KEY),value:o,onChange:i,showPercentage:!0,isDisabled:E}),a.createElement("button",{className:"admin__experiment__update button button--secondary",disabled:E,onClick:()=>s(r)},Object(f.b)(e=>e.admin.updateButton))),a.createElement("button",{className:"button button--primary admin__experiment__terminate-button",disabled:E||S,onClick:l},Object(f.b)(e=>e.admin.experiments.terminateButtonLabel)),t&&a.createElement("span",{className:"admin__experiment__update__error"},t)))}function Gr(e){var t;return(null!=(t=e)&&null!=(t=t.status)?t.value:t)||zr.b}function Xr(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AdminExperimentsPage"),a.createElement(Kr,e)}Wr(Kr,"contextTypes",{dispatcher:W.a.instanceOf(Vr.Dispatcher).isRequired,experimentsStore:W.a.instanceOf(Dr.a).isRequired,envInfo:W.a.instanceOf(Hr.a).isRequired,api:W.a.instanceOf(fe.a).isRequired});class Jr extends a.Component{static willRouteTo(e){let{api:t}=e;return t.getExperiments()}render(){return a.createElement(Xr,null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Jr,"getPageTitle",()=>Object(f.b)(e=>e.general.appName));var Zr=r(2),$r=r.n(Zr),ea=r(376);function ta(e){let{experimentKey:t}=e;const[r,n]=a.useState(!0),[o,i]=a.useState([]),{api:s}=Object(ze.c)();return t?(a.useEffect(()=>{s.getExperimentAudit(t).then(e=>{i(e.resultData),n(!1)})},[]),r?a.createElement("div",null,"Loading..."):a.createElement("table",null,a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",null,"Date"),a.createElement("th",null,"Status"),a.createElement("th",null,"Traffic Ratio"),a.createElement("th",null,"Variation Ratios"))),a.createElement("tbody",null,o.map(e=>a.createElement("tr",{key:e.id},a.createElement(ra,null,$r.a.unix(e.createdAtUtc).format("lll")),a.createElement(ra,null,e.status.value),a.createElement(ra,null,e.trafficRatio),a.createElement(ra,null,a.createElement("ul",null,e.variations.map(e=>a.createElement("li",{key:e.key},e.key,": ",e.ratio))))))))):"No experiment key found"}const ra=ea.a.td.withConfig({displayName:"AdminExperimentAuditPage__StyledTD",componentId:"sc-1uauilp-0"})(["padding:10px;"]);function aa(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AdminExperimentAuditPage"),a.createElement(ta,e)}function na(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class oa extends a.Component{render(){var e;const{match:t}=this.props,r=null!=(e=t)&&null!=(e=e.params)?e.key:e;return a.createElement(aa,{experimentKey:r})}}na(oa,"getPageTitle",()=>Object(f.b)(e=>e.general.appName)),na(oa,"requiresAuthentication",()=>!0);var ia=r(14),sa=r(166);r(330);function la(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ca(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ua extends a.Component{constructor(e,t){super(e,t),ca(this,"onChangeRatio",(e,t)=>{const{ratios:r}=this.state;r.set(e,t),this.setState({ratios:new Map(r)})}),ca(this,"onSubmitUpdate",async e=>{var t;const{ratios:r,featureFlags:a,errors:n}=this.state,{api:o}=this.context;this.setState({errors:new Map});const i=a.get(e.KEY),s=r.get(e.KEY),l=s||0===s?s:(null!=(t=i)?t.trafficRatio:t)||0;if(0===n.size){const t={key:e.KEY,trafficRatio:l,salt:e.KEY};try{await o.setFeatureFlagState(t),await o.getFeatureFlags()}catch(t){this.setState({errors:n.set(e.KEY,Object(f.b)(e=>e.admin.errors.apiError))})}}}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?la(Object(r),!0).forEach((function(t){ca(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):la(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({errors:new Map},this.getStateFromFeatureFlagStore()),this.context.featureFlagStore.registerComponent(this,()=>{this.setState(this.getStateFromFeatureFlagStore())})}getStateFromFeatureFlagStore(){const{featureFlagStore:e}=this.context,t=e.getFeatureFlags()?new Map(Object.entries(e.getFeatureFlags())):new Map,r=new Map;return t.forEach((e,t)=>{const a=e.trafficRatio||0;r.set(t,a)}),{featureFlags:t,ratios:r}}render(){const{ratios:e,errors:t}=this.state,{envInfo:{hostname:r}}=this.context;return a.createElement("div",{className:"admin__features"},a.createElement("ul",{className:"admin__features__feature-flag-list"},Object(ia.c)(ia.b).map(n=>a.createElement("li",{key:n.KEY,className:"admin__features__feature-flag"},a.createElement(da,{feature:n,onChangeRatio:this.onChangeRatio,ratio:e.get(n.KEY),hostname:r,onSubmitUpdate:this.onSubmitUpdate,error:t.get(n.KEY)})))))}}function da(e){let{hostname:t,feature:r,onChangeRatio:n,ratio:o,onSubmitUpdate:i,error:s}=e;const l=Object(De.c)(t),c=Object(De.d)(t),u=!l&&!c,d=c&&"number"==typeof o&&r.fallbackState!==(1===o);return a.createElement("div",{className:"admin__feature-flag"},a.createElement("div",{className:"admin__feature-flag__details"},a.createElement("div",{className:"admin__feature-flag__details__row admin__feature-flag__key"},r.KEY),r.description?a.createElement("div",{className:"admin__feature-flag__details__row admin__feature-flag__desc"},r.description):a.createElement("div",{className:"admin__feature-flag__details__row admin__feature-flag__desc admin__feature-flag__desc--not-set"},Object(f.b)(e=>e.admin.featureFlags.descNotSetLabel)),a.createElement("div",{className:"admin__feature-flag__details__row admin__feature-flag__fallback"},a.createElement("span",{className:"admin__feature-flag__details__label"},Object(f.b)(e=>e.admin.featureFlags.fallbackLabel)),a.createElement("span",{className:"admin__feature-flag__details__value"},Object(f.b)(e=>e.admin.featureFlags.fallbackState[r.fallbackState.toString()]))),!!d&&a.createElement("div",null,a.createElement("div",{className:"admin-warning"},'WARNING - HARDCODED FALLBACK IS STILL "',Object(f.b)(e=>e.admin.featureFlags.fallbackState[r.fallbackState.toString()]),'"'),a.createElement("div",null,"If this value should become the new fallback (so tests/local reflect prod reality) please update the fallback in code."))),a.createElement("div",{className:"admin__feature-flag__inputs"},l&&a.createElement("div",{className:"admin__feature-flag__slider"},a.createElement("div",{className:"admin__feature-flag__slider__label"},Object(f.b)(e=>e.admin.featureFlags.localLabel)),a.createElement(kr,{name:r.KEY,value:o||0,onChange:n,showPercentage:!0}),a.createElement("button",{className:"admin__experiment__update button button--secondary",onClick:()=>i(r)},Object(f.b)(e=>e.admin.updateButton))),u&&a.createElement("div",{className:"admin__feature-flag__slider"},a.createElement("div",{className:"admin__feature-flag__slider__label"},Object(f.b)(e=>e.admin.featureFlags.devLabel)),a.createElement(kr,{name:r.KEY,value:o||0,onChange:n,showPercentage:!0}),a.createElement("button",{className:"admin__feature-flag__update button button--secondary",onClick:()=>i(r)},Object(f.b)(e=>e.admin.updateButton))),c&&a.createElement("div",{className:"admin__feature-flag__slider"},a.createElement("div",{className:"admin__feature-flag__slider__label"},Object(f.b)(e=>e.admin.featureFlags.prodLabel)),a.createElement(kr,{name:r.KEY,value:o||0,onChange:n,showPercentage:!0}),a.createElement("button",{className:"admin__feature-flag__update button button--secondary",onClick:()=>i(r)},Object(f.b)(e=>e.admin.updateButton)),s&&a.createElement("span",{className:"admin__feature-flag__update__error"},s))))}function ha(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AdminFeatureFlagsPage"),a.createElement(ua,e)}ca(ua,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,envInfo:W.a.instanceOf(Hr.a).isRequired,featureFlagStore:W.a.instanceOf(sa.a).isRequired});class pa extends a.Component{static willRouteTo(e){let{api:t}=e;return t.getFeatureFlags()}render(){return a.createElement(ha,null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(pa,"getPageTitle",()=>Object(f.b)(e=>e.general.appName));var ma=r(653);function ba(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ga extends a.Component{static willRouteTo(){return new St.a({routeName:"ACCOUNT_ALERTS"})}render(){return null}}ba(ga,"requiresAuthentication",()=>!0),ba(ga,"getPageTitle",()=>Object(f.b)(e=>e.alerts.pageTitle));var fa=r(649),_a=r(666),ya=r(367),Ea=r(595),Oa=r(143),Sa=r(66),va=r(152),Ca=r(316);function wa(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Pa(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wa(Object(r),!0).forEach((function(t){xa(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wa(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function xa(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ra extends a.PureComponent{constructor(e,t){super(e,t),xa(this,"onClickFlag",()=>{const{moderationTag:e}=this.state,t=e?null:"Awaiting Response";this.setState({moderationTag:t});const{authorProfile:r}=this.props,{api:a}=this.context;a.setAuthorProfileModerationTag({authorProfileId:r.id,moderationTag:t})}),xa(this,"onClickInternalNotesSave",()=>{const e=this.state.draftInternalNotes;this.setState({internalNotes:e,draftInternalNotes:e}),this.updateInternalNotes(e)}),xa(this,"onChangeReason",e=>{const t=Object(va.d)(e.currentTarget.value);this.setState({isReasonHighlighted:!1,selectedReason:t})}),xa(this,"onClickApprove",()=>{const{selectedReason:e}=this.state;e?this.setState({isReasonHighlighted:!0}):(this.setState({selectedStatus:Sa.b.Approved}),this.updateModerationStatus(Sa.b.Approved))}),xa(this,"onClickDeny",()=>{const{selectedReason:e}=this.state;e&&va.a[e]?(this.setState({selectedStatus:Sa.b.Denied}),this.updateModerationStatus(Sa.b.Denied)):this.setState({isReasonHighlighted:!0})}),xa(this,"onChangeInternalNotes",e=>{const{value:t}=e.currentTarget;this.setState({draftInternalNotes:t})});const{authorProfile:r}=this.props;this.state=Pa({isConfirmVisible:!1,moderationTag:r.moderationTag,isReasonHighlighted:!1,internalNotes:r.internalNotes||"",selectedStatus:r.moderationStatus||null,selectedReason:r.moderationStatusReason||null,draftInternalNotes:r.internalNotes||""},this.getStateFromClaimModerationStore()),this.runRuleChecks(r.id),this.context.claimModerationStore.registerComponent(this,()=>{this.setState(Pa({},this.getStateFromClaimModerationStore()))})}async runRuleChecks(e){const{api:t}=this.context,r=await t.getModerationRecommendation({authorRowId:e});return r?r.resultData.result:Ca.a.InsufficientData}getStateFromClaimModerationStore(){const{claimModerationStore:e}=this.context;return{claimedAuthor:e.getClaimedAuthor(),claimedPreviously:e.getClaimedPreviousAuthorProfiles(),claimingAppUser:e.getClaimingAppUser(),orcidVerifyResult:e.getOrcidResult()}}async updateModerationStatus(e){const{authorProfile:t}=this.props,{internalNotes:r,selectedReason:a}=this.state,{api:n,authStore:o}=this.context,i=o.getEmail();V()(i,"User have an email to moderate.");const s=a?va.c[a]:null;await n.updateModerationStatus({authorProfileId:t.id,moderationStatus:e,moderator:i,moderatorNotes:"",moderationStatusReason:s,internalNotes:r}),this.props.onRefreshRows()}async updateInternalNotes(e){const{authorProfile:t}=this.props,{api:r}=this.context;await r.updateInternalNotes({authorProfileId:t.id,internalNotes:e})}renderAuthorName(){var e,t,r;const{authorProfile:n}=this.props,{claimedAuthor:o,claimingAppUser:i}=this.state,s=(null!=(r=n)?r.fullName:r)||a.createElement(ja,null),l=(null!=(t=o)?t.name:t)||a.createElement(ja,null),c=(null!=(e=i)?e.fullName:e)||a.createElement(ja,null);return a.createElement("div",{className:"moderation__author-claim__details__comparison"},a.createElement("div",null,a.createElement("span",{className:"moderation__author-claim__details__comparison__label"},"Claim Form"),a.createElement("span",{className:"moderation__author-claim__details__comparison__value"},s)),a.createElement("div",null,a.createElement("span",{className:"moderation__author-claim__details__comparison__label"},"Login Name"),a.createElement("span",{className:"moderation__author-claim__details__comparison__value"},c)),a.createElement("div",null,a.createElement("span",{className:"moderation__author-claim__details__comparison__label"},"Author Page"),a.createElement("span",{className:"moderation__author-claim__details__comparison__value"},l)))}renderEmail(){var e,t,r,n;const{authorProfile:o}=this.props,{claimingAppUser:i}=this.state,s=(null!=(n=o)?n.email:n)||a.createElement(ja,null),l=null!=(r=i)?r.email:r,c=(null!=(t=i)?t.alertEmail:t)||a.createElement(ja,null),u=(null!=(e=i)?e.alertEmailIsVerified:e)||!1;return a.createElement("div",{className:"moderation__author-claim__details__comparison"},a.createElement("div",null,a.createElement("span",{className:"moderation__author-claim__details__comparison__label"},"Claim Form"),a.createElement("span",{className:"moderation__author-claim__details__comparison__value"},s)),a.createElement("div",null,a.createElement("span",{className:"moderation__author-claim__details__comparison__label"},"Login Email"),a.createElement("span",{className:"moderation__author-claim__details__comparison__value"},l?a.createElement(a.Fragment,null,a.createElement(Ta,null)," ",l):a.createElement(ja,null))),a.createElement("div",null,a.createElement("span",{className:"moderation__author-claim__details__comparison__label"},"Alert Email"),a.createElement("span",{className:"moderation__author-claim__details__comparison__value"},u&&a.createElement(Ta,null)," ",c)))}renderFieldOfStudy(){const{claimingAppUser:e}=this.state;return e?0===e.fieldsOfStudy.size?a.createElement(ja,null):1===e.fieldsOfStudy.size?e.fieldsOfStudy.get(0):a.createElement("ul",null,e.fieldsOfStudy.map(e=>a.createElement("li",{key:e},e))):a.createElement(ja,null)}renderPreviouslyClaimed(){const{claimedPreviously:e}=this.state;return 0===e.size?a.createElement(ja,null):a.createElement("ul",null,e.map(e=>a.createElement("li",{key:e.id},a.createElement("div",{className:"moderation__author-claim__details__comparison"},a.createElement("div",null,a.createElement("span",{className:"moderation__author-claim__details__comparison__label"},"Name"),a.createElement("span",{className:"moderation__author-claim__details__comparison__value"},e.fullName)),a.createElement("div",null,a.createElement("span",{className:"moderation__author-claim__details__comparison__label"},"Author ID"),a.createElement("span",{className:"moderation__author-claim__details__comparison__value"},e.ai2AuthorId)),a.createElement("div",null,a.createElement("span",{className:"moderation__author-claim__details__comparison__label"},"Status"),a.createElement("span",{className:"moderation__author-claim__details__comparison__value"},e.moderationStatus)),a.createElement("div",null,a.createElement("span",{className:"moderation__author-claim__details__comparison__label"},"Reason"),a.createElement("span",{className:"moderation__author-claim__details__comparison__value"},e.moderationStatusReason))))))}renderInternalNotesHistory(){const e=this.state.internalNotes;return a.createElement("div",{className:"moderation__author-claim__details__comparison"},a.createElement("div",null,a.createElement("span",{className:"moderation__author-claim__details__comparison__label"},"Note"),a.createElement("span",{className:"moderation__author-claim__details__comparison__value"},e)))}renderOrcidCheck(){const e=this.state.orcidVerifyResult;if(e){if(e==Ca.a.Passed)return a.createElement(Ta,null);if(e==Ca.a.Failed)return a.createElement(m.a,{icon:"circle-x",width:"20",height:"20"});if(e==Ca.a.InsufficientData)return a.createElement(m.a,{icon:"status-warning",width:"20",height:"20"})}return a.createElement(ja,null)}formatHomepageUrl(e){return e.toLocaleLowerCase().startsWith("http")?e:"http://".concat(e)}render(){const{authorProfile:e}=this.props,{moderationTag:t,isReasonHighlighted:r,selectedStatus:n,selectedReason:o,claimingAppUser:i,draftInternalNotes:s}=this.state;return a.createElement("div",{className:"moderation__author-claim__details"},a.createElement("div",{className:"moderation__author-claim__details__header"},a.createElement(ya.a,{href:"/author/".concat(e.ai2AuthorId),className:"moderation__author-claim__details__name"},e.fullName),a.createElement("div",{className:D()({"moderation__author-claim__details__flag":!0,"moderation__author-claim__is-flagged":t}),title:"".concat(t?"Unflag":"Flag as",' "Awaiting Response"')},a.createElement(m.a,{icon:"moderation-flag",onClick:this.onClickFlag}))),a.createElement("div",{className:"moderation__author-claim__details__body"},a.createElement(Na,{label:"Author Name"},this.renderAuthorName()),a.createElement(Na,{label:"Affiliation(s)"},(()=>{switch(e.affiliations.length){case 0:return null;case 1:return e.affiliations.join("");default:return a.createElement("ul",{className:"moderation__author-claim__details__affiliations"},e.affiliations.map(e=>a.createElement("li",{key:e},e)))}})()),a.createElement(Na,{label:"Email(s)"},this.renderEmail()),a.createElement(Na,{label:"Field of Study"},this.renderFieldOfStudy()),a.createElement(Na,{label:"Current Role"},!!i&&i.currentRole),a.createElement(Na,{label:"ORCiD"},e.orcidId?a.createElement(Ea.a,{orcidId:e.orcidId}):null,this.renderOrcidCheck()),a.createElement(Na,{label:"Homepage"},e.homepageUrl&&a.createElement(ya.a,{href:this.formatHomepageUrl(e.homepageUrl)},e.homepageUrl)),a.createElement(Na,{label:"Previously Claimed"},this.renderPreviouslyClaimed()),a.createElement(Na,{label:"User Comment"},e.userComment),a.createElement(Na,{label:"Internal Notes"},this.renderInternalNotesHistory())),a.createElement("div",{className:"moderation__author-claim__details__footer"},a.createElement("div",{className:"moderation__author-claim__details__internal-notes"},a.createElement("textarea",{className:"legacy__textarea moderation__author-claim__details__internal-notes__input",placeholder:"Type note here...",onChange:this.onChangeInternalNotes,value:s}),a.createElement(m.a,{icon:"circle-plus",className:"moderation__author-claim__details__internal-notes__submit",title:"Save notes only",onClick:this.onClickInternalNotesSave})),a.createElement("select",{className:D()({legacy__select:!0,"moderation__author-claim__details__reason":!0,"moderation__author-claim__details__is-highlighted":r}),value:o||"",onChange:this.onChangeReason},a.createElement("option",{key:"",value:""}),Object.keys(va.c).map(e=>a.createElement("option",{key:e,value:e},va.c[e]))),a.createElement("div",{className:"moderation__author-claim__details__button-row","data-moderation-status":n||e.moderationStatus},a.createElement("button",{onClick:this.onClickApprove,className:"moderation__author-claim__details__button moderation__author-claim__details__button__approve"},a.createElement(m.a,{icon:"check-in-green-circle"}),a.createElement("span",{className:"moderation__author-claim__details__button__label"},"APPROVE")),a.createElement("button",{onClick:this.onClickDeny,className:"moderation__author-claim__details__button moderation__author-claim__details__button__deny"},a.createElement(m.a,{icon:"circle-x"}),a.createElement("span",{className:"moderation__author-claim__details__button__label"},"DENY")))))}}xa(Ra,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,authStore:W.a.instanceOf(xe.a).isRequired,claimModerationStore:W.a.instanceOf(Oa.a).isRequired});const Na=e=>{let{label:t,children:r}=e;return a.createElement("div",{className:"moderation__author-claim__details__field"},a.createElement("div",{className:"moderation__author-claim__details__field__label"},t),a.createElement("div",{className:"moderation__author-claim__details__field__value"},null==r?a.createElement(ja,null):r))},ja=()=>a.createElement("div",{className:"moderation__author-claim__details__field__value__missing"},"No Value"),Ta=()=>a.createElement(Aa,{icon:"checkmark",width:"15",height:"15"}),Aa=Object(ea.a)(m.a).withConfig({displayName:"AuthorClaimModerationDetails__GreenIcon",componentId:"sc-1hreb8p-0"})(["fill:green;"]);var Ia=r(424),Fa=r.n(Ia),ka=r(425),Da=r.n(ka),La=r(426),Ma=r.n(La),qa=r(427),Ha=r.n(qa),za=r(412),Ua=r.n(za),Ba=r(384),Va=r.n(Ba),Ya=r(484);function Wa(){return(Wa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Ka(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function Qa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Ga="object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()};function Xa(e){cancelAnimationFrame(e.id)}function Ja(e,t){var r=Ga();var a={id:requestAnimationFrame((function n(){Ga()-r>=t?e.call(null):a.id=requestAnimationFrame(n)}))};return a}var Za=-1;var $a=null;function en(e){if(void 0===e&&(e=!1),null===$a||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",r.direction="rtl";var a=document.createElement("div"),n=a.style;return n.width="100px",n.height="100px",t.appendChild(a),document.body.appendChild(t),t.scrollLeft>0?$a="positive-descending":(t.scrollLeft=1,$a=0===t.scrollLeft?"negative":"positive-ascending"),document.body.removeChild(t),$a}return $a}var tn=function(e){var t=e.columnIndex;e.data;return e.rowIndex+":"+t};function rn(e){var t,r,n=e.getColumnOffset,o=e.getColumnStartIndexForOffset,i=e.getColumnStopIndexForStartIndex,s=e.getColumnWidth,l=e.getEstimatedTotalHeight,c=e.getEstimatedTotalWidth,u=e.getOffsetForColumnAndAlignment,d=e.getOffsetForRowAndAlignment,h=e.getRowHeight,p=e.getRowOffset,m=e.getRowStartIndexForOffset,b=e.getRowStopIndexForStartIndex,g=e.initInstanceProps,f=e.shouldResetStyleCacheOnItemSizeChange,_=e.validateProps;return r=t=function(e){function t(t){var r;return(r=e.call(this,t)||this)._instanceProps=g(r.props,Qa(Qa(r))),r._resetIsScrollingTimeoutId=null,r._outerRef=void 0,r.state={instance:Qa(Qa(r)),isScrolling:!1,horizontalScrollDirection:"forward",scrollLeft:"number"==typeof r.props.initialScrollLeft?r.props.initialScrollLeft:0,scrollTop:"number"==typeof r.props.initialScrollTop?r.props.initialScrollTop:0,scrollUpdateWasRequested:!1,verticalScrollDirection:"forward"},r._callOnItemsRendered=void 0,r._callOnItemsRendered=Object(Ya.a)((function(e,t,a,n,o,i,s,l){return r.props.onItemsRendered({overscanColumnStartIndex:e,overscanColumnStopIndex:t,overscanRowStartIndex:a,overscanRowStopIndex:n,visibleColumnStartIndex:o,visibleColumnStopIndex:i,visibleRowStartIndex:s,visibleRowStopIndex:l})})),r._callOnScroll=void 0,r._callOnScroll=Object(Ya.a)((function(e,t,a,n,o){return r.props.onScroll({horizontalScrollDirection:a,scrollLeft:e,scrollTop:t,verticalScrollDirection:n,scrollUpdateWasRequested:o})})),r._getItemStyle=void 0,r._getItemStyle=function(e,t){var a,o,i=r.props,l=i.columnWidth,c=i.direction,u=i.rowHeight,d=r._getItemStyleCache(f&&l,f&&c,f&&u),m=e+":"+t;d.hasOwnProperty(m)?a=d[m]:d[m]=((o={position:"absolute"})["rtl"===c?"right":"left"]=n(r.props,t,r._instanceProps),o.top=p(r.props,e,r._instanceProps),o.height=h(r.props,e,r._instanceProps),o.width=s(r.props,t,r._instanceProps),a=o);return a},r._getItemStyleCache=void 0,r._getItemStyleCache=Object(Ya.a)((function(e,t,r){return{}})),r._onScroll=function(e){var t=e.currentTarget,a=t.clientHeight,n=t.clientWidth,o=t.scrollLeft,i=t.scrollTop,s=t.scrollHeight,l=t.scrollWidth;r.setState((function(e){if(e.scrollLeft===o&&e.scrollTop===i)return null;var t=r.props.direction,c=o;if("rtl"===t)switch(en()){case"negative":c=-o;break;case"positive-descending":c=l-n-o}c=Math.max(0,Math.min(c,l-n));var u=Math.max(0,Math.min(i,s-a));return{isScrolling:!0,horizontalScrollDirection:e.scrollLeft<o?"forward":"backward",scrollLeft:c,scrollTop:u,verticalScrollDirection:e.scrollTop<i?"forward":"backward",scrollUpdateWasRequested:!1}}),r._resetIsScrollingDebounced)},r._outerRefSetter=function(e){var t=r.props.outerRef;r._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&t.hasOwnProperty("current")&&(t.current=e)},r._resetIsScrollingDebounced=function(){null!==r._resetIsScrollingTimeoutId&&Xa(r._resetIsScrollingTimeoutId),r._resetIsScrollingTimeoutId=Ja(r._resetIsScrolling,150)},r._resetIsScrolling=function(){r._resetIsScrollingTimeoutId=null,r.setState({isScrolling:!1},(function(){r._getItemStyleCache(-1)}))},r}Ka(t,e),t.getDerivedStateFromProps=function(e,t){return an(e,t),_(e),null};var r=t.prototype;return r.scrollTo=function(e){var t=e.scrollLeft,r=e.scrollTop;void 0!==t&&(t=Math.max(0,t)),void 0!==r&&(r=Math.max(0,r)),this.setState((function(e){return void 0===t&&(t=e.scrollLeft),void 0===r&&(r=e.scrollTop),e.scrollLeft===t&&e.scrollTop===r?null:{horizontalScrollDirection:e.scrollLeft<t?"forward":"backward",scrollLeft:t,scrollTop:r,scrollUpdateWasRequested:!0,verticalScrollDirection:e.scrollTop<r?"forward":"backward"}}),this._resetIsScrollingDebounced)},r.scrollToItem=function(e){var t=e.align,r=void 0===t?"auto":t,a=e.columnIndex,n=e.rowIndex,o=this.props,i=o.columnCount,s=o.height,h=o.rowCount,p=o.width,m=this.state,b=m.scrollLeft,g=m.scrollTop,f=function(e){if(void 0===e&&(e=!1),-1===Za||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",document.body.appendChild(t),Za=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return Za}();void 0!==a&&(a=Math.max(0,Math.min(a,i-1))),void 0!==n&&(n=Math.max(0,Math.min(n,h-1)));var _=l(this.props,this._instanceProps),y=c(this.props,this._instanceProps)>p?f:0,E=_>s?f:0;this.scrollTo({scrollLeft:void 0!==a?u(this.props,a,r,b,this._instanceProps,E):b,scrollTop:void 0!==n?d(this.props,n,r,g,this._instanceProps,y):g})},r.componentDidMount=function(){var e=this.props,t=e.initialScrollLeft,r=e.initialScrollTop;if(null!=this._outerRef){var a=this._outerRef;"number"==typeof t&&(a.scrollLeft=t),"number"==typeof r&&(a.scrollTop=r)}this._callPropsCallbacks()},r.componentDidUpdate=function(){var e=this.props.direction,t=this.state,r=t.scrollLeft,a=t.scrollTop;if(t.scrollUpdateWasRequested&&null!=this._outerRef){var n=this._outerRef;if("rtl"===e)switch(en()){case"negative":n.scrollLeft=-r;break;case"positive-ascending":n.scrollLeft=r;break;default:var o=n.clientWidth,i=n.scrollWidth;n.scrollLeft=i-o-r}else n.scrollLeft=Math.max(0,r);n.scrollTop=Math.max(0,a)}this._callPropsCallbacks()},r.componentWillUnmount=function(){null!==this._resetIsScrollingTimeoutId&&Xa(this._resetIsScrollingTimeoutId)},r.render=function(){var e=this.props,t=e.children,r=e.className,n=e.columnCount,o=e.direction,i=e.height,s=e.innerRef,u=e.innerElementType,d=e.innerTagName,h=e.itemData,p=e.itemKey,m=void 0===p?tn:p,b=e.outerElementType,g=e.outerTagName,f=e.rowCount,_=e.style,y=e.useIsScrolling,E=e.width,O=this.state.isScrolling,S=this._getHorizontalRangeToRender(),v=S[0],C=S[1],w=this._getVerticalRangeToRender(),P=w[0],x=w[1],R=[];if(n>0&&f)for(var N=P;N<=x;N++)for(var j=v;j<=C;j++)R.push(Object(a.createElement)(t,{columnIndex:j,data:h,isScrolling:y?O:void 0,key:m({columnIndex:j,data:h,rowIndex:N}),rowIndex:N,style:this._getItemStyle(N,j)}));var T=l(this.props,this._instanceProps),A=c(this.props,this._instanceProps);return Object(a.createElement)(b||g||"div",{className:r,onScroll:this._onScroll,ref:this._outerRefSetter,style:Wa({position:"relative",height:i,width:E,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:o},_)},Object(a.createElement)(u||d||"div",{children:R,ref:s,style:{height:T,pointerEvents:O?"none":void 0,width:A}}))},r._callPropsCallbacks=function(){var e=this.props,t=e.columnCount,r=e.onItemsRendered,a=e.onScroll,n=e.rowCount;if("function"==typeof r&&t>0&&n>0){var o=this._getHorizontalRangeToRender(),i=o[0],s=o[1],l=o[2],c=o[3],u=this._getVerticalRangeToRender(),d=u[0],h=u[1],p=u[2],m=u[3];this._callOnItemsRendered(i,s,d,h,l,c,p,m)}if("function"==typeof a){var b=this.state,g=b.horizontalScrollDirection,f=b.scrollLeft,_=b.scrollTop,y=b.scrollUpdateWasRequested,E=b.verticalScrollDirection;this._callOnScroll(f,_,g,E,y)}},r._getHorizontalRangeToRender=function(){var e=this.props,t=e.columnCount,r=e.overscanColumnCount,a=e.overscanColumnsCount,n=e.overscanCount,s=e.rowCount,l=this.state,c=l.horizontalScrollDirection,u=l.isScrolling,d=l.scrollLeft,h=r||a||n||1;if(0===t||0===s)return[0,0,0,0];var p=o(this.props,d,this._instanceProps),m=i(this.props,p,d,this._instanceProps),b=u&&"backward"!==c?1:Math.max(1,h),g=u&&"forward"!==c?1:Math.max(1,h);return[Math.max(0,p-b),Math.max(0,Math.min(t-1,m+g)),p,m]},r._getVerticalRangeToRender=function(){var e=this.props,t=e.columnCount,r=e.overscanCount,a=e.overscanRowCount,n=e.overscanRowsCount,o=e.rowCount,i=this.state,s=i.isScrolling,l=i.verticalScrollDirection,c=i.scrollTop,u=a||n||r||1;if(0===t||0===o)return[0,0,0,0];var d=m(this.props,c,this._instanceProps),h=b(this.props,d,c,this._instanceProps),p=s&&"backward"!==l?1:Math.max(1,u),g=s&&"forward"!==l?1:Math.max(1,u);return[Math.max(0,d-p),Math.max(0,Math.min(o-1,h+g)),d,h]},t}(a.PureComponent),t.defaultProps={direction:"ltr",itemData:void 0,useIsScrolling:!1},r}var an=function(e,t){e.children,e.direction,e.height,e.innerTagName,e.outerTagName,e.overscanColumnsCount,e.overscanCount,e.overscanRowsCount,e.width,t.instance};var nn=rn({getColumnOffset:function(e,t){return t*e.columnWidth},getColumnWidth:function(e,t){return e.columnWidth},getRowOffset:function(e,t){return t*e.rowHeight},getRowHeight:function(e,t){return e.rowHeight},getEstimatedTotalHeight:function(e){var t=e.rowCount;return e.rowHeight*t},getEstimatedTotalWidth:function(e){var t=e.columnCount;return e.columnWidth*t},getOffsetForColumnAndAlignment:function(e,t,r,a,n,o){var i=e.columnCount,s=e.columnWidth,l=e.width,c=Math.max(0,i*s-l),u=Math.min(c,t*s),d=Math.max(0,t*s-l+o+s);switch("smart"===r&&(r=a>=d-l&&a<=u+l?"auto":"center"),r){case"start":return u;case"end":return d;case"center":var h=Math.round(d+(u-d)/2);return h<Math.ceil(l/2)?0:h>c+Math.floor(l/2)?c:h;case"auto":default:return a>=d&&a<=u?a:d>u?d:a<d?d:u}},getOffsetForRowAndAlignment:function(e,t,r,a,n,o){var i=e.rowHeight,s=e.height,l=e.rowCount,c=Math.max(0,l*i-s),u=Math.min(c,t*i),d=Math.max(0,t*i-s+o+i);switch("smart"===r&&(r=a>=d-s&&a<=u+s?"auto":"center"),r){case"start":return u;case"end":return d;case"center":var h=Math.round(d+(u-d)/2);return h<Math.ceil(s/2)?0:h>c+Math.floor(s/2)?c:h;case"auto":default:return a>=d&&a<=u?a:d>u?d:a<d?d:u}},getColumnStartIndexForOffset:function(e,t){var r=e.columnWidth,a=e.columnCount;return Math.max(0,Math.min(a-1,Math.floor(t/r)))},getColumnStopIndexForStartIndex:function(e,t,r){var a=e.columnWidth,n=e.columnCount,o=e.width,i=t*a,s=Math.ceil((o+r-i)/a);return Math.max(0,Math.min(n-1,t+s-1))},getRowStartIndexForOffset:function(e,t){var r=e.rowHeight,a=e.rowCount;return Math.max(0,Math.min(a-1,Math.floor(t/r)))},getRowStopIndexForStartIndex:function(e,t,r){var a=e.rowHeight,n=e.rowCount,o=e.height,i=t*a,s=Math.ceil((o+r-i)/a);return Math.max(0,Math.min(n-1,t+s-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.columnWidth,e.rowHeight}});var on=function(e){function t(t){var r;return(r=e.call(this,t)||this).renderHeaderRow=r.renderHeaderRow.bind(Ha()(r)),r.renderFrozenRow=r.renderFrozenRow.bind(Ha()(r)),r._setRef=r._setRef.bind(Ha()(r)),r}Ua()(t,e);var r=t.prototype;return r.scrollTo=function(e){this.headerRef&&(this.headerRef.scrollLeft=e)},r.renderHeaderRow=function(e,t){var r=this.props,a=r.columns,n=r.headerRenderer;return e<=0?null:n({style:{width:"100%",height:e},columns:a,headerIndex:t})},r.renderFrozenRow=function(e,t){var r=this.props,a=r.columns,n=r.rowHeight;return(0,r.rowRenderer)({style:{width:"100%",height:n},columns:a,rowData:e,rowIndex:-t-1})},r.render=function(){var e=this.props,t=e.className,r=e.width,a=e.height,o=e.rowWidth,i=e.headerHeight,s=e.frozenData;if(a<=0)return null;var l={width:r,height:a,position:"relative",overflow:"hidden"},c={width:o,height:a},u=Array.isArray(i)?i:[i];return n.a.createElement("div",{role:"grid",ref:this._setRef,className:t,style:l},n.a.createElement("div",{role:"rowgroup",style:c},u.map(this.renderHeaderRow),s.map(this.renderFrozenRow)))},r._setRef=function(e){this.headerRef=e},t}(n.a.PureComponent);on.propTypes={className:Va.a.string,width:Va.a.number.isRequired,height:Va.a.number.isRequired,headerHeight:Va.a.oneOfType([Va.a.number,Va.a.arrayOf(Va.a.number)]).isRequired,rowWidth:Va.a.number.isRequired,rowHeight:Va.a.number.isRequired,columns:Va.a.arrayOf(Va.a.object).isRequired,data:Va.a.arrayOf(Va.a.object).isRequired,frozenData:Va.a.arrayOf(Va.a.object),headerRenderer:Va.a.func.isRequired,rowRenderer:Va.a.func.isRequired};var sn=on,ln=function(e){function t(t){var r;return(r=e.call(this,t)||this)._setHeaderRef=r._setHeaderRef.bind(Ha()(r)),r._setBodyRef=r._setBodyRef.bind(Ha()(r)),r._itemKey=r._itemKey.bind(Ha()(r)),r._handleItemsRendered=r._handleItemsRendered.bind(Ha()(r)),r.renderRow=r.renderRow.bind(Ha()(r)),r}Ua()(t,e);var r=t.prototype;return r.forceUpdateTable=function(){this.headerRef&&this.headerRef.forceUpdate(),this.bodyRef&&this.bodyRef.forceUpdate()},r.scrollToPosition=function(e){this.headerRef&&this.headerRef.scrollTo(e.scrollLeft),this.bodyRef&&this.bodyRef.scrollTo(e)},r.scrollToTop=function(e){this.bodyRef&&this.bodyRef.scrollTo({scrollTop:e})},r.scrollToLeft=function(e){this.headerRef&&this.headerRef.scrollTo(e),this.bodyRef&&this.bodyRef.scrollToPosition({scrollLeft:e})},r.scrollToRow=function(e,t){void 0===e&&(e=0),void 0===t&&(t="auto"),this.bodyRef&&this.bodyRef.scrollToItem({rowIndex:e,columnIndex:0,align:t})},r.renderRow=function(e){var t=this.props,r=t.data,a=t.columns,n=t.rowRenderer,o=r[e.rowIndex];return n(Da()({},e,{columns:a,rowData:o}))},r.render=function(){var e=this.props,t=e.containerStyle,r=e.classPrefix,a=e.className,o=e.data,i=e.frozenData,s=e.width,l=e.height,c=e.rowHeight,u=e.headerWidth,d=e.bodyWidth,h=e.useIsScrolling,p=e.onScroll,m=e.hoveredRowKey,b=e.overscanRowCount,g=(e.style,e.onScrollbarPresenceChange,Fa()(e,["containerStyle","classPrefix","className","data","frozenData","width","height","rowHeight","headerWidth","bodyWidth","useIsScrolling","onScroll","hoveredRowKey","overscanRowCount","style","onScrollbarPresenceChange"])),f=this._getHeaderHeight(),_=i.length,y=c*_,E=D()(r+"__table",a),O=t?{style:t}:null;return n.a.createElement("div",Ma()({role:"table",className:E},O),n.a.createElement(nn,Ma()({},g,{className:r+"__body",ref:this._setBodyRef,data:o,itemKey:this._itemKey,frozenData:i,width:s,height:Math.max(l-f-y,0),rowHeight:c,rowCount:o.length,overscanRowCount:b,columnWidth:d,columnCount:1,overscanColumnCount:0,useIsScrolling:h,hoveredRowKey:m,onScroll:p,onItemsRendered:this._handleItemsRendered,children:this.renderRow})),f+y>0&&n.a.createElement(sn,Ma()({},g,{className:r+"__header",ref:this._setHeaderRef,data:o,frozenData:i,width:s,height:Math.min(f+y,l),rowWidth:u,rowHeight:c,headerHeight:this.props.headerHeight,headerRenderer:this.props.headerRenderer,rowRenderer:this.props.rowRenderer,hoveredRowKey:_>0?m:null})))},r._setHeaderRef=function(e){this.headerRef=e},r._setBodyRef=function(e){this.bodyRef=e},r._itemKey=function(e){var t=e.rowIndex,r=this.props,a=r.data,n=r.rowKey;return a[t][n]},r._getHeaderHeight=function(){var e=this.props.headerHeight;return Array.isArray(e)?e.reduce((function(e,t){return e+t}),0):e},r._handleItemsRendered=function(e){var t=e.overscanRowStartIndex,r=e.overscanRowStopIndex,a=e.visibleRowStartIndex,n=e.visibleRowStopIndex;this.props.onRowsRendered({overscanStartIndex:t,overscanStopIndex:r,startIndex:a,stopIndex:n})},t}(n.a.PureComponent);ln.propTypes={containerStyle:Va.a.object,classPrefix:Va.a.string,className:Va.a.string,width:Va.a.number.isRequired,height:Va.a.number.isRequired,headerHeight:Va.a.oneOfType([Va.a.number,Va.a.arrayOf(Va.a.number)]).isRequired,headerWidth:Va.a.number.isRequired,bodyWidth:Va.a.number.isRequired,rowHeight:Va.a.number.isRequired,columns:Va.a.arrayOf(Va.a.object).isRequired,data:Va.a.arrayOf(Va.a.object).isRequired,rowKey:Va.a.oneOfType([Va.a.string,Va.a.number]).isRequired,frozenData:Va.a.arrayOf(Va.a.object),useIsScrolling:Va.a.bool,overscanRowCount:Va.a.number,hoveredRowKey:Va.a.oneOfType([Va.a.string,Va.a.number]),style:Va.a.object,onScrollbarPresenceChange:Va.a.func,onScroll:Va.a.func,onRowsRendered:Va.a.func,headerRenderer:Va.a.func.isRequired,rowRenderer:Va.a.func.isRequired};var cn,un=ln;function dn(e,t){return n.a.isValidElement(e)?n.a.cloneElement(e,t):"function"==typeof e?e.prototype&&e.prototype.isReactComponent?n.a.createElement(e,t):e.defaultProps?e(Da()({},e.defaultProps,t)):e(t):null}function hn(e){var t=[];return n.a.Children.forEach(e,(function(e){if(n.a.isValidElement(e)&&e.key){var r=Da()({},e.props,{key:e.key});t.push(r)}})),t}function pn(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return"function"==typeof e?e.apply(void 0,r):e}function mn(e){return Array.isArray(e)?[].concat(e):[]}function bn(){}var gn=function(e){var t=e.className,r=e.style,a=e.columns,o=e.headerIndex,i=e.cellRenderer,s=e.headerRenderer,l=e.expandColumnKey,c=e.expandIcon,u=e.tagName,d=Fa()(e,["className","style","columns","headerIndex","cellRenderer","headerRenderer","expandColumnKey","expandIcon","tagName"]),h=a.map((function(e,t){return i({columns:a,column:e,columnIndex:t,headerIndex:o,expandIcon:e.key===l&&n.a.createElement(c,null)})}));return s&&(h=dn(s,{cells:h,columns:a,headerIndex:o})),n.a.createElement(u,Ma()({},d,{className:t,style:r}),h)};gn.defaultProps={tagName:"div"},gn.propTypes={isScrolling:Va.a.bool,className:Va.a.string,style:Va.a.object,columns:Va.a.arrayOf(Va.a.object).isRequired,headerIndex:Va.a.number,cellRenderer:Va.a.func,headerRenderer:Va.a.oneOfType([Va.a.func,Va.a.element]),expandColumnKey:Va.a.string,expandIcon:Va.a.func,tagName:Va.a.elementType};var fn=gn,_n=function(e){function t(t){var r;return(r=e.call(this,t)||this)._handleExpand=r._handleExpand.bind(Ha()(r)),r}Ua()(t,e);var r=t.prototype;return r.render=function(){var e=this.props,t=e.isScrolling,r=e.className,a=e.style,o=e.columns,i=e.rowIndex,s=e.rowData,l=e.expandColumnKey,c=e.depth,u=e.rowEventHandlers,d=e.rowRenderer,h=e.cellRenderer,p=e.expandIconRenderer,m=e.tagName,b=(e.rowKey,e.onRowHover,e.onRowExpand,Fa()(e,["isScrolling","className","style","columns","rowIndex","rowData","expandColumnKey","depth","rowEventHandlers","rowRenderer","cellRenderer","expandIconRenderer","tagName","rowKey","onRowHover","onRowExpand"])),g=p({rowData:s,rowIndex:i,depth:c,onExpand:this._handleExpand}),f=o.map((function(e,r){return h({isScrolling:t,columns:o,column:e,columnIndex:r,rowData:s,rowIndex:i,expandIcon:e.key===l&&g})}));d&&(f=dn(d,{isScrolling:t,cells:f,columns:o,rowData:s,rowIndex:i,depth:c}));var _=this._getEventHandlers(u);return n.a.createElement(m,Ma()({},b,{className:r,style:a},_),f)},r._handleExpand=function(e){var t=this.props,r=t.onRowExpand,a=t.rowData,n=t.rowIndex,o=t.rowKey;r&&r({expanded:e,rowData:a,rowIndex:n,rowKey:o})},r._getEventHandlers=function(e){void 0===e&&(e={});var t=this.props,r=t.rowData,a=t.rowIndex,n=t.rowKey,o=t.onRowHover,i={};if(Object.keys(e).forEach((function(t){var o=e[t];"function"==typeof o&&(i[t]=function(e){o({rowData:r,rowIndex:a,rowKey:n,event:e})})})),o){var s=i.onMouseEnter;i.onMouseEnter=function(e){o({hovered:!0,rowData:r,rowIndex:a,rowKey:n,event:e}),s&&s(e)};var l=i.onMouseLeave;i.onMouseLeave=function(e){o({hovered:!1,rowData:r,rowIndex:a,rowKey:n,event:e}),l&&l(e)}}return i},t}(n.a.PureComponent);_n.defaultProps={tagName:"div"},_n.propTypes={isScrolling:Va.a.bool,className:Va.a.string,style:Va.a.object,columns:Va.a.arrayOf(Va.a.object).isRequired,rowData:Va.a.object.isRequired,rowIndex:Va.a.number.isRequired,rowKey:Va.a.oneOfType([Va.a.string,Va.a.number]),expandColumnKey:Va.a.string,depth:Va.a.number,rowEventHandlers:Va.a.object,rowRenderer:Va.a.oneOfType([Va.a.func,Va.a.element]),cellRenderer:Va.a.func,expandIconRenderer:Va.a.func,onRowHover:Va.a.func,onRowExpand:Va.a.func,tagName:Va.a.elementType};var yn=_n,En=function(e){var t=e.className,r=e.column;e.columnIndex;return n.a.createElement("div",{className:t},r.title)};En.propTypes={className:Va.a.string,column:Va.a.object,columnIndex:Va.a.number};var On=En,Sn=function(e){var t=e.className,r=e.cellData;e.column,e.columnIndex,e.rowData,e.rowIndex;return n.a.createElement("div",{className:t},n.a.isValidElement(r)?r:function(e){return"string"==typeof e?e:null==e?"":e.toString?e.toString():""}(r))};Sn.propTypes={className:Va.a.string,cellData:Va.a.any,column:Va.a.object,columnIndex:Va.a.number,rowData:Va.a.object,rowIndex:Va.a.number};var vn=Sn,Cn={LEFT:"left",CENTER:"center",RIGHT:"right"},wn={LEFT:"left",RIGHT:"right",DEFAULT:!0,NONE:!1},Pn=function(e){function t(){return e.apply(this,arguments)||this}return Ua()(t,e),t}(n.a.Component);Pn.propTypes={className:Va.a.oneOfType([Va.a.string,Va.a.func]),headerClassName:Va.a.oneOfType([Va.a.string,Va.a.func]),style:Va.a.object,title:Va.a.string,dataKey:Va.a.string,dataGetter:Va.a.func,align:Va.a.oneOf(["left","center","right"]),flexGrow:Va.a.number,flexShrink:Va.a.number,width:Va.a.number.isRequired,maxWidth:Va.a.number,minWidth:Va.a.number,frozen:Va.a.oneOf(["left","right",!0,!1]),hidden:Va.a.bool,resizable:Va.a.bool,sortable:Va.a.bool,cellRenderer:Va.a.oneOfType([Va.a.func,Va.a.element]),headerRenderer:Va.a.oneOfType([Va.a.func,Va.a.element])},Pn.Alignment=Cn,Pn.FrozenDirection=wn;var xn=Pn,Rn={ASC:"asc",DESC:"desc"},Nn=function(e){function t(t){var r;return(r=e.call(this,t)||this)._handleClick=r._handleClick.bind(Ha()(r)),r}Ua()(t,e);var r=t.prototype;return r.render=function(){var e=this.props,t=e.expandable,r=e.expanded,a=e.indentSize,o=e.depth,i=e.onExpand,s=Fa()(e,["expandable","expanded","indentSize","depth","onExpand"]);if(!t&&0===a)return null;var l=D()("BaseTable__expand-icon",{"BaseTable__expand-icon--expanded":r});return n.a.createElement("div",Ma()({},s,{className:l,onClick:t&&i?this._handleClick:null,style:{fontFamily:"initial",cursor:"pointer",userSelect:"none",width:"16px",minWidth:"16px",height:"16px",lineHeight:"16px",fontSize:"16px",textAlign:"center",transition:"transform 0.15s ease-out",transform:"rotate("+(t&&r?90:0)+"deg)",marginLeft:o*a}}),t&&"")},r._handleClick=function(e){e.stopPropagation(),e.preventDefault();var t=this.props;(0,t.onExpand)(!t.expanded)},t}(n.a.PureComponent);Nn.defaultProps={depth:0,indentSize:16},Nn.propTypes={expandable:Va.a.bool,expanded:Va.a.bool,indentSize:Va.a.number,depth:Va.a.number,onExpand:Va.a.func};var jn=Nn,Tn=function(e){var t=e.sortOrder,r=e.className,a=e.style,o=D()("BaseTable__sort-indicator",r,{"BaseTable__sort-indicator--descending":t===Rn.DESC});return n.a.createElement("div",{className:o,style:Da()({userSelect:"none",width:"16px",height:"16px",lineHeight:"16px",textAlign:"center"},a)},t===Rn.DESC?"":"")};Tn.propTypes={sortOrder:Va.a.oneOf([Rn.ASC,Rn.DESC]),className:Va.a.string,style:Va.a.object};var An=Tn;function In(e){if(e){var t,r,a=e.getElementById("react-draggable-style-el");a||((a=e.createElement("style")).type="text/css",a.id="react-draggable-style-el",a.innerHTML=".react-draggable-transparent-selection *::-moz-selection {background: transparent;}\n",a.innerHTML+=".react-draggable-transparent-selection *::selection {background: transparent;}\n",e.getElementsByTagName("head")[0].appendChild(a)),e.body&&(t=e.body,r="react-draggable-transparent-selection",t.classList?t.classList.add(r):t.className.match(new RegExp("(?:^|\\s)"+r+"(?!\\S)"))||(t.className+=" "+r))}}function Fn(e){try{e&&e.body&&(t=e.body,r="react-draggable-transparent-selection",t.classList?t.classList.remove(r):t.className=t.className.replace(new RegExp("(?:^|\\s)"+r+"(?!\\S)","g"),"")),e.selection?e.selection.empty():window.getSelection().removeAllRanges()}catch(e){}var t,r}var kn=function(e){function t(t){var r;return(r=e.call(this,t)||this).isDragging=!1,r.lastX=null,r.width=0,r._setHandleRef=r._setHandleRef.bind(Ha()(r)),r._handleClick=r._handleClick.bind(Ha()(r)),r._handleMouseDown=r._handleMouseDown.bind(Ha()(r)),r._handleMouseUp=r._handleMouseUp.bind(Ha()(r)),r._handleMouseMove=r._handleMouseMove.bind(Ha()(r)),r}Ua()(t,e);var r=t.prototype;return r.componentWillMount=function(){if(this.handleRef){var e=this.handleRef.ownerDocument;e.removeEventListener("mousemove",this._handleMouseMove),e.addEventListener("mouseup",this._handleMouseUp),Fn(e)}},r.render=function(){var e=this.props,t=e.style,r=(e.column,e.onResizeStart,e.onResize,e.onResizeStop,e.minWidth,Fa()(e,["style","column","onResizeStart","onResize","onResizeStop","minWidth"]));return n.a.createElement("div",Ma()({},r,{ref:this._setHandleRef,onClick:this._handleClick,onMouseDown:this._handleMouseDown,onMouseUp:this._handleMouseUp,style:Da()({userSelect:"none",touchAction:"none",position:"absolute",top:0,bottom:0,right:0,cursor:"col-resize"},t)}))},r._setHandleRef=function(e){this.handleRef=e},r._handleClick=function(e){e.stopPropagation()},r._handleMouseDown=function(e){if("number"!=typeof e.button||0===e.button){this.isDragging=!0,this.lastX=null,this.width=this.props.column.width,this.props.onResizeStart(this.props.column);var t=this.handleRef.ownerDocument;In(t),t.addEventListener("mousemove",this._handleMouseMove),t.addEventListener("mouseup",this._handleMouseUp)}},r._handleMouseUp=function(e){if(this.isDragging){this.isDragging=!1,this.props.onResizeStop(this.props.column);var t=this.handleRef.ownerDocument;Fn(t),t.removeEventListener("mousemove",this._handleMouseMove),t.addEventListener("mouseup",this._handleMouseUp)}},r._handleMouseMove=function(e){var t=this.handleRef.offsetParent,r=t.getBoundingClientRect(),a=e.clientX+t.scrollLeft-r.left;if(null!==this.lastX){var n=this.props,o=n.column,i=n.minWidth,s=o.width,l=o.maxWidth,c=o.minWidth,u=void 0===c?i:c,d=a-this.lastX;if(d){this.width=this.width+d,this.lastX=a;var h=this.width;l&&h>l?h=l:h<u&&(h=u),h!==s&&this.props.onResize(o,h)}}else this.lastX=a},t}(n.a.PureComponent);kn.defaultProps={onResizeStart:bn,onResize:bn,onResizeStop:bn,minWidth:30},kn.propTypes={style:Va.a.object,column:Va.a.object,onResizeStart:Va.a.func,onResize:Va.a.func,onResizeStop:Va.a.func,minWidth:Va.a.number};var Dn=kn,Ln=function(){function e(e,t){this._origColumns=[],this.reset(e,t)}var t=e.prototype;return t._cache=function(e,t){return e in this._cached?this._cached[e]:(this._cached[e]=t(),this._cached[e])},t.reset=function(e,t){var r=this;this._columns=e.map((function(e){var t=e.width;if(e.resizable){var a=r._origColumns.findIndex((function(t){return t.key===e.key}));a>=0&&r._origColumns[a].width===e.width&&(t=r._columns[a].width)}return Da()({},e,{width:t})})),this._origColumns=e,this._fixed=t,this._cached={},this._columnStyles=this.recomputeColumnStyles()},t.resetCache=function(){this._cached={}},t.getOriginalColumns=function(){return this._origColumns},t.getColumns=function(){return this._columns},t.getVisibleColumns=function(){var e=this;return this._cache("visibleColumns",(function(){return e._columns.filter((function(e){return!e.hidden}))}))},t.hasFrozenColumns=function(){var e=this;return this._cache("hasFrozenColumns",(function(){return e._fixed&&e.getVisibleColumns().some((function(e){return!!e.frozen}))}))},t.hasLeftFrozenColumns=function(){var e=this;return this._cache("hasLeftFrozenColumns",(function(){return e._fixed&&e.getVisibleColumns().some((function(e){return e.frozen===wn.LEFT||!0===e.frozen}))}))},t.hasRightFrozenColumns=function(){var e=this;return this._cache("hasRightFrozenColumns",(function(){return e._fixed&&e.getVisibleColumns().some((function(e){return e.frozen===wn.RIGHT}))}))},t.getMainColumns=function(){var t=this;return this._cache("mainColumns",(function(){var r=t.getVisibleColumns();if(!t.hasFrozenColumns())return r;var a=[];return t.getLeftFrozenColumns().forEach((function(t){var r;a.push(Da()({},t,((r={})[e.PlaceholderKey]=!0,r)))})),t.getVisibleColumns().forEach((function(e){e.frozen||a.push(e)})),t.getRightFrozenColumns().forEach((function(t){var r;a.push(Da()({},t,((r={})[e.PlaceholderKey]=!0,r)))})),a}))},t.getLeftFrozenColumns=function(){var e=this;return this._cache("leftFrozenColumns",(function(){return e._fixed?e.getVisibleColumns().filter((function(e){return e.frozen===wn.LEFT||!0===e.frozen})):[]}))},t.getRightFrozenColumns=function(){var e=this;return this._cache("rightFrozenColumns",(function(){return e._fixed?e.getVisibleColumns().filter((function(e){return e.frozen===wn.RIGHT})):[]}))},t.getColumn=function(e){var t=this._columns.findIndex((function(t){return t.key===e}));return this._columns[t]},t.getColumnsWidth=function(){var e=this;return this._cache("columnsWidth",(function(){return e.recomputeColumnsWidth(e.getVisibleColumns())}))},t.getLeftFrozenColumnsWidth=function(){var e=this;return this._cache("leftFrozenColumnsWidth",(function(){return e.recomputeColumnsWidth(e.getLeftFrozenColumns())}))},t.getRightFrozenColumnsWidth=function(){var e=this;return this._cache("rightFrozenColumnsWidth",(function(){return e.recomputeColumnsWidth(e.getRightFrozenColumns())}))},t.recomputeColumnsWidth=function(e){return e.reduce((function(e,t){return e+t.width}),0)},t.setColumnWidth=function(e,t){var r=this.getColumn(e);r.width=t,this._cached={},this._columnStyles[r.key]=this.recomputeColumnStyle(r)},t.getColumnStyle=function(e){return this._columnStyles[e]},t.getColumnStyles=function(){return this._columnStyles},t.recomputeColumnStyle=function(e){var t=0,r=0;this._fixed||(t="number"==typeof e.flexGrow?e.flexGrow:0,r="number"==typeof e.flexShrink?e.flexShrink:1);var a=t+" "+r+" auto",n=Da()({},e.style,{flex:a,msFlex:a,WebkitFlex:a,width:e.width,overflow:"hidden"});return!this._fixed&&e.maxWidth&&(n.maxWidth=e.maxWidth),!this._fixed&&e.minWidth&&(n.minWidth=e.minWidth),n},t.recomputeColumnStyles=function(){var e=this;return this._columns.reduce((function(t,r){return t[r.key]=e.recomputeColumnStyle(r),t}),{})},e}();Ln.PlaceholderKey="__placeholder__";var Mn=function(e,t,r){return{width:e,maxWidth:t,height:r,overflow:"hidden"}},qn={TableCell:vn,TableHeaderCell:On,ExpandIcon:jn,SortIndicator:An},Hn=function(e){function t(t){var r;r=e.call(this,t)||this;var a,n,o,i,s,l=t.columns,c=t.children,u=t.expandedRowKeys,d=t.defaultExpandedRowKeys;return r.state={scrollbarSize:0,hoveredRowKey:null,resizingKey:null,resizingWidth:0,expandedRowKeys:mn(void 0!==t.expandedRowKeys?u:d)},r.columnManager=new Ln(l||hn(c),t.fixed),r._setContainerRef=r._setContainerRef.bind(Ha()(r)),r._setMainTableRef=r._setMainTableRef.bind(Ha()(r)),r._setLeftTableRef=r._setLeftTableRef.bind(Ha()(r)),r._setRightTableRef=r._setRightTableRef.bind(Ha()(r)),r.renderExpandIcon=r.renderExpandIcon.bind(Ha()(r)),r.renderRow=r.renderRow.bind(Ha()(r)),r.renderRowCell=r.renderRowCell.bind(Ha()(r)),r.renderHeader=r.renderHeader.bind(Ha()(r)),r.renderHeaderCell=r.renderHeaderCell.bind(Ha()(r)),r._handleScroll=r._handleScroll.bind(Ha()(r)),r._handleVerticalScroll=r._handleVerticalScroll.bind(Ha()(r)),r._handleRowsRendered=r._handleRowsRendered.bind(Ha()(r)),r._handleRowHover=r._handleRowHover.bind(Ha()(r)),r._handleRowExpand=r._handleRowExpand.bind(Ha()(r)),r._handleColumnResize=(a=r._handleColumnResize.bind(Ha()(r)),n=50,function(){var e=this,t=arguments;o?(clearTimeout(i),i=setTimeout((function(){Date.now()-s>=n&&(a.apply(e,t),s=Date.now())}),Math.max(n-(Date.now()-s),0))):(a.apply(e,t),s=Date.now(),o=!0)}),r._handleColumnResizeStart=r._handleColumnResizeStart.bind(Ha()(r)),r._handleColumnResizeStop=r._handleColumnResizeStop.bind(Ha()(r)),r._handleColumnSort=r._handleColumnSort.bind(Ha()(r)),r._getLeftTableContainerStyle=Object(Ya.a)(Mn),r._getRightTableContainerStyle=Object(Ya.a)(Mn),r._flattenOnKeys=Object(Ya.a)((function(e,t,a){return r._depthMap={},function(e,t,r,a){if(void 0===r&&(r={}),void 0===a&&(a="id"),!t||!t.length)return e;var n=[],o=new Set;t.forEach((function(e){return o.add(e)}));var i=[].concat(e);i.forEach((function(e){return r[e[a]]=0}));for(var s=function(){var e=i.shift();n.push(e),o.has(e[a])&&Array.isArray(e.children)&&e.children.length>0&&(i=[].concat(e.children,i),e.children.forEach((function(t){return r[t[a]]=r[e[a]]+1})))};i.length>0;)s();return n}(e,t,r._depthMap,a)})),r._scroll={scrollLeft:0,scrollTop:0},r._scrollHeight=0,r._lastScannedRowIndex=-1,r._hasDataChangedSinceEndReached=!0,r._data=t.data,r._depthMap={},r._horizontalScrollbarSize=0,r._verticalScrollbarSize=0,r._scrollbarPresenceChanged=!1,r}Ua()(t,e);var r=t.prototype;return r.getDOMNode=function(){return this.tableNode},r.getColumnManager=function(){return this.columnManager},r.getExpandedState=function(){return{expandedData:this._data,expandedRowKeys:this.state.expandedRowKeys,expandedDepthMap:this._depthMap}},r.getTotalRowsHeight=function(){return this._data.length*this.props.rowHeight},r.getTotalColumnsWidth=function(){return this.columnManager.getColumnsWidth()},r.forceUpdateTable=function(){this.table&&this.table.forceUpdateTable(),this.leftTable&&this.leftTable.forceUpdateTable(),this.rightTable&&this.rightTable.forceUpdateTable()},r.scrollToPosition=function(e){this._scroll=e,this.table&&this.table.scrollToPosition(e),this.leftTable&&this.leftTable.scrollToTop(e.scrollTop),this.rightTable&&this.rightTable.scrollToTop(e.scrollTop)},r.scrollToTop=function(e){this._scroll.scrollTop=e,this.table&&this.table.scrollToPosition(this._scroll),this.leftTable&&this.leftTable.scrollToTop(e),this.rightTable&&this.rightTable.scrollToTop(e)},r.scrollToLeft=function(e){this._scroll.scrollLeft=e,this.table&&this.table.scrollToPosition(this._scroll)},r.scrollToRow=function(e,t){void 0===e&&(e=0),void 0===t&&(t="auto"),this.table&&this.table.scrollToRow(e,t),this.leftTable&&this.leftTable.scrollToRow(e,t),this.rightTable&&this.rightTable.scrollToRow(e,t),this.scrollToLeft(0)},r.setExpandedRowKeys=function(e){void 0===this.props.expandedRowKeys&&this.setState({expandedRowKeys:mn(e)})},r.renderExpandIcon=function(e){var t=e.rowData,r=e.rowIndex,a=e.depth,o=e.onExpand,i=this.props,s=i.rowKey,l=i.expandColumnKey,c=i.expandIconProps;if(!l)return null;var u,d=r>=0&&(u=t,Array.isArray(u.children)&&u.children.length>0),h=r>=0&&this.state.expandedRowKeys.indexOf(t[s])>=0,p=pn(c,{rowData:t,rowIndex:r,depth:a,expandable:d,expanded:h}),m=this._getComponent("ExpandIcon");return n.a.createElement(m,Ma()({depth:a,expandable:d,expanded:h},p,{onExpand:o}))},r.renderRow=function(e){var t,r=e.isScrolling,a=e.columns,o=e.rowData,i=e.rowIndex,s=e.style,l=this.props,c=l.rowClassName,u=l.rowRenderer,d=l.rowEventHandlers,h=l.expandColumnKey,p=pn(c,{columns:a,rowData:o,rowIndex:i}),m=pn(this.props.rowProps,{columns:a,rowData:o,rowIndex:i}),b=o[this.props.rowKey],g=this._depthMap[b]||0,f=D()(this._prefixClass("row"),p,((t={})[this._prefixClass("row--depth-"+g)]=!!h&&i>=0,t[this._prefixClass("row--expanded")]=!!h&&this.state.expandedRowKeys.indexOf(b)>=0,t[this._prefixClass("row--hovered")]=!r&&b===this.state.hoveredRowKey,t[this._prefixClass("row--frozen")]=0===g&&i<0,t[this._prefixClass("row--customized")]=u,t)),_=Da()({},m,{role:"row",key:"row-"+b,isScrolling:r,className:f,style:s,columns:a,rowIndex:i,rowData:o,rowKey:b,expandColumnKey:h,depth:g,rowEventHandlers:d,rowRenderer:u,cellRenderer:this.renderRowCell,expandIconRenderer:this.renderExpandIcon,onRowExpand:this._handleRowExpand,onRowHover:this.columnManager.hasFrozenColumns()?this._handleRowHover:null});return n.a.createElement(yn,_)},r.renderRowCell=function(e){var t,r=e.isScrolling,a=e.columns,o=e.column,i=e.columnIndex,s=e.rowData,l=e.rowIndex,c=e.expandIcon;if(o[Ln.PlaceholderKey])return n.a.createElement("div",{key:"row-"+s[this.props.rowKey]+"-cell-"+o.key+"-placeholder",className:this._prefixClass("row-cell-placeholder"),style:this.columnManager.getColumnStyle(o.key)});var u=o.className,d=o.dataKey,h=o.dataGetter,p=o.cellRenderer,m=this._getComponent("TableCell"),b=h?h({columns:a,column:o,columnIndex:i,rowData:s,rowIndex:l}):function(e,t,r){if(null===e||"object"!=typeof e||"string"!=typeof t)return r;for(var a=function(e){for(var t=e.split("."),r=[],a=0;a<t.length;a++){for(var n=t[a];"\\"===n[n.length-1]&&void 0!==t[a+1];)n=n.slice(0,-1)+".",n+=t[++a];r.push(n)}return r}(t),n=0;n<a.length;n++){if(!Object.prototype.propertyIsEnumerable.call(e,a[n]))return r;if(null==(e=e[a[n]])){if(n!==a.length-1)return r;break}}return e}(s,d),g={isScrolling:r,cellData:b,columns:a,column:o,columnIndex:i,rowData:s,rowIndex:l,container:this},f=dn(p||n.a.createElement(m,{className:this._prefixClass("row-cell-text")}),g),_=pn(u,{cellData:b,columns:a,column:o,columnIndex:i,rowData:s,rowIndex:l}),y=D()(this._prefixClass("row-cell"),_,((t={})[this._prefixClass("row-cell--align-center")]=o.align===Cn.CENTER,t[this._prefixClass("row-cell--align-right")]=o.align===Cn.RIGHT,t)),E=pn(this.props.cellProps,{columns:a,column:o,columnIndex:i,rowData:s,rowIndex:l})||{},O=E.tagName,S=Fa()(E,["tagName"]),v=O||"div";return n.a.createElement(v,Ma()({role:"gridcell",key:"row-"+s[this.props.rowKey]+"-cell-"+o.key},S,{className:y,style:this.columnManager.getColumnStyle(o.key)}),c,f)},r.renderHeader=function(e){var t,r=e.columns,a=e.headerIndex,o=e.style,i=this.props,s=i.headerClassName,l=i.headerRenderer,c=pn(s,{columns:r,headerIndex:a}),u=pn(this.props.headerProps,{columns:r,headerIndex:a}),d=D()(this._prefixClass("header-row"),c,((t={})[this._prefixClass("header-row--resizing")]=!!this.state.resizingKey,t[this._prefixClass("header-row--customized")]=l,t)),h=Da()({},u,{role:"row",key:"header-"+a,className:d,style:o,columns:r,headerIndex:a,headerRenderer:l,cellRenderer:this.renderHeaderCell,expandColumnKey:this.props.expandColumnKey,expandIcon:this._getComponent("ExpandIcon")});return n.a.createElement(fn,h)},r.renderHeaderCell=function(e){var t,r,a=e.columns,o=e.column,i=e.columnIndex,s=e.headerIndex,l=e.expandIcon;if(o[Ln.PlaceholderKey])return n.a.createElement("div",{key:"header-"+s+"-cell-"+o.key+"-placeholder",className:this._prefixClass("header-cell-placeholder"),style:this.columnManager.getColumnStyle(o.key)});var c,u,d=o.headerClassName,h=o.headerRenderer,p=this.props,m=p.sortBy,b=p.sortState,g=p.headerCellProps,f=this._getComponent("TableHeaderCell"),_=this._getComponent("SortIndicator"),y={columns:a,column:o,columnIndex:i,headerIndex:s,container:this},E=dn(h||n.a.createElement(f,{className:this._prefixClass("header-cell-text")}),y);if(b){var O=b[o.key];u=(c=O===Rn.ASC||O===Rn.DESC)?O:Rn.ASC}else u=(c=o.key===m.key)?m.order:Rn.ASC;var S=pn(d,{columns:a,column:o,columnIndex:i,headerIndex:s}),v=D()(this._prefixClass("header-cell"),S,((t={})[this._prefixClass("header-cell--align-center")]=o.align===Cn.CENTER,t[this._prefixClass("header-cell--align-right")]=o.align===Cn.RIGHT,t[this._prefixClass("header-cell--sortable")]=o.sortable,t[this._prefixClass("header-cell--sorting")]=c,t[this._prefixClass("header-cell--resizing")]=o.key===this.state.resizingKey,t)),C=pn(g,{columns:a,column:o,columnIndex:i,headerIndex:s})||{},w=C.tagName,P=Fa()(C,["tagName"]),x=w||"div";return n.a.createElement(x,Ma()({role:"gridcell",key:"header-"+s+"-cell-"+o.key,onClick:o.sortable?this._handleColumnSort:null},P,{className:v,style:this.columnManager.getColumnStyle(o.key),"data-key":o.key}),l,E,o.sortable&&n.a.createElement(_,{sortOrder:u,className:D()(this._prefixClass("sort-indicator"),(r={},r[this._prefixClass("sort-indicator--descending")]=u===Rn.DESC,r))}),o.resizable&&n.a.createElement(Dn,{className:this._prefixClass("column-resizer"),column:o,onResizeStart:this._handleColumnResizeStart,onResizeStop:this._handleColumnResizeStop,onResize:this._handleColumnResize}))},r.renderMainTable=function(){var e=this.props,t=e.width,r=e.headerHeight,a=e.rowHeight,o=e.fixed,i=Fa()(e,["width","headerHeight","rowHeight","fixed"]),s=this._getTableHeight(),l=t-this._verticalScrollbarSize;if(o){var c=this.columnManager.getColumnsWidth();l=Math.max(Math.round(c),l)}return n.a.createElement(un,Ma()({},i,this.state,{className:this._prefixClass("table-main"),ref:this._setMainTableRef,data:this._data,columns:this.columnManager.getMainColumns(),width:t,height:s,headerHeight:r,rowHeight:a,headerWidth:l+(o?this._verticalScrollbarSize:0),bodyWidth:l,headerRenderer:this.renderHeader,rowRenderer:this.renderRow,onScroll:this._handleScroll,onRowsRendered:this._handleRowsRendered}))},r.renderLeftTable=function(){if(!this.columnManager.hasLeftFrozenColumns())return null;var e=this.props,t=e.width,r=e.headerHeight,a=e.rowHeight,o=Fa()(e,["width","headerHeight","rowHeight"]),i=this._getFrozenContainerHeight(),s=this._verticalScrollbarSize||20,l=this.columnManager.getLeftFrozenColumnsWidth();return n.a.createElement(un,Ma()({},o,this.state,{containerStyle:this._getLeftTableContainerStyle(l,t,i),className:this._prefixClass("table-frozen-left"),ref:this._setLeftTableRef,data:this._data,columns:this.columnManager.getLeftFrozenColumns(),width:l+s,height:i,headerHeight:r,rowHeight:a,headerWidth:l+s,bodyWidth:l+s,headerRenderer:this.renderHeader,rowRenderer:this.renderRow,onScroll:this._handleVerticalScroll,onRowsRendered:bn}))},r.renderRightTable=function(){if(!this.columnManager.hasRightFrozenColumns())return null;var e=this.props,t=e.width,r=e.headerHeight,a=e.rowHeight,o=Fa()(e,["width","headerHeight","rowHeight"]),i=this._getFrozenContainerHeight(),s=this.columnManager.getRightFrozenColumnsWidth(),l=this._verticalScrollbarSize;return n.a.createElement(un,Ma()({},o,this.state,{containerStyle:this._getLeftTableContainerStyle(s+l,t,i),className:this._prefixClass("table-frozen-right"),ref:this._setRightTableRef,data:this._data,columns:this.columnManager.getRightFrozenColumns(),width:s+l,height:i,headerHeight:r,rowHeight:a,headerWidth:s+l,bodyWidth:s,headerRenderer:this.renderHeader,rowRenderer:this.renderRow,onScroll:this._handleVerticalScroll,onRowsRendered:bn}))},r.renderResizingLine=function(){var e=this.props,t=e.width,r=e.fixed,a=this.state.resizingKey;if(!r||!a)return null;var o=this.columnManager.getMainColumns(),i=o.findIndex((function(e){return e.key===a})),s=o[i],l=s.width,c=s.frozen,u=this.columnManager.recomputeColumnsWidth(o.slice(0,i))+l;if(c){if(c===wn.RIGHT){var d=this.columnManager.recomputeColumnsWidth(o.slice(i+1));u=d+l>t-this._verticalScrollbarSize?l:t-this._verticalScrollbarSize-d}}else u-=this._scroll.scrollLeft;var h={left:u,height:this._getTableHeight()-this._horizontalScrollbarSize};return n.a.createElement("div",{className:this._prefixClass("resizing-line"),style:h})},r.renderFooter=function(){var e=this.props,t=e.footerHeight,r=e.footerRenderer;return 0===t?null:n.a.createElement("div",{className:this._prefixClass("footer"),style:{height:t}},dn(r))},r.renderEmptyLayer=function(){var e=this.props,t=e.data,r=e.footerHeight,a=e.emptyRenderer;if(t&&t.length)return null;var o=this._getHeaderHeight();return n.a.createElement("div",{className:this._prefixClass("empty-layer"),style:{top:o,bottom:r}},dn(a))},r.renderOverlay=function(){var e=this.props.overlayRenderer;return n.a.createElement("div",{className:this._prefixClass("overlay")},!!e&&dn(e))},r.render=function(){var e,t=this.props,r=t.classPrefix,a=t.width,o=t.fixed,i=t.data,s=t.frozenData,l=t.expandColumnKey,c=t.disabled,u=t.className,d=t.style,h=t.footerHeight;this._data=l?this._flattenOnKeys(i,this.state.expandedRowKeys,this.props.rowKey):i,this._calcScrollbarSizes();var p=Da()({},d,{width:a,height:this._getTableHeight()+h,position:"relative"}),m=D()(r,u,((e={})[r+"--fixed"]=o,e[r+"--expandable"]=!!l,e[r+"--empty"]=0===i.length,e[r+"--has-frozen-rows"]=s.length>0,e[r+"--has-frozen-columns"]=this.columnManager.hasFrozenColumns(),e[r+"--disabled"]=c,e));return n.a.createElement("div",{ref:this._setContainerRef,className:m,style:p},this.renderFooter(),this.renderMainTable(),this.renderLeftTable(),this.renderRightTable(),this.renderResizingLine(),this.renderEmptyLayer(),this.renderOverlay())},r.componentWillReceiveProps=function(e){var t=e.columns||hn(e.children);(function e(t,r){if(t===r)return!0;if(null===t&&null===r)return!0;if(null===t||null===r)return!1;if("object"!=typeof t||"object"!=typeof r)return!1;var a=Object.keys(t),n=Object.keys(r);if(a.length!==n.length)return!1;for(var o=0;o<a.length;o++){var i=a[o],s=t[i],l=r[i];if(typeof s!=typeof l)return!1;if("function"!=typeof s){if("object"==typeof s){if(e(s,l))continue;return!1}if(s!==l)return!1}}return!0})(t,this.columnManager.getOriginalColumns())&&e.fixed===this.props.fixed||this.columnManager.reset(t,e.fixed),e.data!==this.props.data&&(this._lastScannedRowIndex=-1,this._hasDataChangedSinceEndReached=!0),e.maxHeight===this.props.maxHeight&&e.height===this.props.height||this._maybeCallOnEndReached(),e.expandColumnKey&&void 0!==e.expandedRowKeys&&e.expandedRowKeys!==this.props.expandedRowKeys&&this.setState({expandedRowKeys:mn(e.expandedRowKeys)})},r.componentDidMount=function(){var e=this.props.getScrollbarSize();e>0&&this.setState({scrollbarSize:e})},r.componentDidUpdate=function(e,t){this._maybeScrollbarPresenceChange()},r._prefixClass=function(e){return this.props.classPrefix+"__"+e},r._setContainerRef=function(e){this.tableNode=e},r._setMainTableRef=function(e){this.table=e},r._setLeftTableRef=function(e){this.leftTable=e},r._setRightTableRef=function(e){this.rightTable=e},r._getComponent=function(e){return this.props.components&&this.props.components[e]?this.props.components[e]:qn[e]},r._getHeaderHeight=function(){var e=this.props.headerHeight;return Array.isArray(e)?e.reduce((function(e,t){return e+t}),0):e},r._getFrozenRowsHeight=function(){var e=this.props,t=e.frozenData,r=e.rowHeight;return t.length*r},r._getTableHeight=function(){var e=this.props,t=e.height,r=e.maxHeight,a=e.footerHeight,n=t-a;if(r>0){var o=this._getFrozenRowsHeight(),i=this.getTotalRowsHeight(),s=this._getHeaderHeight()+o+i+this._horizontalScrollbarSize;n=Math.min(s,r-a)}return n},r._getBodyHeight=function(){return this._getTableHeight()-this._getHeaderHeight()-this._getFrozenRowsHeight()},r._getFrozenContainerHeight=function(){var e=this.props.maxHeight,t=this._getTableHeight()-(this._data.length>0?this._horizontalScrollbarSize:0);if(e>0)return t;var r=this.getTotalRowsHeight()+this._getHeaderHeight()+this._getFrozenRowsHeight();return Math.min(t,r)},r._calcScrollbarSizes=function(){var e=this.props,t=e.fixed,r=e.width,a=this.state.scrollbarSize,n=this.getTotalRowsHeight(),o=this.getTotalColumnsWidth(),i=this._horizontalScrollbarSize,s=this._verticalScrollbarSize;0===a?(this._horizontalScrollbarSize=0,this._verticalScrollbarSize=0):!t||o<=r-a?(this._horizontalScrollbarSize=0,this._verticalScrollbarSize=n>this._getBodyHeight()?a:0):o>r?(this._horizontalScrollbarSize=a,this._verticalScrollbarSize=n>this._getBodyHeight()-this._horizontalScrollbarSize?a:0):(this._horizontalScrollbarSize=0,this._verticalScrollbarSize=0,n>this._getBodyHeight()&&(this._horizontalScrollbarSize=a,this._verticalScrollbarSize=a)),i===this._horizontalScrollbarSize&&s===this._verticalScrollbarSize||(this._scrollbarPresenceChanged=!0)},r._maybeScrollbarPresenceChange=function(){if(this._scrollbarPresenceChanged){var e=this.props.onScrollbarPresenceChange;this._scrollbarPresenceChanged=!1,e({size:this.state.scrollbarSize,horizontal:this._horizontalScrollbarSize>0,vertical:this._verticalScrollbarSize>0})}},r._maybeCallOnEndReached=function(){var e=this.props,t=e.onEndReached,r=e.onEndReachedThreshold,a=this._scroll.scrollTop,n=this.getTotalRowsHeight(),o=this._getBodyHeight();if(t&&o&&n){var i=n-a-o+this._horizontalScrollbarSize;this._lastScannedRowIndex>=0&&i<=r&&(this._hasDataChangedSinceEndReached||n!==this._scrollHeight)&&(this._hasDataChangedSinceEndReached=!1,this._scrollHeight=n,t({distanceFromEnd:i}))}},r._handleScroll=function(e){var t=this._scroll.scrollTop;this.scrollToPosition(e),this.props.onScroll(e),e.scrollTop>t&&this._maybeCallOnEndReached()},r._handleVerticalScroll=function(e){var t=e.scrollTop,r=this._scroll.scrollTop;this.scrollToTop(t),t>r&&this._maybeCallOnEndReached()},r._handleRowsRendered=function(e){this.props.onRowsRendered(e),e.overscanStopIndex>this._lastScannedRowIndex&&(this._lastScannedRowIndex=e.overscanStopIndex,this._maybeCallOnEndReached())},r._handleRowHover=function(e){var t=e.hovered,r=e.rowKey;this.setState({hoveredRowKey:t?r:null})},r._handleRowExpand=function(e){var t=e.expanded,r=e.rowData,a=e.rowIndex,n=e.rowKey,o=mn(this.state.expandedRowKeys);if(t)!o.indexOf(n)>=0&&o.push(n);else{var i=o.indexOf(n);i>-1&&o.splice(i,1)}void 0===this.props.expandedRowKeys&&this.setState({expandedRowKeys:o}),this.props.onRowExpand({expanded:t,rowData:r,rowIndex:a,rowKey:n}),this.props.onExpandedRowsChange(o)},r._handleColumnResize=function(e,t){var r=e.key;this.columnManager.setColumnWidth(r,t),this.setState({resizingWidth:t});var a=this.columnManager.getColumn(r);this.props.onColumnResize({column:a,width:t})},r._handleColumnResizeStart=function(e){var t=e.key;this.setState({resizingKey:t})},r._handleColumnResizeStop=function(){this.setState({resizingKey:null})},r._handleColumnSort=function(e){var t=e.currentTarget.dataset.key,r=this.props,a=r.sortBy,n=r.sortState,o=r.onColumnSort,i=Rn.ASC;n?i=n[t]===Rn.ASC?Rn.DESC:Rn.ASC:t===a.key&&(i=a.order===Rn.ASC?Rn.DESC:Rn.ASC),o({column:this.columnManager.getColumn(t),key:t,order:i})},t}(n.a.PureComponent);Hn.Column=xn,Hn.PlaceholderKey=Ln.PlaceholderKey,Hn.defaultProps={classPrefix:"BaseTable",rowKey:"id",data:[],frozenData:[],fixed:!1,headerHeight:50,rowHeight:50,footerHeight:0,defaultExpandedRowKeys:[],sortBy:{},useIsScrolling:!1,overscanRowCount:1,onEndReachedThreshold:500,getScrollbarSize:function(e){if((!cn&&0!==cn||e)&&"undefined"!=typeof window&&window.document&&window.document.createElement){var t=document.createElement("div");t.style.position="absolute",t.style.top="-9999px",t.style.width="50px",t.style.height="50px",t.style.overflow="scroll",document.body.appendChild(t),cn=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return cn},onScroll:bn,onRowsRendered:bn,onScrollbarPresenceChange:bn,onRowExpand:bn,onExpandedRowsChange:bn,onColumnSort:bn,onColumnResize:bn},Hn.propTypes={classPrefix:Va.a.string,className:Va.a.string,style:Va.a.object,children:Va.a.node,columns:Va.a.arrayOf(Va.a.shape(xn.propTypes)),data:Va.a.arrayOf(Va.a.object).isRequired,frozenData:Va.a.arrayOf(Va.a.object),rowKey:Va.a.oneOfType([Va.a.string,Va.a.number]).isRequired,width:Va.a.number.isRequired,height:Va.a.number,maxHeight:Va.a.number,rowHeight:Va.a.number.isRequired,headerHeight:Va.a.oneOfType([Va.a.number,Va.a.arrayOf(Va.a.number)]).isRequired,footerHeight:Va.a.number,fixed:Va.a.bool,disabled:Va.a.bool,overlayRenderer:Va.a.oneOfType([Va.a.func,Va.a.element]),emptyRenderer:Va.a.oneOfType([Va.a.func,Va.a.element]),footerRenderer:Va.a.oneOfType([Va.a.func,Va.a.element]),headerRenderer:Va.a.oneOfType([Va.a.func,Va.a.element]),rowRenderer:Va.a.oneOfType([Va.a.func,Va.a.element]),headerClassName:Va.a.oneOfType([Va.a.string,Va.a.func]),rowClassName:Va.a.oneOfType([Va.a.string,Va.a.func]),headerProps:Va.a.oneOfType([Va.a.object,Va.a.func]),headerCellProps:Va.a.oneOfType([Va.a.object,Va.a.func]),rowProps:Va.a.oneOfType([Va.a.object,Va.a.func]),cellProps:Va.a.oneOfType([Va.a.object,Va.a.func]),expandIconProps:Va.a.oneOfType([Va.a.object,Va.a.func]),expandColumnKey:Va.a.string,defaultExpandedRowKeys:Va.a.arrayOf(Va.a.oneOfType([Va.a.string,Va.a.number])),expandedRowKeys:Va.a.arrayOf(Va.a.oneOfType([Va.a.string,Va.a.number])),onRowExpand:Va.a.func,onExpandedRowsChange:Va.a.func,sortBy:Va.a.shape({key:Va.a.string,order:Va.a.oneOf([Rn.ASC,Rn.DESC])}),sortState:Va.a.object,onColumnSort:Va.a.func,onColumnResize:Va.a.func,useIsScrolling:Va.a.bool,overscanRowCount:Va.a.number,getScrollbarSize:Va.a.func,onScroll:Va.a.func,onEndReached:Va.a.func,onEndReachedThreshold:Va.a.number,onRowsRendered:Va.a.func,onScrollbarPresenceChange:Va.a.func,rowEventHandlers:Va.a.object,components:Va.a.shape({TableCell:Va.a.func,TableHeaderCell:Va.a.func,ExpandIcon:Va.a.func,SortIndicator:Va.a.func})};var zn=Hn;function Un(e){var t;t="undefined"!=typeof window?window:"undefined"!=typeof self?self:global;var r,a,n="undefined"!=typeof document&&document.attachEvent;if(!n){var o=(a=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||function(e){return t.setTimeout(e,20)},function(e){return a(e)}),i=(r=t.cancelAnimationFrame||t.mozCancelAnimationFrame||t.webkitCancelAnimationFrame||t.clearTimeout,function(e){return r(e)}),s=function(e){var t=e.__resizeTriggers__,r=t.firstElementChild,a=t.lastElementChild,n=r.firstElementChild;a.scrollLeft=a.scrollWidth,a.scrollTop=a.scrollHeight,n.style.width=r.offsetWidth+1+"px",n.style.height=r.offsetHeight+1+"px",r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight},l=function(e){if(!(e.target.className.indexOf("contract-trigger")<0&&e.target.className.indexOf("expand-trigger")<0)){var t=this;s(this),this.__resizeRAF__&&i(this.__resizeRAF__),this.__resizeRAF__=o((function(){(function(e){return e.offsetWidth!=e.__resizeLast__.width||e.offsetHeight!=e.__resizeLast__.height})(t)&&(t.__resizeLast__.width=t.offsetWidth,t.__resizeLast__.height=t.offsetHeight,t.__resizeListeners__.forEach((function(r){r.call(t,e)})))}))}},c=!1,u="",d="animationstart",h="Webkit Moz O ms".split(" "),p="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),m=document.createElement("fakeelement");if(void 0!==m.style.animationName&&(c=!0),!1===c)for(var b=0;b<h.length;b++)if(void 0!==m.style[h[b]+"AnimationName"]){u="-"+h[b].toLowerCase()+"-",d=p[b],c=!0;break}var g="resizeanim",f="@"+u+"keyframes "+g+" { from { opacity: 0; } to { opacity: 0; } } ",_=u+"animation: 1ms "+g+"; "}return{addResizeListener:function(r,a){if(n)r.attachEvent("onresize",a);else{if(!r.__resizeTriggers__){var o=r.ownerDocument,i=t.getComputedStyle(r);i&&"static"==i.position&&(r.style.position="relative"),function(t){if(!t.getElementById("detectElementResize")){var r=(f||"")+".resize-triggers { "+(_||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',a=t.head||t.getElementsByTagName("head")[0],n=t.createElement("style");n.id="detectElementResize",n.type="text/css",null!=e&&n.setAttribute("nonce",e),n.styleSheet?n.styleSheet.cssText=r:n.appendChild(t.createTextNode(r)),a.appendChild(n)}}(o),r.__resizeLast__={},r.__resizeListeners__=[],(r.__resizeTriggers__=o.createElement("div")).className="resize-triggers",r.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',r.appendChild(r.__resizeTriggers__),s(r),r.addEventListener("scroll",l,!0),d&&(r.__resizeTriggers__.__animationListener__=function(e){e.animationName==g&&s(r)},r.__resizeTriggers__.addEventListener(d,r.__resizeTriggers__.__animationListener__))}r.__resizeListeners__.push(a)}},removeResizeListener:function(e,t){if(n)e.detachEvent("onresize",t);else if(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(t),1),!e.__resizeListeners__.length){e.removeEventListener("scroll",l,!0),e.__resizeTriggers__.__animationListener__&&(e.__resizeTriggers__.removeEventListener(d,e.__resizeTriggers__.__animationListener__),e.__resizeTriggers__.__animationListener__=null);try{e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)}catch(e){}}}}}var Bn=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Vn=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),Yn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Wn=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},Kn=function(e){function t(){var e,r,a;Bn(this,t);for(var n=arguments.length,o=Array(n),i=0;i<n;i++)o[i]=arguments[i];return r=a=Wn(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),a.state={height:a.props.defaultHeight||0,width:a.props.defaultWidth||0},a._onResize=function(){var e=a.props,t=e.disableHeight,r=e.disableWidth,n=e.onResize;if(a._parentNode){var o=a._parentNode.offsetHeight||0,i=a._parentNode.offsetWidth||0,s=window.getComputedStyle(a._parentNode)||{},l=parseInt(s.paddingLeft,10)||0,c=parseInt(s.paddingRight,10)||0,u=parseInt(s.paddingTop,10)||0,d=parseInt(s.paddingBottom,10)||0,h=o-u-d,p=i-l-c;(!t&&a.state.height!==h||!r&&a.state.width!==p)&&(a.setState({height:o-u-d,width:i-l-c}),n({height:o,width:i}))}},a._setRef=function(e){a._autoSizer=e},Wn(a,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Vn(t,[{key:"componentDidMount",value:function(){var e=this.props.nonce;this._autoSizer&&this._autoSizer.parentNode&&this._autoSizer.parentNode.ownerDocument&&this._autoSizer.parentNode.ownerDocument.defaultView&&this._autoSizer.parentNode instanceof this._autoSizer.parentNode.ownerDocument.defaultView.HTMLElement&&(this._parentNode=this._autoSizer.parentNode,this._detectElementResize=Un(e),this._detectElementResize.addResizeListener(this._parentNode,this._onResize),this._onResize())}},{key:"componentWillUnmount",value:function(){this._detectElementResize&&this._parentNode&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize)}},{key:"render",value:function(){var e=this.props,t=e.children,r=e.className,n=e.disableHeight,o=e.disableWidth,i=e.style,s=this.state,l=s.height,c=s.width,u={overflow:"visible"},d={},h=!1;return n||(0===l&&(h=!0),u.height=0,d.height=l),o||(0===c&&(h=!0),u.width=0,d.width=c),Object(a.createElement)("div",{className:r,ref:this._setRef,style:Yn({},u,i)},!h&&t(d))}}]),t}(a.PureComponent);Kn.defaultProps={onResize:function(){},disableHeight:!1,disableWidth:!1,style:{}};var Qn=Kn,Gn=function(e){var t=e.className,r=e.width,a=e.height,o=e.children,i=e.onResize,s="number"==typeof r,l="number"==typeof a;return s&&l?n.a.createElement("div",{className:t,style:{width:r,height:a,position:"relative"}},o({width:r,height:a})):n.a.createElement(Qn,{className:t,disableWidth:s,disableHeight:l,onResize:i},(function(e){return o({width:s?r:e.width,height:l?a:e.height})}))};Gn.propTypes={className:Va.a.string,width:Va.a.number,height:Va.a.number,children:Va.a.func.isRequired,onResize:Va.a.func};var Xn=Gn;function Jn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Zn extends a.PureComponent{constructor(){super(...arguments),Jn(this,"state",{selectedRowKeys:[],sortedRows:[],sortState:new le.OrderedMap,sortStateObj:{}}),Jn(this,"onColumnSort",e=>{let{key:t,order:r}=e,{sortState:a}=this.state;const n=a.get(t);a=a.remove(t),n&&r!==Rn.DESC||(a=a.set(t,r)),this.setState({sortState:a,sortStateObj:a.toJS(),sortedRows:eo(this.props.rows,a)},()=>{const{onChangeSort:e}=this.props;e&&e(a)})}),Jn(this,"rowEventHandlers",{onClick:e=>{let{rowData:t}=e;this.setState({selectedRowKeys:[t.id]},()=>{const{onSelectRow:e}=this.props;e&&e(t)})}}),Jn(this,"getRowClassName",e=>{let{rowData:t}=e;return D()({"moderation__author-claim__table__row__is-selected":this.state.selectedRowKeys.includes(t.id)})})}componentWillMount(){this.setState({sortedRows:eo(this.props.rows,this.state.sortState)})}componentWillReceiveProps(e){le.is(this.props.rows,e.rows)||this.setState({sortedRows:eo(e.rows,this.state.sortState)})}render(){const{sortedRows:e,sortStateObj:t,selectedRowKeys:r}=this.state;return a.createElement("div",{className:"moderation__author-claim__table"},a.createElement(Xn,null,n=>{let{width:o,height:i}=n;return a.createElement(zn,{width:o,height:i,fixed:!0,sortState:t,onColumnSort:this.onColumnSort,rowEventHandlers:this.rowEventHandlers,headerClassName:"moderation__author-claim__table__header",rowClassName:this.getRowClassName,selectedRowKeys:r,data:e},$n({dataKey:"authorName",title:"Author",frozen:!0}),$n({dataKey:"email",title:"Email"}),$n({dataKey:"claimDate",title:"Claim Date"}),$n({dataKey:"lastUpdated",title:"Last Updated"}),$n({dataKey:"flag",title:"Flag"}))}))}}const $n=e=>{let{dataKey:t,title:r,width:n,frozen:o}=e;return a.createElement(xn,{key:t,dataKey:t,title:r,width:n||150,frozen:o?xn.FrozenDirection.LEFT:null,resizable:!0,sortable:!0})};function eo(e,t){return function(e,t){return t.reduce((e,t)=>{let[r,a]=t;return e.sort((e,t)=>{const n=to(e[r]),o=to(t[r]);return n===o?0:a===Rn.DESC?n<o?1:-1:n>o?1:-1})},e)}(e.toJS(),[...t.entries()]).map(ro)}function to(e){switch(typeof e){case"string":return e.toLowerCase();case"number":return e;case"boolean":return e?1:-1;default:if(null==e)return"";if(e instanceof Date||$r.a.isMoment(e))return+e}return""}function ro(e){return Object.keys(e).reduce((t,r)=>(t[r]=function(e,t){if(null==e)return"-";if(e instanceof Date)return $r()(e).format("MM/DD/YYYY");if($r.a.isMoment(e))return e.format("MM/DD/YYYY");return e}(e[r]),t),{})}r(75);var ao=r(84),no=r.n(ao),oo=r(43),io=r.n(oo);function so(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function lo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?so(Object(r),!0).forEach((function(t){co(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):so(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function co(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const uo=no()(ye.b.AUTHOR_CLAIM_MODERATION);class ho extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),co(this,"_debounceFilterChange",null),co(this,"_lastDragResizeX",null),co(this,"onChangeFilterQuery",e=>{const t=e.currentTarget.value;this.setState({filterQuery:t},this.onFilterChangeDebounced)}),co(this,"onDragResizeStart",e=>{e.preventDefault(),this.setState({isDraggingResize:!0}),this._lastDragResizeX=e.clientX,window.addEventListener("mousemove",this.onDragResize,!1)}),co(this,"onDragResizeEnd",e=>{e.preventDefault(),this.setState({isDraggingResize:!1}),this._lastDragResizeX=null,window.removeEventListener("mousemove",this.onDragResize,!1)}),co(this,"onDragResize",e=>{const t=this._lastDragResizeX;if(!t)return;const r=e.clientX;this._lastDragResizeX=r;const a=t-r;this.setState(e=>({detailsPaneWidthPx:e.detailsPaneWidthPx+a}))}),co(this,"onFilterChange",()=>{const{location:e}=this.props,{filterQuery:t,modStatus:r}=this.state,{api:a,history:n}=this.context,o=io.a.parse(e.search,{ignoreQueryPrefix:!0});o.query=t;const i=lo({},e,{search:io.a.stringify(o)});n.replace(i),a.getAuthorProfileListForClaimModeration({status:r,query:t})}),co(this,"onFilterChangeDebounced",Object(be.a)(this.onFilterChange,1e3,{leading:!1,trailing:!0})),co(this,"onSelectRow",e=>{if(!e)return void this.setState({selectedAuthorProfile:null});const t=parseInt(e.id,10),{claimModerationStore:r}=this.context,a=r.getAuthorProfiles().find(e=>e.id===t);if(this.setState({selectedAuthorProfile:a}),a){const{api:e}=this.context;e.getAuthorProfileForClaimModeration({authorProfileId:a.id})}}),co(this,"refreshRows",()=>{const{api:e}=this.context;e.getAuthorProfileListForClaimModeration({status:this.state.modStatus,query:this.state.filterQuery}),e.fetchModerationStats()}),this.state=lo({detailsPaneWidthPx:306,filterQuery:bo(this.props.location.search),isDraggingResize:!1,modStatus:mo(this.props.location.pathname),selectedAuthorProfile:null},this.getStateFromAuthorClaimModerationStore()),this.context.claimModerationStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorClaimModerationStore())})}componentWillReceiveProps(e){const t={};if(this.props.location.pathname!==e.location.pathname){const r=mo(e.location.pathname);r!==this.state.modStatus&&(t.modStatus=r)}if(this.props.location.search!==e.location.search){const r=bo(e.location.search);r!==this.state.filterQuery&&(t.filterQuery=r)}Object.keys(t).length>0&&this.setState(t,this.onFilterChange)}handleListItemClick(e){this.setState(e)}getStateFromAuthorClaimModerationStore(){const{claimModerationStore:e}=this.context;return{isLoading:e.isLoading(),rows:e.getAuthorProfiles().map(go)}}render(){const{detailsPaneWidthPx:e,filterQuery:t,rows:r,modStatus:n,selectedAuthorProfile:o}=this.state;return a.createElement("div",{className:"moderation__author-claim"},a.createElement("div",{className:"moderation__author-claim__row"},a.createElement("div",{className:"moderation__author-claim__filter-cell"},a.createElement("label",{className:"moderation__author-claim__field"},a.createElement("div",{className:"moderation__author-claim__label"},"Filter Claims"),a.createElement("input",{className:"legacy__input moderation__author-claim__input",type:"text",placeholder:"Filter by author id, name, email, orcid id, etc.",onChange:this.onChangeFilterQuery,value:t}))),a.createElement("div",{className:"moderation__author-claim__status-cell"},a.createElement("div",{className:"moderation__author-claim__field"},a.createElement("div",{className:"moderation__author-claim__label"},"Claim Status"),a.createElement("div",{className:"moderation__author-claim__button-group"},[Sa.b.Pending,Sa.b.PendingEmailVerification,Sa.b.Approved,Sa.b.Denied].map(e=>a.createElement(po,{key:e,buttonModStatus:e,activeModStatus:n,filterQuery:t})))))),a.createElement("div",{className:"moderation__author-claim__row moderation__author-claim__row__fill-screen"},a.createElement("div",{className:"moderation__author-claim__table-cell"},a.createElement(Zn,{rows:r,onSelectRow:this.onSelectRow})),a.createElement("div",{onMouseDown:this.onDragResizeStart,onMouseUp:this.onDragResizeEnd,className:"moderation__author-claim__resize-gutter"},a.createElement(m.a,{icon:"horizontal-resize-handle"})),a.createElement("div",{className:"moderation__author-claim__details-cell",style:{width:e+"px"}},o?a.createElement(Ra,{key:o.id,authorProfile:o,onRefreshRows:this.refreshRows}):a.createElement("div",{className:"moderation__author-claim__details-cell__instructions"},"Select a claim to moderate"))))}}co(ho,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,claimModerationStore:W.a.instanceOf(Oa.a).isRequired,history:W.a.instanceOf(Ne.a).isRequired});const po=e=>{let{activeModStatus:t,buttonModStatus:r,filterQuery:n}=e;return a.createElement(Ve.a,{to:"AUTHOR_CLAIM_MODERATION",params:{status:r.toLowerCase()},query:{query:n},className:D()({"moderation__author-claim__button":!0,"moderation__author-claim__is-active":r===t})},r)};function mo(e){if(!e)return Sa.b.Pending;const t=(uo.exec(e)||[])[1];return Object(Sa.a)(t)||Sa.b.Unsupported}function bo(e){if(!e)return"";return io.a.parse(Oe.a.parse(e).query||"").query||""}function go(e){return{id:e.id,authorName:e.fullName,email:e.email,claimDate:$r()(e.claimedAtUtc),lastUpdated:null,flag:e.moderationTag}}function fo(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AuthorClaimModerationPage"),a.createElement(ho,e)}function _o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class yo extends a.Component{static async willRouteTo(e,t){let{api:r,claimModerationStore:a}=e;if(!a.isUninitialized())return;const n=Object(Sa.a)(t.params.status)||Sa.b.Unsupported,{query:o}=t.query;return r.getAuthorProfileListForClaimModeration({status:n,query:o})}render(){const{history:e}=this.context;return a.createElement(fo,{location:e.location})}}_o(yo,"getPageTitle",()=>Object(f.b)(e=>e.authorClaimModeration.pageTitle)),_o(yo,"requiresAuthentication",()=>!0),_o(yo,"contextTypes",{history:W.a.instanceOf(Ne.a).isRequired});var Eo=r(654),Oo=r(596),So=r(667);class vo extends a.PureComponent{render(){const{formError:e}=this.props;return a.createElement("div",{className:"author-onboarding__banner"},a.createElement("div",{className:"author-onboarding__banner__columns"},a.createElement("div",{className:"author-onboarding__banner__column"},this.props.leftContent,a.createElement("div",{className:"author-onboarding__banner__form-error"},e)),a.createElement("div",{className:"author-onboarding__banner__column"},this.props.children)))}}function Co(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function wo(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Po=e=>Object(y.b)(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Co(Object(r),!0).forEach((function(t){wo(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Co(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e,{id:"author_onboarding_nav"})),xo=()=>Object(y.b)({id:"author_onboarding_skip_all"}),Ro=()=>Object(y.b)({id:"author_onboarding_skip_step"});function No(){return(No=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function jo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function To(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ao extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),To(this,"onClickSubmit",()=>{this.state.hasDraftPapers?this.setState({hasAttemptedSubmit:!0,errorMessage:Object(f.b)(e=>e.authorAddPapers.error.papersInDraft)},()=>{Object(De.a)()&&this.scrollToPaper(this.context.authorCorrectionsStore.getDraftPaperIds().first())}):this.setState({hasAttemptedSubmit:!0},()=>{this.submitCorrections().then(()=>this.emitStepComplete()).catch(e=>this.onApiError(e))})}),To(this,"emitStepComplete",()=>{this.props.onStepComplete("AUTHOR_ONBOARDING_ADD_PAPERS")}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?jo(Object(r),!0).forEach((function(t){To(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({isSending:!1,errorMessage:null,hasAttemptedSubmit:!1},this.getStateFromAuthStore(),{},this.getStateFromAuthorCorrectionsStore()),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())}),this.context.authorCorrectionsStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorCorrectionsStore())})}getStateFromAuthStore(){const{authStore:e}=this.context;return{authorId:e.getClaimedAuthorId()}}getStateFromAuthorCorrectionsStore(){const{authorCorrectionsStore:e}=this.context,t=e.hasDraftPapers();return{isFormDirty:e.hasPendingCorrections()||t,hasDraftPapers:t}}scrollToPaper(e){if(!e)return!1;const t=document.querySelector('.author-add-papers__paper[data-paper-id="'.concat(e,'"]'));return!!t&&(t.scrollIntoView({behavior:"smooth"}),!0)}onApiError(e){w.a.error("Error with API",e),this.setState({errorMessage:Object(f.b)(e=>e.authorRemovePapers.error.apiSubmitFailed),isSending:!1})}async submitCorrections(){const{authorId:e}=this.state,{api:t,authorCorrectionsStore:r}=this.context;V()(e,"authorId must be populated to submit corrections");const a=r.getPendingCorrections(),n=r.getPendingIndexRequestUrls();await Object(ge.e)(this,{isSending:!0}),a&&await t.submitPaperAuthorCorrections({authorId:e,corrections:a.toJS()}),n&&await t.submitAuthorIndexRequests({urls:n.toJS()}),await Object(ge.e)(this,{isSending:!1}),r.clearPendingCorrections(),r.clearPendingIndexRequests()}render(){const{stepNum:e,numSteps:t}=this.props,{authorId:r,errorMessage:n,hasAttemptedSubmit:o,hasDraftPapers:i,isFormDirty:s}=this.state;return a.createElement("div",null,a.createElement("div",{className:"author-onboarding__page__content-block"},a.createElement("div",{className:"author-onboarding__step-num-label"},Object(f.b)(e=>e.authorOnboarding.stepNumLabel,e,t)),a.createElement("h2",{className:"author-onboarding__step-label"},Object(f.b)(e=>e.authorOnboarding.addPapersPage.stepLabel)),a.createElement("div",{className:"author-onboarding__step-description"},a.createElement(p.a,{content:Object(f.b)(e=>e.authorOnboarding.addPapersPage.stepDescription)}))),a.createElement("hr",{className:"author-onboarding__divider"}),r&&a.createElement(ve,{authorId:r,showDraftAsError:o&&i}),r?a.createElement(Pe,{authorId:r}):null,a.createElement(vo,{formError:n},a.createElement("button",No({className:"author-onboarding__banner__link-button"},Ro(),{onClick:this.emitStepComplete}),Object(f.b)(e=>e.authorOnboarding.addPapersPage.skipLabel)),a.createElement("span",{className:"author-onboarding__banner__button-spacer"}),a.createElement("button",No({className:"author-onboarding__banner__continue-button button button--primary"},Object(y.b)({id:"author_add_paper_submit"}),{onClick:this.onClickSubmit}),Object(f.b)(e=>e.authorOnboarding.banner.submitLabel))),a.createElement(ke,{when:s,message:Object(f.b)(e=>e.authorOnboarding.dirtyFormMessage)}))}}function Io(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AuthorOnboardingAddPapersPage"),a.createElement(Ao,e)}function Fo(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}To(Ao,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,authStore:W.a.instanceOf(xe.a).isRequired,authorCorrectionsStore:W.a.instanceOf(z.a).isRequired});class ko extends a.Component{render(){return a.createElement(Io,this.props)}}Fo(ko,"getPageTitle",()=>Object(f.b)(e=>e.authorOnboarding.addPapersPage.pageTitle)),Fo(ko,"getStepLabel",()=>Object(f.b)(e=>e.authorOnboarding.addPapersPage.stepLabel)),Fo(ko,"requiresAuthentication",()=>!0);class Do extends a.PureComponent{render(){const{authorId:e}=this.props;return a.createElement("div",{className:"corrections-summary"},a.createElement("div",{className:"corrections-summary__section"},a.createElement("div",{className:"correction-summary__blank-state"},a.createElement("div",{className:"correction-summary__blank-state__content"},a.createElement(m.a,{className:"correction-summary__blank-state__icon",icon:"user-with-checkmark",width:"70",height:"87.5"}),a.createElement("div",{className:"correction-summary__blank-state__description"},Object(f.b)(e=>e.correctionSummary.noCorrections.label)),e&&a.createElement("div",{className:"correction-summary__blank-state__author-page-button"},a.createElement(Ve.a,{to:"AUTHOR_PROFILE_BY_ID",params:{authorId:e},className:"button button--secondary"},Object(f.b)(e=>e.correctionSummary.noCorrections.authorPageButton)))))))}}function Lo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Mo(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class qo extends a.Component{constructor(e,t){super(e,t),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Lo(Object(r),!0).forEach((function(t){Mo(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthStore(),{},this.getStateFromCorrectionsStore()),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())}),this.context.correctionsStore.registerComponent(this,()=>{this.setState(this.getStateFromCorrectionsStore())}),this.props.onStepComplete("AUTHOR_ONBOARDING_COMPLETE")}getStateFromAuthStore(){const{authStore:e}=this.context;return{claimedAuthorId:e.getClaimedAuthorId()}}getStateFromCorrectionsStore(){const{correctionsStore:e}=this.context;return{hasPendingCorrections:e.hasCorrections()}}render(){const{stepNum:e,numSteps:t}=this.props,{hasPendingCorrections:r,claimedAuthorId:n}=this.state;return a.createElement("div",{className:"author-onboarding__page__content-block"},a.createElement("div",{className:"author-onboarding__step-num-label"},Object(f.b)(e=>e.authorOnboarding.stepNumLabel,e,t)),a.createElement("h2",{className:"author-onboarding__step-label"},Object(f.b)(e=>e.authorOnboarding.completePage.stepLabel)),r?a.createElement(Kt,null):a.createElement(Do,{authorId:n}),a.createElement(o,null,a.createElement(s,null,a.createElement("span",{className:"author-onboarding__banner__button-spacer"}),a.createElement(Ve.a,{className:"author-onboarding__page__author-profile-link-button button button--primary",to:"AUTHOR_PROFILE_BY_ID",params:{authorId:n}},Object(f.b)(e=>e.account.page.corrections.authorPageLink)))))}}function Ho(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AuthorOnboardingCompletePage"),a.createElement(qo,e)}function zo(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Mo(qo,"contextTypes",{authStore:W.a.instanceOf(xe.a).isRequired,correctionsStore:W.a.instanceOf(kt.a).isRequired});class Uo extends a.Component{static async willRouteTo(e){let{api:t,authStore:r}=e;const a=r.getClaimedAuthorId();if(a)return Promise.all([t.fetchAuthorCorrectionsForAuthor({authorId:a}),t.fetchPaperAuthorCorrectionsForAuthor({authorId:a,includePaperModel:"PaperLite"})])}render(){return a.createElement(Ho,this.props)}}zo(Uo,"getPageTitle",()=>Object(f.b)(e=>e.authorOnboarding.completePage.pageTitle)),zo(Uo,"getStepLabel",()=>Object(f.b)(e=>e.authorOnboarding.completePage.stepLabel)),zo(Uo,"requiresAuthentication",()=>!0);var Bo=e=>{let{name:t,label:r,placeholder:n,error:o,value:i,onChange:s,isRequired:l}=e;return a.createElement("label",{className:D()("author-edit__field",{"author-edit__has-error":o})},a.createElement("div",{className:"author-edit__field__label"},a.createElement("span",{className:"author-edit__field__label-text"},r),!l&&a.createElement("span",{className:"author-edit__field__label-optional"},Object(f.b)(e=>e.authorEdit.form.optional))),a.createElement("div",{className:"author-edit__field__input"},a.createElement("input",{type:"text",name:t,className:"legacy__input author-edit__field__input-text",value:i,onChange:s,placeholder:n}),a.createElement("div",{className:"author-edit__field__error"},o)))};function Vo(){return(Vo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Yo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Wo(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ko extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),Wo(this,"onClickSkip",e=>{e.preventDefault(),this.emitStepComplete()}),Wo(this,"onClickSubmit",e=>{e.preventDefault(),this.updateAuthorProfile()}),Wo(this,"onSubmitForm",e=>{e.preventDefault(),this.updateAuthorProfile()}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Yo(Object(r),!0).forEach((function(t){Wo(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({isSending:!1,isFormDirty:!1,formError:null,firstNameError:null,middleNamesError:null,lastNameError:null,affiliationError:null,orcidIdError:null,homepageUrlError:null},this.getStateFromAuthorOrAuthorProfileStore()),this.context.authorStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorOrAuthorProfileStore())}),this.context.authorProfileStore.registerComponent(this,()=>{this.state.isFormDirty||this.setState(this.getStateFromAuthorOrAuthorProfileStore())}),this.onChangeFirstName=this.onChangeText.bind(this,"firstName"),this.onChangeMiddleNames=this.onChangeText.bind(this,"middleNames"),this.onChangeLastName=this.onChangeText.bind(this,"lastName"),this.onChangeAffiliation=this.onChangeText.bind(this,"affiliation"),this.onChangeOrcidId=this.onChangeText.bind(this,"orcidId"),this.onChangeHomepageUrl=this.onChangeText.bind(this,"homepageUrl")}getStateFromAuthorOrAuthorProfileStore(){const e=this.context.authorProfileStore.getAuthorProfile();if(e){const t=e.affiliations.isEmpty?"":e.affiliations.join("; "),r=e.middleNames.isEmpty?"":e.middleNames.join(" ");return{firstNameValue:e.firstName||"",middleNamesValue:r,lastNameValue:e.lastName||"",affiliationValue:t,orcidIdValue:e.orcidId||"",homepageUrlValue:e.homepageUrl||"",fullNameValue:e.fullName||""}}const{authorStore:t}=this.context,{authorDetail:r}=t;if(r){const e=r.author.affiliations.isEmpty?"":r.author.affiliations.join("; "),t=r.author.middleNames.isEmpty?"":r.author.middleNames.join(" ");return{firstNameValue:r.author.firstName||"",middleNamesValue:t,lastNameValue:r.author.lastName||"",affiliationValue:e,orcidIdValue:r.author.orcidId||"",homepageUrlValue:r.author.homepage||"",fullNameValue:""}}return{firstNameValue:"",middleNamesValue:"",lastNameValue:"",affiliationValue:"",orcidIdValue:"",homepageUrlValue:"",fullNameValue:""}}validateFormState(){const{lastNameValue:e,orcidIdValue:t,homepageUrlValue:r}=this.state;let a=null,n=null,o=null;return e.trim()||(a=Object(f.b)(e=>e.authorEdit.error.lastNameMissing)),t&&(ht.a.test(t)||(n=Object(f.b)(e=>e.authorEdit.error.orcidIdInvalid))),r&&(Oe.a.parse(r).host&&dt.a.test(r)||(o=Object(f.b)(e=>e.authorEdit.error.homepageUrlInvalid))),{firstNameError:null,middleNamesError:null,lastNameError:a,affiliationError:null,orcidIdError:n,homepageUrlError:o}}async updateAuthorProfile(){const e=this.validateFormState();if(this.setState(e),!!Object.values(e).find(e=>null!==e))return void w.a.warn("Could not save do to errors",e);const{author:t}=this.context.authorStore,r={authorId:t.id,lastName:this.state.lastNameValue.trim(),middleNames:this.state.middleNamesValue.toString().split(" ").map(e=>e.trim()),firstName:this.state.firstNameValue.trim(),affiliation:this.state.affiliationValue.toString().split(";").map(e=>e.trim()),orcidId:this.state.orcidIdValue.trim(),homepageUrl:this.state.homepageUrlValue.trim()};w.a.info("Saving author profile",r),await Object(ge.e)(this,{isSending:!0,formError:null});const a=Object(ge.b)(0);try{await this.context.api.updateAuthorProfile(r)}catch(e){return void await Object(ge.e)(this,{isSending:!1,formError:Object(f.b)(e=>e.authorEdit.error.apiFailed)})}await a,await Object(ge.e)(this,{isSending:!1}),this.emitStepComplete()}emitStepComplete(){this.props.onStepComplete("AUTHOR_ONBOARDING_PROFILE")}onChangeCheckbox(e,t){this.setState({isFormDirty:!0,["".concat(e,"Value")]:!!t.currentTarget.checked})}onChangeText(e,t){this.setState({isFormDirty:!0,["".concat(e,"Error")]:null,["".concat(e,"Value")]:t.currentTarget.value})}getHeaderLabel(e){return e?Object(f.b)(e=>e.authorOnboarding.profilePage.stepLabelWithName,e):Object(f.b)(e=>e.authorOnboarding.profilePage.stepLabelWithoutName)}render(){const{authorDetail:e}=this.context.authorStore;if(!e)return null;const{stepNum:t,numSteps:r}=this.props,{formError:n,firstNameError:o,firstNameValue:i,middleNamesError:s,middleNamesValue:l,lastNameError:c,lastNameValue:u,affiliationError:d,affiliationValue:h,orcidIdError:m,orcidIdValue:b,homepageUrlError:g,homepageUrlValue:_,fullNameValue:E,isFormDirty:O}=this.state;return a.createElement("div",{className:"author-edit"},a.createElement("div",{className:"author-onboarding__page__content-block"},a.createElement("div",{className:"author-onboarding__step-num-label"},Object(f.b)(e=>e.authorOnboarding.stepNumLabel,t,r)),a.createElement("h2",{className:"author-onboarding__step-label"},this.getHeaderLabel(E)),a.createElement("div",{className:"author-onboarding__step-description"},a.createElement(p.a,{content:Object(f.b)(e=>e.authorOnboarding.profilePage.stepDescription)}))),a.createElement("hr",{className:"author-edit__divider"}),a.createElement("form",{className:"author-edit__form",onSubmit:this.onSubmitForm},a.createElement("div",{className:"author-onboarding__page__content-block"},a.createElement(Bo,{name:"firstName",label:Object(f.b)(e=>e.authorEdit.form.firstNameLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.firstNamePlaceholder),value:i,error:o,onChange:this.onChangeFirstName,isRequired:!1}),a.createElement(Bo,{name:"middleNames",label:Object(f.b)(e=>e.authorEdit.form.middleNamesLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.middleNamesPlaceholder),value:l,error:s,onChange:this.onChangeMiddleNames,isRequired:!1}),a.createElement(Bo,{name:"lastName",label:Object(f.b)(e=>e.authorEdit.form.lastNameLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.lastNamePlaceholder),value:u,error:c,onChange:this.onChangeLastName,isRequired:!0}),a.createElement("div",{className:"author-onboarding__field__description"},a.createElement("span",{className:"author-onboarding__field__description-text"},Object(f.b)(e=>e.authorEdit.form.applyToPapersDescription)))),a.createElement("hr",{className:"author-edit__divider"}),a.createElement("div",{className:"author-onboarding__page__content-block"},a.createElement(Bo,{name:"affiliation",label:Object(f.b)(e=>e.authorEdit.form.affiliationLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.affiliationPlaceholder),value:h,error:d,onChange:this.onChangeAffiliation,isRequired:!1}),a.createElement(Bo,{name:"orcidId",label:Object(f.b)(e=>e.authorEdit.form.orcidIdLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.orcidIdPlaceholder),value:b,error:m,onChange:this.onChangeOrcidId,isRequired:!1}),a.createElement(Bo,{name:"homepageUrl",label:Object(f.b)(e=>e.authorEdit.form.homepageUrlLabel),placeholder:Object(f.b)(e=>e.authorEdit.form.homepageUrlPlaceholder),value:_,error:g,onChange:this.onChangeHomepageUrl,isRequired:!1})),a.createElement(vo,{formError:n},a.createElement("button",Vo({className:"author-onboarding__banner__link-button"},Ro(),{onClick:this.onClickSkip}),Object(f.b)(e=>e.authorOnboarding.profilePage.skipLabel)),a.createElement("span",{className:"author-onboarding__banner__button-spacer"}),a.createElement("button",Vo({className:"author-onboarding__banner__continue-button button button--primary"},Object(y.b)({id:"author_profile_submit"}),{onClick:this.onClickSubmit}),Object(f.b)(e=>e.authorOnboarding.banner.submitLabel)))),a.createElement(ke,{when:O,message:Object(f.b)(e=>e.authorOnboarding.dirtyFormMessage)}))}}function Qo(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AuthorOnboardingProfilePage"),a.createElement(Ko,e)}function Go(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Wo(Ko,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,authorStore:W.a.instanceOf(H.a).isRequired,authorProfileStore:W.a.instanceOf(U.a).isRequired,authStore:W.a.instanceOf(xe.a).isRequired,dispatcher:W.a.instanceOf(Vr.Dispatcher).isRequired});class Xo extends a.Component{static async willRouteTo(e){let{authStore:t,api:r}=e;const a=t.getClaimedAuthorId();return V()(a,"Claimed author missing"),Promise.all([r.fetchAuthorProfile({authorId:a}),r.fetchAuthorDetail(a,null,!1)])}render(){return a.createElement(Qo,this.props)}}function Jo(){return(Jo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Zo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function $o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Go(Xo,"getPageTitle",()=>Object(f.b)(e=>e.authorOnboarding.profilePage.pageTitle)),Go(Xo,"getStepLabel",()=>Object(f.b)(e=>e.authorOnboarding.profilePage.stepLabelWithoutName)),Go(Xo,"requiresAuthentication",()=>!0);class ei extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),$o(this,"onClickSubmit",()=>{this.submitCorrections().then(()=>this.emitStepComplete()).catch(e=>this.onApiError(e))}),$o(this,"emitStepComplete",()=>{this.props.onStepComplete("AUTHOR_ONBOARDING_REMOVE_PAPERS")}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Zo(Object(r),!0).forEach((function(t){$o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({isSending:!1,errorMessage:null},this.getStateFromAuthStore(),{},this.getStateFromAuthorCorrectionsStore()),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())}),this.context.authorCorrectionsStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorCorrectionsStore())})}getStateFromAuthStore(){const{authStore:e}=this.context;return{authorId:e.getClaimedAuthorId()}}getStateFromAuthorCorrectionsStore(){const{authorCorrectionsStore:e}=this.context;return{isFormDirty:e.hasPendingCorrections()||e.hasDraftPapers()}}onApiError(e){w.a.error("Error with API",e),this.setState({errorMessage:Object(f.b)(e=>e.authorRemovePapers.error.apiSubmitFailed),isSending:!1})}async submitCorrections(){const{api:e,authorCorrectionsStore:t}=this.context,{authorId:r}=this.state,a=t.getPendingCorrections();await Object(ge.e)(this,{isSending:!0}),await e.submitPaperAuthorCorrections({authorId:r,corrections:a}),await Object(ge.e)(this,{isSending:!1}),t.clearPendingCorrections()}render(){const{stepNum:e,numSteps:t}=this.props,{authorId:r,errorMessage:n,isFormDirty:o}=this.state;return a.createElement("div",null,a.createElement("div",{className:"author-onboarding__page__content-block"},a.createElement("div",{className:"author-onboarding__step-num-label"},Object(f.b)(e=>e.authorOnboarding.stepNumLabel,e,t)),a.createElement("h2",{className:"author-onboarding__step-label"},Object(f.b)(e=>e.authorOnboarding.removePapersPage.stepLabel)),a.createElement("div",{className:"author-onboarding__step-description"},a.createElement(p.a,{content:Object(f.b)(e=>e.authorOnboarding.removePapersPage.stepDescription)}))),a.createElement("hr",{className:"author-onboarding__divider"}),r&&a.createElement(mr,{key:r,authorId:r}),a.createElement(vo,{formError:n,leftContent:a.createElement(fr,null)},a.createElement("button",Jo({className:"author-onboarding__banner__link-button"},Ro(),{onClick:this.emitStepComplete}),Object(f.b)(e=>e.authorOnboarding.removePapersPage.skipLabel)),a.createElement("span",{className:"author-onboarding__banner__button-spacer"}),a.createElement("button",Jo({className:"author-onboarding__banner__continue-button button button--primary"},Object(y.b)({id:"author_remove_paper_submit"}),{onClick:this.onClickSubmit}),Object(f.b)(e=>e.authorOnboarding.banner.submitLabel))),a.createElement(ke,{when:o,message:Object(f.b)(e=>e.authorOnboarding.dirtyFormMessage)}))}}function ti(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AuthorOnboardingRemovePapersPage"),a.createElement(ei,e)}function ri(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}$o(ei,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,authStore:W.a.instanceOf(xe.a).isRequired,authorCorrectionsStore:W.a.instanceOf(z.a).isRequired});class ai extends a.Component{render(){return a.createElement(ti,this.props)}}ri(ai,"getPageTitle",()=>Object(f.b)(e=>e.authorOnboarding.removePapersPage.pageTitle)),ri(ai,"getStepLabel",()=>Object(f.b)(e=>e.authorOnboarding.removePapersPage.stepLabel)),ri(ai,"requiresAuthentication",()=>!0);var ni=r(519);function oi(){return(oi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}class ii extends a.PureComponent{renderStep(e){let{stepNum:t,isActive:r,hasCompleted:n,linkRouteName:o,label:i}=e;const s=a.createElement(a.Fragment,null,a.createElement("div",{className:"author-onboarding-nav__step-num"},n?a.createElement(m.a,{className:"author-onboarding-nav__step-num__check",icon:"check",height:"8",width:"8"}):a.createElement("div",{className:"author-onboarding-nav__step-num__number"},t)),a.createElement("div",{className:"author-onboarding-nav__step-label"},i));return a.createElement("li",{key:t,className:D()({"author-onboarding-nav__step":!0,"author-onboarding-nav__is-active":r,"author-onboarding-nav__has-completed":n})},n?a.createElement(Ve.a,oi({to:o},Po({"route-name":o}),{className:"author-onboarding-nav__step-layout"}),s):a.createElement("div",{className:"author-onboarding-nav__step-layout"},s))}render(){const{steps:e}=this.props;return a.createElement("div",{className:"author-onboarding-nav"},a.createElement("div",{className:"author-onboarding-nav__beta-tag"},a.createElement(ni.a,{display:"link",openNewTab:!0})),a.createElement("h3",{className:"author-onboarding-nav__headline"},Object(f.b)(e=>e.authorOnboarding.nav.headline)),a.createElement("nav",{className:"author-onboarding-nav__nav"},a.createElement("ol",{className:"author-onboarding-nav__step-list"},e.map(e=>this.renderStep(e)))))}}var si=r(20),li=r(93);function ci(){return(ci=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function ui(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class di extends a.Component{constructor(){super(...arguments),ui(this,"state",{completedSteps:le.Set()}),ui(this,"onStepComplete",e=>{this.completeStep(e).catch(e=>w.a.error(e))}),ui(this,"onClickCancel",()=>{const{onCancel:e}=this.props;e&&e()}),ui(this,"onClickContact",e=>{e.preventDefault(),this.context.dispatcher.dispatch(Object(Br.b)({id:Ur.b.FEEDBACK}))})}getSteps(){var e;const{history:t}=this.context,{route:r}=this.props,a=null!=(e=Object(xr.a)(r.routes,t.location.pathname))&&null!=(e=e[0])&&null!=(e=e.route)?e.path:e;return(r.routes||[]).map((e,t)=>{const r=Object(ye.c)(e.path)||"AUTHOR_ONBOARDING",n=e.component,o="function"==typeof n.getStepLabel?n.getStepLabel():null;return{isActive:e.path===a,hasCompleted:this.state.completedSteps.has(r),label:o||Object(f.b)(e=>e.authorOnboarding.defaultStepLabel,(t+1).toLocaleString()),linkRouteName:r,stepNum:t+1}})}async completeStep(e){const{completedSteps:t}=this.state;t.has(e)||await Object(ge.e)(this,{completedSteps:t.add(e)});const r=this.getSteps(),a=r.findIndex(e=>!e.hasCompleted),n=a<0?null:r[a];if(n){const{history:e}=this.context;e.push(Object(ye.d)({routeName:n.linkRouteName}))}}render(){const e=this.getSteps(),t=this.context.authStore.getClaimedAuthorId();const r={onStepComplete:this.onStepComplete,stepNum:hi(e),numSteps:e.length};return a.createElement(Pr.a,{className:"author-onboarding"},a.createElement("div",{className:"author-onboarding__columns"},a.createElement("div",{className:"author-onboarding__column author-onboarding__column__nav"},a.createElement("div",{className:"author-onboarding__nav"},a.createElement(ii,{steps:e}),a.createElement("div",{className:"author-onboarding__nav__links"},t?a.createElement(Ve.a,ci({to:"AUTHOR_PROFILE_BY_ID",params:{authorId:t},className:"author-onboarding__nav__link"},xo(),{onClick:this.onClickCancel}),Object(f.b)(e=>e.authorOnboarding.banner.cancelLabel)):a.createElement(Ve.a,ci({to:"HOME",className:"author-onboarding__nav__link"},xo(),{onClick:this.onClickCancel}),Object(f.b)(e=>e.authorOnboarding.banner.cancelLabel)),a.createElement("a",{className:"author-onboarding__nav__link",onClick:this.onClickContact},Object(f.b)(e=>e.authorOnboarding.banner.contactLabel))))),a.createElement("div",{className:"author-onboarding__column author-onboarding__page"},Object(xr.b)(this.props.route.routes,r))))}}function hi(e){const t=e.find(e=>e.isActive);return t?t.stepNum:1}function pi(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AuthorOnboardingPage"),a.createElement(di,e)}function mi(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}ui(di,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,authStore:W.a.instanceOf(xe.a).isRequired,dispatcher:W.a.instanceOf(si.a).isRequired,history:W.a.instanceOf(Ne.a).isRequired,weblabStore:W.a.instanceOf(li.b).isRequired});class bi extends a.Component{static async willRouteTo(e,t){const{api:r,authStore:a,weblabStore:n}=e,o=a.getClaimedAuthorId();return o&&n.isFeatureEnabled(ia.b.AuthorClaim)?t.path===ye.b.AUTHOR_ONBOARDING?new St.a({routeName:"AUTHOR_ONBOARDING_PROFILE",replace:!0,status:302}):void await r.fetchAuthorProfile({authorId:o}):new St.a({routeName:"HOME",replace:!0,status:302})}static getRobotDirectives(e){e.shouldIndex=!1}render(){return a.createElement(pi,this.props)}}mi(bi,"getPageTitle",()=>Object(f.b)(e=>e.authorEdit.pageTitle.withoutName)),mi(bi,"requiresAuthentication",()=>!0);var gi=r(135);class fi extends a.PureComponent{render(){return a.createElement(ie.c,{feature:ia.b.AuthorClaimAllowNewClaims},a.createElement(ie.b,null,a.createElement("div",{className:"author-claim-ad"},a.createElement("div",{className:"author-claim-ad__content-container"},a.createElement("div",{className:"author-claim-ad__title"},Object(f.b)(e=>e.authorClaim.ad.headline)),a.createElement("div",{className:"author-claim-ad__description"},a.createElement(p.a,{content:Object(f.b)(e=>e.authorClaim.ad.description)}))))))}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(fi,"contextTypes",{iconStore:W.a.instanceOf(gi.a).isRequired});var _i=r(686),yi=r(413),Ei=r(387),Oi=r(27);class Si extends a.Component{renderRecommendationRow(e){const{author:t,isCoauthor:r}=e;return a.createElement(Ve.a,{"data-heap-id":"author-recs-link",to:"AUTHOR_DETAILS",params:{slug:t.slug,authorId:t.id}},a.createElement(yi.default,{key:t.id&&t.id.toString()},a.createElement("div",{className:"author-recs__author-icon"},a.createElement(m.a,{icon:"user",width:"19",height:"19"})),a.createElement("ul",null,a.createElement("li",null,a.createElement("span",{className:"author-recs__author-title"},t.name)),a.createElement("li",{className:"author-recs__metadata"},Object(f.b)(e=>e.author.recommendations.counts.formattedCounts,Object(Oi.l)(t.statistics.totalPaperCount||0,Object(f.b)(e=>e.author.recommendations.counts.publication)),Object(Oi.l)(t.statistics.totalCitationCount||0,Object(f.b)(e=>e.author.recommendations.counts.citation)))),r&&a.createElement("li",{className:"author-recs__metadata"},Object(f.b)(e=>e.author.recommendations.coAuthorLabel)))))}render(){const{recommendations:e,maxResults:t}=this.props,r=t?e.slice(0,t):e;return a.createElement("div",{className:D()("author-recs",{"author-recs__compact":!vi(r)})},a.createElement("div",{className:"author-recs__top-flex"},a.createElement("h2",{className:"author-recs__header"},Object(f.b)(e=>e.author.recommendations.headline)),a.createElement(Ei.default,{placement:Ei.PLACEMENT.RIGHT,tooltipContent:Object(f.b)(e=>e.author.recommendations.reason.globalBaseline)},a.createElement("span",{className:"author-recs__global-tip"},Object(f.b)(e=>e.author.recommendations.why)))),r.map(e=>this.renderRecommendationRow(e)))}}const vi=e=>!!e.find(e=>e.isCoauthor);var Ci=r(402),wi=r(480),Pi=r(383),xi=r(444),Ri=r(464),Ni=r(524),ji=r(386),Ti=r(525),Ai=r(443),Ii=r(526),Fi=r(432),ki=r(445),Di=r(527),Li=r(59),Mi=r(90),qi=r(65);r(45);class Hi extends a.PureComponent{handleChangeSort(e){const t="string"==typeof e?e:e.target.value;this.props.onChangeSort&&this.props.onChangeSort(t);const r=this.context.analyticsLocation;if(r){const e=Mi.a.getIn(r,"SORT_BY");Object(qi.a)(Di.a.create(e,{sort:t}))}else Object(qi.a)(Di.a.create(Mi.a.SORT_BY,{sort:t}))}render(){const{className:e}=this.props,t=D()(e,"search-sort flex-row-vcenter filter-bar__sort-selector");return a.createElement("div",{className:t},a.createElement("select",{className:"legacy__select search-sort-select",onChange:this.handleChangeSort.bind(this),value:this.props.sort,"data-selenium-selector":"sort-select"},this.props.options.map(e=>{const t=Li.a.getString("sort.".concat(e.id,".label"));return a.createElement("option",{value:e.id,key:e.id,"data-selenium-selector":"sort-by-".concat(e.id)},Li.a.getString("sort.label",t))})),a.createElement(m.a,{icon:"disclosure",height:"12",width:"12",className:"dropdown-arrow-icon"}))}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Hi,"contextTypes",{analyticsLocation:W.a.object});var zi=r(366),Ui=r(500);class Bi{constructor(e,t){this.id=e,this.displayName=t}}const Vi={AUTHOR:new Bi("author","Authors"),COAUTHOR:new Bi("coAuthor","Co-Authors"),VENUE:new Bi("venue","Venues"),PUBLICATION_TYPE:new Bi("publicationType","Publication Types"),EXTERNAL_CONTENT_TYPE:new Bi("externalContentType","Supplemental Content")};var Yi=Object(Ui.b)(Vi),Wi=r(26),Ki=r(95),Qi=(r(48),r(33)),Gi=r(21),Xi=r.n(Gi);class Ji{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{showSortExplanation:!1,showResultCount:!0,sortDisplayType:"select",scrollToTopOfPage:!0,searchResultLayout:{showSortStat:!1},sorts:null};e.sorts||(e.sorts=Qi.a.paperSearch()),Xi()(this,e)}}function Zi(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class $i extends a.PureComponent{constructor(){super(...arguments),Zi(this,"onChangeYearFilter",(e,t)=>{const{queryStore:r,router:a}=this.context;r.routeToYearRange(e,t,a)}),Zi(this,"onChangeSort",e=>{this.context.queryStore.routeToSort(e,this.context.router)}),Zi(this,"toggleHasPdf",()=>{Object(qi.a)(zi.a.create(Mi.a.FACET_HAS_PDF,{documentCount:this.state.countOfPapersWithViewablePdf,action:this.state.isPdfFilterSelected?"disable":"enable"})),Wi.a.changeRouteForQuery(this.context.queryStore.getQuery().set("requireViewablePdf",!this.state.isPdfFilterSelected),this.context.history,this.context.router),this.setState({isPdfFilterSelected:!this.state.isPdfFilterSelected})}),Zi(this,"isFiltered",e=>{const t=this.context.queryStore.getQuery()[e];return"yearFilter"===e?t.min||t.max:!!t&&!!t.size>0}),this.state=this.getStateFromQueryStore(),this.context.queryStore.registerComponent(this,()=>{this.setState(this.getStateFromQueryStore())})}getStateFromQueryStore(){const e=this.context.queryStore.getQueryResponse().stats.get("countOfPapersWithViewablePdf")||0,t=this.context.queryStore.getQueryResponse().stats.get("years").size>1||!1;return{isPdfFilterSelected:this.context.queryStore.getQuery().requireViewablePdf,countOfPapersWithViewablePdf:e,shouldDisplayYearFilter:t,query:this.context.queryStore.getQuery(),response:this.context.queryStore.getQueryResponse(),yearFilter:this.context.queryStore.getQuery().yearFilter}}getButtonLabel(e,t,r){const a=this.context.queryStore.getQuery()[e];return a.isEmpty()?t:1===a.size?Object(Oi.p)(a.first(),r):"".concat(Object(Oi.p)(a.first(),r)," +").concat(a.size-1)}renderDates(){const{response:e,query:t}=this.state,{stats:r}=e;return a.createElement(ki.a,{analyticsEvent:Mi.a.Serp.YEAR_SLIDER,filterCallback:this.onChangeYearFilter,filters:r,histogramHeight:95,histogramWidth:221,yearFilter:t.yearFilter,showPresetButtons:!0})}renderFilterList(e,t){return t.size>5?a.createElement(Ii.a,{label:Yi.findById(e).displayName,lessText:"Fewer"},r=>a.createElement(Fi.a,{maxLabelLength:30,collapsible:!1,filterType:e,displayDocCount:!0,filters:t.take(r?t.size:5),isFilterBar:!0})):a.createElement(Fi.a,{maxLabelLength:30,displayDocCount:!0,collapsible:!1,filterType:e,filters:t,isFilterBar:!0})}render(){const{query:e,response:t,shouldDisplayYearFilter:r,isPdfFilterSelected:n}=this.state,{layoutOptions:o}=this.props,i=t.stats,s=i.get("venues"),l=i.get("coAuthors");return a.createElement("div",{className:"filter-bar"},r&&a.createElement(Ai.a,{content:this.renderDates()},a.createElement("button",{className:{"filter-bar__button":!0,"filter-bar__button-selected":this.isFiltered("yearFilter")}},Object(f.b)(e=>e.filterBar.filterLabels.date),a.createElement(m.a,{icon:"disclosure",width:"12",height:"12",className:"dropdown-arrow-icon"}))),!l.isEmpty()&&a.createElement(Ai.a,{content:this.renderFilterList(Yi.COAUTHOR.id,l)},a.createElement("button",{className:{"filter-bar__button":!0,"filter-bar__button-selected":this.isFiltered("coAuthors")},"data-selenium-selector":"co-author-facet-filter"},this.getButtonLabel("coAuthors",Object(f.b)(e=>e.filterBar.filterLabels.coAuthor),20),a.createElement(m.a,{icon:"disclosure",width:"12",height:"12",className:"dropdown-arrow-icon"}))),!s.isEmpty()&&a.createElement(Ai.a,{content:this.renderFilterList(Yi.VENUE.id,s)},a.createElement("button",{className:{"filter-bar__button":!0,"filter-bar__button-selected":this.isFiltered("venues")}},this.getButtonLabel("venues",Object(f.b)(e=>e.filterBar.filterLabels.venue),25),a.createElement(m.a,{icon:"disclosure",width:"12",height:"12",className:"dropdown-arrow-icon"}))),a.createElement("button",{className:D()({"filter-bar__button":!0,"filter-bar__has-pdf-button":!0,"filter-bar__button-selected":n}),onClick:this.toggleHasPdf},"Has PDF"),a.createElement("div",{className:"filter-bar__sort-selector-container standard-form"},a.createElement(Hi,{onChangeSort:this.onChangeSort,options:o.sorts,sort:e.sort})))}}Zi($i,"contextTypes",{history:W.a.instanceOf(Ne.a).isRequired,queryStore:W.a.instanceOf(Ki.a).isRequired,router:W.a.object.isRequired});var es=r(652),ts=r(528),rs=r(468),as=r(186),ns=r(99);function os(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const is=e=>{let{influentialCitationCount:t}=e;return n.a.createElement("span",{className:"matched-author-list__citations"},n.a.createElement("span",{className:"matched-author-list__comma-prefix"},", "),n.a.createElement("em",{className:"text--orange"},Object(Oi.e)(t))," highly influential ",Object(Oi.l)(t,"citation","citations",!0))};is.propTypes={influentialCitationCount:W.a.number.isRequired};class ss extends a.PureComponent{constructor(){super(...arguments),this.trackAuthorLinkClick=this.trackAuthorLinkClick.bind(this)}trackAuthorLinkClick(){Object(qi.a)(zi.a.create(Mi.a.Serp.MATCHED_AUTHOR,{authorId:this.props.author.id,index:this.props.index}))}render(){return n.a.createElement("div",null,n.a.createElement(Ve.a,{to:"AUTHOR_PROFILE",params:{authorId:this.props.author.id,slug:this.props.author.slug},onClick:this.trackAuthorLinkClick,className:"matched-author-list__author-name"},n.a.createElement("em",null,this.props.author.name)),this.props.author.influentialCitationCount>0?n.a.createElement(is,{influentialCitationCount:this.props.author.influentialCitationCount}):null)}}os(ss,"propTypes",{author:W.a.instanceOf(as.a).isRequired,index:W.a.number.isRequired,displayAsInfoBox:W.a.bool}),os(ss,"defaultProps",{displayAsInfoBox:!1});class ls extends a.PureComponent{constructor(){super(...arguments),this.state={limit:3,hasReportedProblem:!0,hideReportProblem:!0},this.toggleDisplayLimit=this.toggleDisplayLimit.bind(this),this.submitMatchError=this.submitMatchError.bind(this)}componentDidMount(){Object(qi.a)(ns.a.create(Mi.a.Serp.MATCHED_AUTHOR_LIST,{count:this.props.authors.size,authorIds:JSON.stringify(this.props.authors.map(e=>e.id))}))}toggleDisplayLimit(){this.setState(e=>{const t=3===e.limit?this.props.authors.size:3;return Object(qi.a)(zi.a.create(Mi.a.Serp.MATCHED_AUTHOR_LIST_TOGGLE,{more:t===this.props.authors.size})),{limit:t}})}submitMatchError(){const e=this.props.authors.map(e=>{const t=Object(ye.d)({routeName:"AUTHOR_PROFILE_BY_ID",params:{authorId:e.id}}),r="".concat(document.location.protocol,"//").concat(document.location.host).concat(t);return{id:e.id,name:e.name,href:r}}),t={query:this.props.queryString,matchedAuthors:e};this.context.api.submitFeedback("Potential Author Match Issue | ".concat(JSON.stringify(t)),"s2-author-match-error@allenai.org"),this.setState({hasReportedProblem:!0})}componentDidUpdate(){this.state.hasReportedProblem&&!this.hideReportProblem&&(this.hideReportProblemsTimer=setTimeout(this.setState.bind(this,{hideReportProblem:!0}),5e3))}componentWillUnmount(){this.hideReportProblemsTimer&&clearTimeout(this.hideReportProblemsTimer)}renderAuthorList(){const e=this.props.authors.take(this.state.limit),t=this.props.authors.size>3,r=D()("matched-author-list__report-problems",{"matched-author-list__report-problems--with-divider":t,"matched-author-list__report-problems--problem-reported":this.state.hasReportedProblem});return n.a.createElement("div",{className:"matched-author-list"},this.props.displayAsInfoBox?null:n.a.createElement("div",{className:"flex-row-vcenter"},n.a.createElement(m.a,{icon:"author",className:"matched-author-list__header-icon",width:"18",height:"18"}),n.a.createElement("span",null,"Author profiles for ",n.a.createElement("em",null,this.props.queryString),":")),n.a.createElement("ul",null,e.map((e,t)=>n.a.createElement("li",{key:"matched-author-".concat(e.id,"-").concat(t)},n.a.createElement(ss,{author:e,index:t})))),t?n.a.createElement("a",{onClick:this.toggleDisplayLimit,"data-selenium-selector":"matched-author-list-toggle"},this.props.authors.size>this.state.limit?"See More":"See Less"):null,!this.state.hideReportProblem&&this.props.authors.size>1?n.a.createElement("span",{className:r},this.state.hasReportedProblem?n.a.createElement("span",null,n.a.createElement(m.a,{icon:"check",width:"14",height:"14"})," Thanks! Well look into it."):n.a.createElement("a",{onClick:this.submitMatchError},"Report duplicate authors")):null)}render(){return this.props.displayAsInfoBox?n.a.createElement(rs.a,{title:"Authors",icon:"author"},this.renderAuthorList()):this.renderAuthorList()}}os(ls,"propTypes",{authors:W.a.instanceOf(ce.a.List).isRequired,queryString:W.a.string.isRequired}),os(ls,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired});var cs=r(404),us=r(476),ds=r(678),hs=r(550),ps=r(607);function ms(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function bs(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class gs extends a.PureComponent{constructor(){super(...arguments),bs(this,"trackActionClick",(e,t)=>{this.handleAnalyticsEvent("Action",e,t)})}handleAnalyticsEvent(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=this.context.analyticsLocation,{index:n,result:o}=this.props,i=o.id;if(a){const o=Mi.a.getIn(a,e,t),s=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ms(Object(r),!0).forEach((function(t){bs(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ms(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},r,{index:n,paperId:i});Object(qi.a)(zi.a.create(o,s))}else w.a.warn("You need to add analyticsLocation to context so that we know where this action event happened.")}render(){const{className:e,index:t,onTitleClick:r,children:n,result:o,layout:i}=this.props,s=a.createElement(a.Fragment,null,a.createElement(ps.a,{citationStats:o.citationStats,externalContentStats:o.externalContentStats,id:o.id,index:t,showSortStat:i.showSortStat}),a.createElement(ds.a,{paper:o,rowIndex:t,trackActionClick:this.trackActionClick}));return a.createElement(hs.a,{paper:o,index:t,onTitleClick:r,className:e,children:n,paperActions:s})}}bs(gs,"contextTypes",{analyticsLocation:W.a.object}),bs(gs,"propTypes",{result:W.a.object.isRequired,index:W.a.number.isRequired,layout:W.a.object.isRequired,onTitleClick:W.a.func,className:W.a.string});var fs=r(530),_s=r(104),ys=r(51),Es=r(772),Os=r(773),Ss=r(24),vs=r(172),Cs=r.n(vs);function ws(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Ps(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ws(Object(r),!0).forEach((function(t){xs(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ws(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function xs(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Rs extends a.PureComponent{constructor(e,t){super(e,t),xs(this,"onClickShowPublications",()=>{this.setState({showPublications:!0,showInfluenceGraph:!1})}),xs(this,"onClickShowInfluenceGraph",()=>{this.setState({showPublications:!1,showInfluenceGraph:!0})}),xs(this,"loadPage",e=>{if(e!==this.state.query.page){let t=Cs.a.findDOMNode(this),r=null;t instanceof HTMLElement&&(r=ys.a.offsetFromBody(t)),ys.a.scrollTop(this.props.layoutOptions.scrollToTopOfPage?0:r),this.context.queryStore.routeToPage(e,this.context.router)}}),xs(this,"trackAuthorClick",e=>{let{paper:t,eventData:r,compData:a}=e;const{analyticsLocation:n}=this.context,{authorId:o}=a;Object(_s.c)(Ps({},Object(_s.a)(this.context.queryStore,{paperSha:t.id,paperIndex:r.index}),{authorId:parseInt(o)})),Object(Pi.d)({paper:t,analyticsLocation:n,eventData:r,compData:a})}),this.state=Ps({showPublications:!0,showInfluenceGraph:!1},this.stateFromQueryStore()),t.queryStore.registerComponent(this,()=>{this.setState(this.stateFromQueryStore())})}stateFromQueryStore(){const e=this.context.queryStore._state;return{queryStoreState:e,query:this.context.queryStore._query,response:this.context.queryStore._response,isFiltering:e===Ss.a.FILTERING}}componentDidUpdate(e,t){if(!ce.a.is(t.response,this.state.response)&&!this.state.response.results.isEmpty()){const e=ys.a.scrollTop(),t=this.refs["search-result-".concat(this.state.response.results.size-1)];if(t){const r=ys.a.offsetFromBody(t);r<e&&ys.a.scrollTop(r-20)}}}renderResults(){const{authorDetail:e,layoutOptions:{searchResultLayout:t}}=this.props,{query:r,response:{results:n}}=this.state;return n.map((n,o)=>a.createElement(ie.c,{feature:ia.b.SharedPaperRow,key:n.id},a.createElement(ie.b,null,a.createElement(Pi.c,{paper:n,eventData:{authorId:e.author.id,index:(r.page-1)*r.pageSize+o},onClickAuthor:this.trackAuthorClick,onHoverStats:!0},a.createElement(Ri.default,{paper:n,className:"author-page-details__paper-row",controls:a.createElement(xi.default,{paper:n,actions:a.createElement(Ci.default,{paper:n,library:a.createElement(wi.default,{paper:n,seleniumSelector:"paper-action-save"})})})}))),a.createElement(ie.a,null,a.createElement(gs,{result:n,index:(r.page-1)*r.pageSize+o,ref:"search-result-".concat(o),layout:t}))))}renderNoResults(){const{querySuggestions:e}=this.state.response,t=!(e&&!e.isEmpty())?void 0:e.first().text;return a.createElement(Ti.a,{query:this.state.query.queryString,hasFacets:this.state.response.hasFacets(),suggestedQuery:t})}renderAuthor(){const{isFiltering:e,response:t,query:r,showPublications:n,showInfluenceGraph:o}=this.state,{layoutOptions:i,authorDetail:s,claimedAuthorId:l}=this.props,{results:c,matchedAuthors:u}=t;return a.createElement(Ni.a,null,a.createElement(fs.a,{className:"filter",side:"left"},a.createElement(_i.a,null),a.createElement(ie.c,{feature:ia.b.AHPFeed},a.createElement(ie.b,null,()=>a.createElement(Es.a,{authorId:s.author.id,displayScale:"count",displayScaleMaxValue:20}))),a.createElement(ie.c,{feature:e=>e.AuthorRecommendations},a.createElement(ie.b,null,a.createElement(us.a,{experiment:qr.b.AuthorRecommendations,eligibilityTest:()=>!s.recommendedAuthors.isEmpty()},a.createElement(ji.b,null,null),a.createElement(ji.c,{variation:qr.b.AuthorRecommendations.Variation.TEST},()=>a.createElement(Si,{recommendations:s.recommendedAuthors,maxResults:4})))))),a.createElement(ts.a,{className:"results"},a.createElement("div",{className:"author-page-content-tabs"},a.createElement("ul",{className:"author-page-content-tabs__list"},a.createElement("li",{key:"publications",onClick:this.onClickShowPublications,className:D()({"is-active":n})},a.createElement(m.a,{icon:"tab-papers",width:"9",height:"12"}),Object(f.b)(e=>e.author.tabs.papers)),a.createElement("li",{key:"influence",onClick:this.onClickShowInfluenceGraph,className:D()({"is-active":o})},a.createElement(m.a,{icon:"tab-influence",width:"21",height:"21"}),a.createElement("span",{className:"author-page-content-tab__influence-label"},Object(f.b)(e=>e.author.tabs.influence))))),u.isEmpty()?null:a.createElement(ls,{queryString:r.queryString,authors:u}),n&&a.createElement(a.Fragment,null,a.createElement(ie.c,{feature:ia.b.AHPFeed},a.createElement(ie.a,null,a.createElement($i,{layoutOptions:i}),a.createElement("hr",{className:"author-page-divider"}),a.createElement(ie.c,{feature:e=>e.AuthorClaimAd},a.createElement(ie.b,null,a.createElement("div",{className:"author-page-content__claim-ad"},!l&&!s.isClaimedByAuthor&&a.createElement(fi,null)))),a.createElement("div",{className:D()("result-page",{"is-filtering":e})},c.isEmpty()?this.renderNoResults():this.renderResults())),a.createElement(ie.b,null,()=>a.createElement("div",{className:D()("result-page",{"is-filtering":e})},c.isEmpty()?this.renderNoResults():a.createElement(Os.a,{results:c,authorId:s.author.id,query:r,layout:i,maxFeedsToDisplay:4})))),a.createElement("div",{className:"flex-row"},t.totalPages>1&&a.createElement(cs.a,{className:"flex-right",loadPage:this.loadPage,pageNumber:r.page,totalPages:t.totalPages}))),o&&a.createElement(es.a,{authorDetail:s})))}render(){const{queryStoreState:e}=this.state;return e===Ss.a.LOADING?a.createElement("section",{className:"content",role:"main",id:"main-content"},a.createElement("div",{className:"container loading-controls flex-row-vcenter"},a.createElement(Ce.a,{seleniumSelector:"icon-loading-serp"})," Loading results")):a.createElement("section",{className:"content"},this.renderAuthor())}}xs(Rs,"contextTypes",{analyticsLocation:W.a.object,queryStore:W.a.instanceOf(Ki.a).isRequired,router:W.a.object.isRequired});var Ns=r(448);class js extends a.PureComponent{render(){const{author:e,claimedAuthorId:t}=this.props,r=new Ji({showSortExplanation:!0,filtersExpandedByDefault:!0,showResultCount:!1,sortDisplayType:"tabs",scrollToTopOfPage:!1,searchResultLayout:{showSortStat:!0},sorts:Qi.a.authorPaperSearch()});return a.createElement("div",{className:"author-page-content-section"},a.createElement("div",{className:"author-publications-list"},a.createElement(Rs,{layoutOptions:r,authorDetail:e,claimedAuthorId:t})))}}var Ts=Object(Ns.a)(Mi.a.AuthorHomePage.Publications)(js);class As extends a.PureComponent{constructor(e){super(e)}render(){const{author:e,claimedAuthorId:t}=this.props;return a.createElement(a.Fragment,null,e.isClaimedBySignedInUser&&e.hasPendingCorrections&&a.createElement("div",{className:"author-page__corrections-pending"},a.createElement(m.a,{icon:"status-waiting"}),a.createElement("div",{className:"author-page__corrections-pending__label"},Object(f.b)(e=>e.author.correctionPending.label))),a.createElement("div",{className:"container author-page-content",role:"main"},a.createElement(Ts,{author:e,claimedAuthorId:t,ref:"author-search-results"})))}}var Is=r(29);function Fs(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ks(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Fs(Object(r),!0).forEach((function(t){Ds(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fs(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ds(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ls extends a.Component{constructor(){super(...arguments);const{authStore:e,authorStore:t,queryStore:r}=this.context;this.state=ks({},this.getStateFromAuthorStore(),{},this.getStateFromAuthStore()),t.registerComponent(this,()=>{this.setState(this.getStateFromAuthorStore)}),r.registerComponent(this,()=>{this.setState({loading:t.isLoading()||r.isLoading()})}),e.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())})}getStateFromAuthorStore(){const{authorStore:e,queryStore:t}=this.context;return{loading:e.isLoading()||t.isLoading(),author:e.authorDetail}}getStateFromAuthStore(){return{claimedAuthorId:this.context.authStore.getClaimedAuthorId()}}renderLoading(){return a.createElement("div",{className:"flex-row-vcenter loading container",role:"main",id:"main-content"},a.createElement(Ce.a,{seleniumSelector:"icon-loading-ahp"}),"Loading author")}scrollToSearchResults(){const{history:e}=this.context,t=Object(Is.n)(e.location.search);if(t.scrollToResults&&!this.state.loading){const r=Cs.a.findDOMNode(this.refs["author-search-results"]);r instanceof HTMLElement&&ys.a.smoothScrollTo(r,()=>{e.replace({pathname:e.location.pathname,search:Object(Is.a)(ks({},t))})})}}componentDidUpdate(){this.scrollToSearchResults()}componentDidMount(){this.scrollToSearchResults()}render(){const{author:e,claimedAuthorId:t,loading:r}=this.state;return a.createElement(Pr.a,{footer:!r,className:"author-page"},r?this.renderLoading():a.createElement("div",{className:"author-page-layout"},a.createElement("div",{className:"content"},e&&a.createElement(As,{author:e,claimedAuthorId:t}))),Object(xr.b)(this.props.route.routes))}}function Ms(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AuthorPage"),a.createElement(Ls,e)}Ds(Ls,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,authStore:W.a.instanceOf(xe.a).isRequired,authorStore:W.a.instanceOf(H.a).isRequired,history:W.a.instanceOf(Ne.a).isRequired,queryStore:W.a.instanceOf(Ki.a).isRequired});var qs=r(1),Hs=r(97);class zs extends a.Component{static getPageTitle(e){var t;let{authorStore:r}=e;const{authorDetail:a}=r,n=null!=(t=a)&&null!=(t=t.author)?t.name:t;return n?Object(f.b)(e=>e.author.pageTitleWithAuthor,n):Object(f.b)(e=>e.author.pageTitleWithoutAuthor)}static getPageMetaDescription(e){let{authorStore:t}=e;const{authorDetail:r}=t;if(r)return r.authorPageMetaDescription()}static getCanonicalUrl(e){if(e.params.slug){const{authorId:t,slug:r}=e.params;return Object(ye.d)({routeName:"AUTHOR_PROFILE",params:{authorId:t,slug:r}})}}static async willRouteTo(e,t){const{authorStore:r,authStore:a,api:n,dispatcher:o}=e,{authorId:i,slug:s}=t.params;r.isNewOrCanonicalAuthor(i,s)&&o.dispatch({actionType:qs.a.actions.QUERY_UPDATED,query:{}});const l=[Ki.a.executeAHPQuery(e,t)];return a.hasAuthenticatedUser()&&i&&l.push(n.findAlertByQueryTypeAndValue(Hs.c.AUTHOR_PAPER,i),n.findAlertByQueryTypeAndValue(Hs.c.AUTHOR_CITATION,i)),Promise.all(l)}render(){return a.createElement(Ms,this.props)}}var Us=r(153),Bs=r(382);function Vs(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Ys(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ws extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.onChangeInput=this.onChangeInput.bind(this),this.onClickApprove=this.onClickApprove.bind(this),this.onClickDeny=this.onClickDeny.bind(this),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Vs(Object(r),!0).forEach((function(t){Ys(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vs(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthStore(),{approveDisabled:!1,denyDisabled:!1,newModerationStatus:null,moderatorNotes:null,errorMessage:null}),this.context.authStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthStore())})}getStateFromAuthStore(){return{moderatorEmail:this.context.authStore.getEmail()}}onClickApprove(){this.setState({denyDisabled:!1,approveDisabled:!0,newModerationStatus:Sa.b.Approved},()=>this.handleClickEvent())}onClickDeny(){this.setState({denyDisabled:!0,approveDisabled:!1,newModerationStatus:Sa.b.Denied},()=>this.handleClickEvent())}onChangeInput(e){this.setState({moderatorNotes:e.currentTarget.value})}handleClickEvent(){this.handleModeration()}_missingParamError(e){throw new Error("Operation failed, missing param: ".concat(e))}async handleModeration(){const e=this.state.moderatorNotes?this.state.moderatorNotes.trim():null,t=this.state.newModerationStatus?this.state.newModerationStatus.toString():this._missingParamError("moderationStatus"),r={paperAuthorCorrectionId:this.props.paperAuthorCorrection.id,moderationStatus:t,moderatorNotes:e,moderator:this.state.moderatorEmail.trim()};await Object(ge.e)(this,{errorMessage:null});try{await this.context.api.updateModerationStatusForPaperAuthorCorrection(r)}catch(e){await Object(ge.e)(this,{errorMessage:Object(f.b)(e=>e.authorClaimModeration.error.apiFailed)})}}renderTop(){const{paperAuthorCorrection:e}=this.props;return a.createElement("tr",{className:"authorship-moderation__table__details-row"},a.createElement("td",null,e.createdAtUnix&&$r()(1e3*e.createdAtUnix).format("LLL")),a.createElement("td",null,e.correctionType),a.createElement("td",null,a.createElement(Ve.a,{to:"AUTHOR_PROFILE_BY_ID",params:{authorId:e.authorId}},a.createElement("em",null,e.authorId))),a.createElement("td",null,a.createElement(Ve.a,{to:"PAPER_DETAIL_BY_ID",params:{paperId:e.paperHash}},a.createElement("em",null,e.paperHash&&e.paperHash.slice(-6)))),a.createElement("td",{className:"authorship-moderation__button-row"},a.createElement(Bs.a,{onClick:this.onClickApprove,disabled:this.state.approveDisabled,className:"authorship-moderation__button__approve button button--primary",text:Object(f.b)(e=>e.authorClaimModeration.buttons.approveLabel),iconProps:{icon:"thumbs-up",width:"16",height:"16"},"data-selenium-selector":"save-moderation-status-button"}),a.createElement(Bs.a,{onClick:this.onClickDeny,disabled:this.state.denyDisabled,className:"authorship-moderation__button__deny button button--primary",text:Object(f.b)(e=>e.authorClaimModeration.buttons.denyLabel),iconProps:{icon:"thumbs-down",width:"16",height:"16"},"data-selenium-selector":"save-moderation-status-button"})),a.createElement("td",{rowSpan:"2"},a.createElement("textarea",{typs:"textarea",name:"moderatorNotes",className:"legacy__textarea authorship-moderation__field__moderator-notes__input-text",onChange:this.onChangeInput})))}renderBottom(){return a.createElement("tr",null,a.createElement("td",{colSpan:"100",className:"authorship-moderation__table__correction-td"},"[ THIS IS WHERE WE WILL RENDER THE CORRECTION TO BE APPLIED ]"))}render(){return a.createElement(a.Fragment,null,this.renderTop(),this.renderBottom())}}function Ks(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Qs(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Ys(Ws,"propTypes",{paperAuthorCorrection:W.a.object.isRequired}),Ys(Ws,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,authStore:W.a.instanceOf(xe.a).isRequired});class Gs extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ks(Object(r),!0).forEach((function(t){Qs(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ks(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthorshipModerationStore()),this.context.authorshipModerationStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorshipModerationStore())})}getStateFromAuthorshipModerationStore(){return{pendingCorrections:this.context.authorshipModerationStore.getPendingPaperAuthorCorrectionRecords()}}render(){const e=this.state.pendingCorrections;return a.createElement("div",{className:"authorship-moderation"},a.createElement("div",{className:"authorship-moderation__columns"},a.createElement("main",{className:"authorship-moderation__column authorship-moderation__main"},a.createElement("h1",{className:"authorship-moderation__headline"},"Authorship Correction Moderation"),e.size>0?a.createElement("table",{className:"authorship-moderation__table"},a.createElement("thead",{className:"authorship-moderation__table-header"},a.createElement("tr",null,a.createElement("th",null,"CREATED"),a.createElement("th",null,"TYPE"),a.createElement("th",null,"AUTHOR"),a.createElement("th",null,"PAPER"),a.createElement("th",null,"ACTION"),a.createElement("th",null,"NOTES"))),a.createElement("tbody",null,e.map(e=>a.createElement(Ws,{paperAuthorCorrection:e,key:e.id})))):a.createElement("h2",null,"Cool, no pending authorship corrections!"))))}}function Xs(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-AuthorshipModerationPage"),a.createElement(Gs,e)}function Js(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Qs(Gs,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,authorshipModerationStore:W.a.instanceOf(Us.a).isRequired});class Zs extends a.Component{render(){return a.createElement(Xs,null)}}Js(Zs,"getPageTitle",()=>Object(f.b)(e=>e.authorshipModeration.pageTitle)),Js(Zs,"requiresAuthentication",()=>!0);var $s=r(660),el=r(661),tl=r(662),rl=r(668),al=r(612);function nl(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-CrawlerPage"),a.createElement(al.b,e)}function ol(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class il extends a.Component{render(){return a.createElement(nl,null)}}ol(il,"getPageMetaDescription",()=>Object(f.b)(e=>e.metaDescription.crawlerPage.content)),ol(il,"getPageTitle",()=>[Object(f.b)(e=>e.metaDescription.crawlerPage.title),Object(f.b)(e=>e.general.appName)].join(" | "));var sl=r(569);function ll(){return a.createElement(sl.a,null)}function cl(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-CreateAlertPage"),a.createElement(ll,e)}class ul extends a.Component{static getPageTitle(e){let{alertsStore:t}=e;const{newAlert:r}=t;V()(r,"There must be a newAlert in the alertsStore to render the CreateAlertsPage");const{queryType:a}=r,n=Object(f.b)(e=>e.alerts.create[a].title),o=Object(f.b)(e=>e.general.appName);return"".concat(n," | ").concat(o)}static async willRouteTo(e){let{alertsStore:t}=e;if(!t.isCreatingAlert())return new St.a({path:ye.b.HOME,replace:!0})}render(){return a.createElement(cl,null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(ul,"requiresAuthentication",()=>!0);var dl=r(613),hl=r(614),pl=r(361);function ml(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function bl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ml(Object(r),!0).forEach((function(t){gl(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ml(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function gl(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class fl extends a.Component{constructor(){super(...arguments),gl(this,"state",{activeName:null,activeExampleConfig:null,examplePropValues:{},selectedExampleIndex:0}),gl(this,"_previewRef",null),gl(this,"onChangeExample",e=>{const{value:t}=e.currentTarget,r=this.state.activeExampleConfig;if(!r)return;const a=parseInt(t,10),n=Object(dl.b)(r,a);this.setState({selectedExampleIndex:a,examplePropValues:n},()=>{this.replaceQueryString()})}),gl(this,"onChangeField",(e,t)=>{const{examplePropValues:r}=this.state;t in r&&this.setState({examplePropValues:bl({},r,{[t]:e})},()=>{this.sendPropsToPreview(this.state.examplePropValues).catch(e=>{w.a.error("Failed to send props to preview",e)})})}),gl(this,"setPreviewRef",e=>{this._previewRef=e})}componentDidMount(){this.checkAndLoadComponent(this.props,this.state)}componentDidUpdate(){this.checkAndLoadComponent(this.props,this.state)}checkAndLoadComponent(e,t){const r=e.componentName;r!==t.activeName&&(r?this.loadComponent(r):this.setState({activeName:null,activeExampleConfig:null,examplePropValues:{},selectedExampleIndex:0}))}async loadComponent(e){await Object(ge.e)(this,{activeName:e});const t=hl.a[e]||null;if(!t)return;const r=await t();if(this.state.activeName!==e)return;const a=function(e){const t=e.location.search.replace(/^\?/,""),{example:r}=io.a.parse(t),a=parseInt(r,10);return isNaN(a)?0:a}(this.context.history),n=r.exampleConfig||null;this.setState({activeExampleConfig:n,examplePropValues:Object(dl.b)(n,a),selectedExampleIndex:a})}async sendPropsToPreview(e){var t;const r=(null!=(t=this._previewRef)&&null!=(t=t.contentWindow)?t.updateExampleComponentProps:t)||null;V()(r,"Preview page is not ready to receive props"),await r(bl({},e))}replaceQueryString(){const{selectedExampleIndex:e}=this.state,{history:t}=this.context;t.replace({pathname:t.location.pathname,search:io.a.stringify({example:e||0})})}renderMenu(e){return a.createElement(Ol,null,Object.keys(e).map(t=>a.createElement(Sl,{key:t},a.createElement(El,null,t),(e=>Array.isArray(e)?a.createElement(Ol,null,e.map(e=>a.createElement(Sl,{key:e},a.createElement(Ve.a,{to:"DEBUG_COMPONENT_LIBRARY_COMPONENT",params:{component:e}},e)))):this.renderMenu(e))(e[t]))))}render(){var e,t;const{activeName:r,activeExampleConfig:n,examplePropValues:o,selectedExampleIndex:i}=this.state,s=(null!=(t=n)?t.fields:t)||[],l=(null!=(e=n)?e.examples:e)||[],c=l[i]||null,u=r?Object(pl.a)(ye.b.DEBUG_COMPONENT_LIBRARY_PREVIEW,{component:r,exampleIndex:i||0}):null;return a.createElement(_l,null,a.createElement(yl,null,this.renderMenu(hl.b)),a.createElement(vl,null,a.createElement("h2",null,r||"Choose Component"),a.createElement(Cl,{key:u,src:u,ref:this.setPreviewRef}),a.createElement(wl,null,a.createElement("a",{href:u},"Example: "),a.createElement(Pl,{onChange:this.onChangeExample,value:i||0},l.map((e,t)=>a.createElement(xl,{key:"".concat(e.title,"|").concat(t),value:t},e.title)))),a.createElement(Rl,null,c&&a.createElement(a.Fragment,null,a.createElement(Nl,null,c.desc),s.map(e=>a.createElement(jl,{key:"".concat(c.title,"|").concat(e.name)},a.createElement(Tl,null,a.createElement(Al,null,e.name),a.createElement(Il,null,e.desc)),a.createElement(Fl,null,Object(dl.d)(e,o[e.name],this.onChangeField))))))))}}gl(fl,"contextTypes",{history:W.a.instanceOf(Ne.a).isRequired});const _l=ea.a.div.withConfig({displayName:"DebugComponentLibraryPage__Layout",componentId:"sc-1cto3i1-0"})(["display:flex;height:100%;"]),yl=ea.a.nav.withConfig({displayName:"DebugComponentLibraryPage__Menu",componentId:"sc-1cto3i1-1"})(["flex:0 0 auto;padding:32px 16px;margin-right:16px;height:100%;overflow-y:scroll;"]),El=ea.a.div.withConfig({displayName:"DebugComponentLibraryPage__MenuTitle",componentId:"sc-1cto3i1-2"})(["font-weight:bold;"]),Ol=ea.a.ul.withConfig({displayName:"DebugComponentLibraryPage__MenuList",componentId:"sc-1cto3i1-3"})(["margin-left:16px;margin-bottom:8px;"]),Sl=ea.a.li.withConfig({displayName:"DebugComponentLibraryPage__MenuItem",componentId:"sc-1cto3i1-4"})([""]),vl=ea.a.div.withConfig({displayName:"DebugComponentLibraryPage__Preview",componentId:"sc-1cto3i1-5"})(["flex:1 1 auto;display:flex;flex-direction:column;"]),Cl=ea.a.iframe.withConfig({displayName:"DebugComponentLibraryPage__PreviewCanvas",componentId:"sc-1cto3i1-6"})(["flex:1 1 auto;"]),wl=ea.a.div.withConfig({displayName:"DebugComponentLibraryPage__PreviewExample",componentId:"sc-1cto3i1-7"})([""]),Pl=ea.a.select.withConfig({displayName:"DebugComponentLibraryPage__ExamplesDropdown",componentId:"sc-1cto3i1-8"})([""]),xl=ea.a.option.withConfig({displayName:"DebugComponentLibraryPage__ExampleChoice",componentId:"sc-1cto3i1-9"})([""]),Rl=ea.a.div.withConfig({displayName:"DebugComponentLibraryPage__PreviewForm",componentId:"sc-1cto3i1-10"})(["flex:1 1 auto;margin-top:1em;"]),Nl=ea.a.div.withConfig({displayName:"DebugComponentLibraryPage__PreviewDesc",componentId:"sc-1cto3i1-11"})([""]),jl=ea.a.div.withConfig({displayName:"DebugComponentLibraryPage__PreviewField",componentId:"sc-1cto3i1-12"})(["margin-top:6px;"]),Tl=ea.a.div.withConfig({displayName:"DebugComponentLibraryPage__PreviewFieldMeta",componentId:"sc-1cto3i1-13"})(["display:flex;"]),Al=ea.a.div.withConfig({displayName:"DebugComponentLibraryPage__PreviewFieldName",componentId:"sc-1cto3i1-14"})(["flex:0 0 auto;margin-right:16px;font-weight:700;font-family:monospace;"]),Il=ea.a.div.withConfig({displayName:"DebugComponentLibraryPage__PreviewFieldDesc",componentId:"sc-1cto3i1-15"})(["flex:1 1 auto;"]),Fl=ea.a.div.withConfig({displayName:"DebugComponentLibraryPage__PreviewFieldInput",componentId:"sc-1cto3i1-16"})(["margin-left:16px;"]);function kl(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("library-DebugComponentLibraryPage"),a.createElement(fl,e)}class Dl extends a.Component{render(){var e;const t=(null!=(e=this.props)&&null!=(e=e.match)&&null!=(e=e.params)?e.component:e)||null;return a.createElement(kl,{componentName:t})}}var Ll=r(669),Ml=r(545);class ql extends a.Component{render(){const e=Ml.b.keySeq().sort();return a.createElement("div",{style:{margin:"20px"}},a.createElement("h2",null,"Displaying ",Ml.b.size," Sprites"),a.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},e.map(e=>a.createElement("div",{key:e,style:{border:"3px solid",margin:"10px",padding:"20px"}},a.createElement(m.a,{icon:e,width:"40",height:"40"}),a.createElement("span",{style:{marginLeft:"10px"}},e)))))}}function Hl(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("shared-DebugSpritesPage"),a.createElement(ql,e)}class zl extends a.Component{render(){return a.createElement(Hl,null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(zl,"pageTitle",()=>Object(f.b)(e=>e.general.appName));var Ul=r(670),Bl=r(615),Vl=r(650),Yl=r(616);function Wl(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Kl extends a.Component{render(){return a.createElement(Yl.a,{footer:!1,load:{importer:()=>r.e(4).then(r.bind(null,803)),chunkName:"desktop-FAQPage",moduleId:803}})}}Wl(Kl,"getPageMetaDescription",()=>Object(f.b)(e=>e.metaDescription.faqPage.content)),Wl(Kl,"getPageTitle",()=>[Object(f.b)(e=>e.faq.title),Object(f.b)(e=>e.general.appName)].join(" | "));var Ql=r(663),Gl=r(475),Xl=r(655),Jl=r(657),Zl=r(651),$l=r(624),ec=r(416),tc=r(625),rc=r(407),ac=r(626),nc=r(627),oc=r(688),ic=r(628),sc=r(656),lc=r(638),cc=r(96),uc=r(540),dc=r(139);function hc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function pc(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?hc(Object(r),!0).forEach((function(t){mc(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function mc(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class bc extends a.Component{constructor(){super(...arguments),this.state=pc({},this.getStateFromSampleQueriesStore(),{},this.getStateFromWeblabStore()),this.context.sampleQueriesStore.registerComponent(this,()=>{this.setState(this.getStateFromSampleQueriesStore())}),this.context.weblabStore.registerComponent(this,()=>{this.setState(pc({},this.getStateFromSampleQueriesStore(),{},this.getStateFromWeblabStore()))})}componentDidMount(){const{history:e}=this.context;Object(Is.n)(e.location.search).signIn&&!this.context.authStore.hasAuthenticatedUser()&&this.context.dispatcher.dispatch(Object(Br.b)({id:Ur.b.SIGNUP,location:cc.f.navBar}))}getStateFromSampleQueriesStore(){const{sampleQueriesStore:e}=this.context;return{sampleQueries:e.sampleQueries}}getStateFromWeblabStore(){return{isBlmBgEnabled:this.context.weblabStore.isFeatureEnabled(ia.b.BlackLivesMatterBackground)}}render(){const{sampleQueries:e,isBlmBgEnabled:t}=this.state;return a.createElement(rc.a,{heapProps:{"page-type":uc.a,"relevance-bucket":"featured"}},a.createElement(ji.a,{experiment:qr.b.HomePageSearchEmphasisExtension},a.createElement(ji.b,null,a.createElement(Pr.a,{className:D()("home-page",{"black-lives-matter":t}),header:!1},a.createElement(ic.a,{sampleQueries:e}),a.createElement(sc.a,null),a.createElement(tc.a,null),a.createElement(ac.a,null),a.createElement(nc.a,null),a.createElement(lc.a,null),a.createElement(oc.a,null))),a.createElement(ji.c,{variation:qr.b.HomePageSearchEmphasisExtension.Variation.REFRESHED},a.createElement(Pr.a,{className:D()("home-page__search_emphasis",{"black-lives-matter":t}),header:!1,footer:a.createElement(ec.a,{showFootnoteLinks:!1,reverse:!0,showUsingSources:!1})},a.createElement(ic.a,{sampleQueries:e}),a.createElement(oc.a,null),a.createElement($l.a,null)))))}}function gc(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-HomePage"),a.createElement(bc,e)}function fc(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}mc(bc,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,authStore:W.a.instanceOf(xe.a).isRequired,dispatcher:W.a.instanceOf(si.a).isRequired,history:W.a.instanceOf(Ne.a).isRequired,sampleQueriesStore:W.a.instanceOf(dc.a).isRequired,weblabStore:W.a.instanceOf(li.b).isRequired});class _c extends a.Component{static async willRouteTo(e,t){if(e.queryStore.reset(),e.sampleQueriesStore.sampleQueries.isEmpty()){const r=Object(dc.b)(e,t);return e.api.fetchSampleQueries(r)}}render(){return a.createElement(gc,null)}}fc(_c,"getPageTitle",()=>Object(f.b)(e=>e.home.pageTitle)),fc(_c,"getPageMetaDescription",()=>Object(f.b)(e=>e.home.metaDescription)),fc(_c,"getCanonicalUrl",()=>"/");var yc=r(671),Ec=r(375),Oc=r(390),Sc=r(398);function vc(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Cc extends a.PureComponent{renderPaperLink(){const{linkOpenInNewTab:e,paper:t}=this.props,{id:r,slug:a,title:o}=t;if(e){const e=Object(ye.d)({routeName:"PAPER_DETAIL",params:{paperId:r,slug:a}});return n.a.createElement(ya.a,{href:e},n.a.createElement("span",{className:"paper-lite__metadata-title"},o))}return n.a.createElement(Ve.a,{"data-selenium-selector":"title-link",to:"PAPER_DETAIL",params:{paperId:r,slug:a}},n.a.createElement("span",{className:"paper-lite__metadata-title"},o))}render(){const{displayAbstract:e,paper:t}=this.props,{authors:r,paperAbstract:a,venue:o,year:i}=t;return n.a.createElement("div",null,this.renderPaperLink(),n.a.createElement("div",{className:"paper-lite__metadata"},n.a.createElement(Oc.a,{authors:r}),o?n.a.createElement("span",{className:"paper-lite__metadata-item"},"  ",o):null,i?n.a.createElement("span",{className:"paper-lite__metadata-item"},"  ",i):null,e?n.a.createElement(Sc.a,{className:"text--preline abstract",text:a.text,limit:250,truncateByDefault:!0}):null))}}vc(Cc,"propTypes",{paper:W.a.instanceOf(we.a).isRequired,displayAbstract:W.a.bool,linkOpenInNewTab:W.a.bool}),vc(Cc,"defaultProps",{displayAbstract:!1,linkOpenInNewTab:!1});r(187);var wc=r(327),Pc=r(127);function xc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Rc(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Nc extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r);const{tagStore:n}=this.context;this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xc(Object(r),!0).forEach((function(t){Rc(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromTagStore()),n.registerComponent(this,()=>{this.setState(this.getStateFromTagStore())}),this.handleEdit=this.handleEdit.bind(this)}getStateFromTagStore(){const{tagStore:e}=this.context;return{tags:e.getTags()}}handleEdit(){const{entry:e}=this.props;this.context.dispatcher.dispatch(Object(Br.b)({id:Ur.b.EDIT_TAGS,data:{entryIds:ce.a.List([e.id])}}))}render(){const{onDelete:e,onChange:t,entry:r,isSelected:a}=this.props,{tags:o}=this.state,i=r.tagIds.map(e=>o.get(e)).sortBy(e=>e.name);return n.a.createElement("li",{className:"library-entry__container"},n.a.createElement(Ec.a,{layout:"row"},n.a.createElement("div",{className:"library-entry__select"},n.a.createElement("input",{type:"checkbox",className:"legacy__input",onChange:()=>{t(r.id)},checked:a,"aria-label":r.paper.title})),n.a.createElement(Ec.a,{layout:"column"},n.a.createElement(Cc,{paper:r.paper,displayAbstract:!0}),n.a.createElement(ie.c,{feature:ia.b.LibraryTags},n.a.createElement(ie.b,null,n.a.createElement(Ec.a,{layout:"row",wrap:!0},i.map(e=>n.a.createElement(Ve.a,{className:"library-entry__tag",key:e.id,to:"LIBRARY_TAG",params:{tagName:encodeURIComponent(e.name)}},e.name)),n.a.createElement("a",{className:"library-entry__tag tag__outlined add-edit-tag",onClick:this.handleEdit},r.tagIds.isEmpty()?Li.a.getString("library.addTags"):Li.a.getString("library.editTags")))))),n.a.createElement(m.a,{className:"remove-icon",icon:"library-entry-remove",width:"14",height:"14",onClick:()=>{e(r.id)}})))}}Rc(Nc,"contextTypes",{dispatcher:W.a.instanceOf(Vr.Dispatcher).isRequired,tagStore:W.a.instanceOf(Pc.a).isRequired});var jc=r(429),Tc=r(573),Ac=r(133);function Ic(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Fc extends a.Component{constructor(){super(...arguments),this.handleOptionClick=this.handleOptionClick.bind(this)}handleOptionClick(){const{onClick:e,selectType:t}=this.props;e(t)}render(){const{selectType:e}=this.props;return n.a.createElement("li",{className:"library-entries-page__select-option",onClick:this.handleOptionClick},Ac.d.toDisplayText(e))}}Ic(Fc,"propTypes",{onClick:W.a.func.isRequired,selectType:W.a.string.isRequired});class kc extends a.PureComponent{constructor(){super(...arguments),this.state={expanded:!1},this.toggleExpandState=this.toggleExpandState.bind(this),this.handleOptionClick=this.handleOptionClick.bind(this)}toggleExpandState(){this.setState(e=>{let{expanded:t}=e;return{expanded:!t}})}handleOptionClick(e){this.props.onSelect(e),this.toggleExpandState()}render(){const{expanded:e}=this.state,{indeterminate:t,onCheckboxClick:r,checked:a}=this.props,o=e?jc.a.Direction.UP:jc.a.Direction.DOWN;return n.a.createElement("div",{className:"library-entries-page__select-container"},n.a.createElement("div",{className:"flex-row-centered"},n.a.createElement(Tc.a,{ariaLabel:"library-entry-select",checked:a,onChange:r,indeterminate:t}),n.a.createElement(jc.a,{className:"flex-static",onClick:this.toggleExpandState,direction:o,width:"14",height:"14"}),e?n.a.createElement("ul",{className:"library-entries-page__select-options"},Ac.d.displayable().map(e=>n.a.createElement(Fc,{key:e,onClick:this.handleOptionClick,selectType:e}))):null))}}function Dc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Lc(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Ic(kc,"propTypes",{indeterminate:W.a.bool.isRequired,onCheckboxClick:W.a.func.isRequired,onSelect:W.a.func.isRequired,checked:W.a.bool.isRequired});const Mc={checkboxChecked:!1,selectedEntryIds:ce.a.Set()};class qc extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r);const{currentQuery:n}=this.props;this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Dc(Object(r),!0).forEach((function(t){Lc(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({queryValue:n.q,selectedSort:Ac.e.RECENCY},Mc),this.handleCheckboxClick=this.handleCheckboxClick.bind(this),this.handleClearSearch=this.handleClearSearch.bind(this),this.handleDeleteEntry=this.handleDeleteEntry.bind(this),this.handleDeleteSelectedEntries=this.handleDeleteSelectedEntries.bind(this),this.handleEntryCheckboxClick=this.handleEntryCheckboxClick.bind(this),this.handleFilterSubmit=this.handleFilterSubmit.bind(this),this.handleFilterTextChange=this.handleFilterTextChange.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleSelectClick=this.handleSelectClick.bind(this),this.handleSortChange=this.handleSortChange.bind(this),this.openEditTagsModal=this.openEditTagsModal.bind(this)}openEditTagsModal(){const{entries:e}=this.props,{selectedEntryIds:t}=this.state;this.context.dispatcher.dispatch(Object(Br.b)({id:Ur.b.EDIT_TAGS,data:{entryIds:e.filter(e=>t.includes(e.id)).map(e=>e.id)}}))}someEntriesSelected(){const{entries:e}=this.props,{selectedEntryIds:t}=this.state;return!t.isEmpty()&&t.size<e.size}handleKeyDown(e){13===e.keyCode&&this.handleFilterSubmit()}handleFilterSubmit(){const{fetchEntriesForQuery:e,tag:t}=this.props,{queryValue:r,selectedSort:a}=this.state;e(Object(Ac.b)({q:r,sort:a,tag:t?t.id:null}),!1,()=>this.setState(Mc))}handleFilterTextChange(e){this.setState({queryValue:e.target.value})}handleSortChange(e){this.setState({selectedSort:e.target.value},this.handleFilterSubmit)}handleClearSearch(){this.setState({queryValue:""},this.handleFilterSubmit)}handleCheckboxClick(){const{entries:e}=this.props;this.setState(t=>{let{checkboxChecked:r}=t;return{checkboxChecked:!r,selectedEntryIds:r?ce.a.Set():ce.a.Set(e.map(e=>{let{id:t}=e;return t}))}})}handleSelectClick(e){const{entries:t}=this.props;switch(e){case Ac.d.ALL:this.setState({selectedEntryIds:ce.a.Set(t.map(e=>{let{id:t}=e;return t})),checkboxChecked:!0});break;case Ac.d.NONE:this.setState({selectedEntryIds:ce.a.Set(),checkboxChecked:!1});break;default:w.a.error("Selected a select type that does not exist in LibrarySelect. This is likely a programming error.")}}handleEntryCheckboxClick(e){this.setState(t=>{let{selectedEntryIds:r}=t;return{selectedEntryIds:r.has(e)?r.delete(e):r.add(e)}})}handleDeleteEntry(e){this.props.deleteEntries(ce.a.Set.of(e))}handleDeleteSelectedEntries(){this.props.deleteEntries(this.state.selectedEntryIds)}renderEntries(){const{currentQuery:e,totalPages:t,entries:r}=this.props,{selectedEntryIds:a}=this.state;return n.a.createElement("div",{className:"library-entry-list__container"},n.a.createElement("ul",{className:"library-entry-list__entries"},r.map(e=>n.a.createElement(Nc,{key:e.id,entry:e,onDelete:()=>this.handleDeleteEntry(e.id),onChange:this.handleEntryCheckboxClick,isSelected:a.has(e.id)}))),t>1?n.a.createElement(cs.a,{loadPage:this.props.loadPage,pageNumber:e.page,totalPages:t}):null)}renderLoading(){return n.a.createElement("div",{className:"loading-controls"},n.a.createElement(Ce.a,null)," ",Object(f.b)(e=>e.library.loadingIndicator))}render(){const{isLoading:e,totalHits:t,tag:r,currentQuery:o,entries:i}=this.props,{checkboxChecked:s,queryValue:l,selectedEntryIds:c,selectedSort:u}=this.state,{page:d,pageSize:h}=o||{page:null,pageSize:null},p=n.a.createElement("span",null,Object(f.b)(e=>e.library.noResultMessage,o.q),n.a.createElement(Ve.a,Wi.a.routeForQuery(o.q),'"',o.q,'"'),"?"),b=i.isEmpty()?p:null!==d&&null!==h&&null!==t?Object(f.b)(e=>e.library.count,Object(Oi.f)({page:d,pageSize:h,totalHits:t}),t):"";return n.a.createElement(a.Fragment,null,n.a.createElement(ie.c,{feature:ia.b.LibraryTags},n.a.createElement(ie.b,null,n.a.createElement("div",{className:"library-entries-page__header"},r?'Papers tagged with "'.concat(decodeURIComponent(r.name),'"'):"All Papers"))),n.a.createElement("div",{className:"flex-row-centered library-entries-page__filter-container"},n.a.createElement("div",{className:"flex-row-centered library-entries-page__filter"},n.a.createElement("input",{className:"legacy__input library-entries-page__filter-input",type:"text",placeholder:"Filter Papers",value:l,onKeyDown:this.handleKeyDown,onChange:this.handleFilterTextChange}),l?n.a.createElement("div",{className:"clear-icon",onClick:this.handleClearSearch},n.a.createElement(m.a,{width:"16",height:"16",icon:"clear-input"})):null,n.a.createElement("div",{className:"flex-row-centered library-entries-page__filter-icon",onClick:this.handleFilterSubmit},n.a.createElement(m.a,{icon:"filter",width:"30",height:"30"}))),n.a.createElement("div",{className:"library-entries-page__sort flex-row-centered"},n.a.createElement("span",{className:"library-entries-page__sort-text"},Object(f.b)(e=>e.library.sortByLabel)),n.a.createElement("div",{className:"select--no-styles library-entries-page__sort-options"},n.a.createElement("select",{className:"legacy__select",value:u,onChange:this.handleSortChange},Ac.e.all().map(e=>n.a.createElement("option",{key:e,value:e},Ac.e.toDisplayText(e))))))),n.a.createElement("div",{className:"flex-row-vcenter library-entries-page__actions-container"},n.a.createElement(kc,{onSelect:this.handleSelectClick,onCheckboxClick:this.handleCheckboxClick,checked:s,indeterminate:this.someEntriesSelected()}),n.a.createElement("div",{className:"library-entries-page__actions-buttons"},n.a.createElement(ie.c,{feature:ia.b.LibraryTags},n.a.createElement(ie.b,null,n.a.createElement(Bs.a,{className:"library-entries-page__edit-tags",disabled:c.isEmpty(),iconProps:{icon:"tag",width:"10",height:"10"},text:Object(f.b)(e=>e.library.editTags),onClick:this.openEditTagsModal}))),n.a.createElement(Bs.a,{className:"library-entries-page__delete-entries",disabled:c.isEmpty(),iconProps:{icon:"library-entry-remove",width:"10",height:"10"},text:Object(f.b)(e=>e.library.delete),onClick:this.handleDeleteSelectedEntries}))),n.a.createElement("p",{className:"library-entries-page__result-count"},b),e?this.renderLoading():this.renderEntries())}}Lc(qc,"contextTypes",{dispatcher:W.a.instanceOf(Vr.Dispatcher).isRequired});var Hc=r(548),zc=r(137),Uc=r(124),Bc=r(81),Vc=r.n(Bc),Yc=r(112),Wc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e};function Kc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qc(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Gc=function(e){function t(){return Kc(this,t),Qc(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.isStatic=function(){return this.context.router&&this.context.router.staticContext},t.prototype.componentWillMount=function(){V()(this.context.router,"You should not use <Redirect> outside a <Router>"),this.isStatic()&&this.perform()},t.prototype.componentDidMount=function(){this.isStatic()||this.perform()},t.prototype.componentDidUpdate=function(e){var t=Object(Yc.b)(e.to),r=Object(Yc.b)(this.props.to);Object(Yc.d)(t,r)?Vc()(!1,"You tried to redirect to the same route you're currently on: \""+r.pathname+r.search+'"'):this.perform()},t.prototype.computeTo=function(e){var t=e.computedMatch,r=e.to;return t?"string"==typeof r?Object(pl.a)(r,t.params):Wc({},r,{pathname:Object(pl.a)(r.pathname,t.params)}):r},t.prototype.perform=function(){var e=this.context.router.history,t=this.props.push,r=this.computeTo(this.props);t?e.push(r):e.replace(r)},t.prototype.render=function(){return null},t}(n.a.Component);Gc.propTypes={computedMatch:Te.a.object,push:Te.a.bool,from:Te.a.string,to:Te.a.oneOfType([Te.a.string,Te.a.object]).isRequired},Gc.defaultProps={push:!1},Gc.contextTypes={router:Te.a.shape({history:Te.a.shape({push:Te.a.func.isRequired,replace:Te.a.func.isRequired}).isRequired,staticContext:Te.a.object}).isRequired};var Xc=Gc;function Jc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Zc(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Jc(Object(r),!0).forEach((function(t){$c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function $c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const eu=Object.freeze({error:null});class tu extends a.PureComponent{constructor(){super(...arguments),this.state=Zc({currentQuery:Object(Ac.b)(),currentTag:null,selectedSort:Ac.e.RECENCY},this.getStateFromStores(),{},eu,{isLoading:!0});const{entryStore:e,tagStore:t}=this.context;e.registerComponent(this,()=>{this.setState(this.getStateFromStores())}),t.registerComponent(this,()=>{if(!t.isLoading()){const e=t.getTagFromName(t.currentTagName),r=e?e.id:null,a=r!==(this.state.currentQuery?this.state.currentQuery.tag:null),n={currentTag:t.getTagFromName(t.currentTagName),isLoading:!!a||this.state.isLoading};this.setState(n,()=>{setTimeout(()=>{this.fetchEntriesForQuery(Object(Ac.b)({tag:r}))},0)})}}),this.fetchEntriesForQuery=this.fetchEntriesForQuery.bind(this),this.deleteEntries=this.deleteEntries.bind(this),this.loadPage=this.loadPage.bind(this)}getStateFromStores(){const{entryStore:e,tagStore:t}=this.context;return{entries:e.getEntries().valueSeq().toList(),isInitialLoading:e.isUninitialized()||t.isUninitialized(),isLoading:e.isLoading()||t.isLoading(),totalHits:e.getTotalHits(),totalPages:e.getTotalPages()}}fetchEntriesForQuery(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};e.equals(this.state.currentQuery)&&!t||(this.setState(Zc({currentQuery:e},eu),()=>{this.context.api.getLibraryEntries(e).catch(e=>{this.setState({error:e})})}),r())}loadPage(e){const{currentQuery:t}=this.state;e!==t.page&&(ys.a.scrollTop(0),this.fetchEntriesForQuery(t.update("page",()=>e)))}deleteEntries(e){e.isEmpty()||this.context.api.deleteLibraryEntries(e).then(()=>{const{currentQuery:e,entries:t}=this.state,r=e.update("page",e=>0===t.size&&e>1?e-1:e);this.fetchEntriesForQuery(r,!0)}).catch(()=>{const e=Li.a.getString("library.message.delete_error.header"),t=Li.a.getString("library.message.delete_error.body"),r=n.a.createElement(Ve.a,{to:"LIBRARY",className:"library-link button button--secondary",onClick:()=>{this.context.messageStore.clearMessages()}},"View Your Library");this.context.messageStore.addError(t,e,r)})}renderEmptyListInstructions(){return n.a.createElement("div",{className:"library-entries-page__empty-library"},n.a.createElement("div",{className:"library-entries-page__header"},"Welcome to Your Semantic Scholar Library"),n.a.createElement("p",null,"Save and organize papers of interest to you. To get started, save a paper via the bookmark icon on a paper or search results page. Then, you can organize your library via tags."),n.a.createElement("img",{src:"/img/empty_library.png",srcSet:"/img/empty_library_2x.png 2x",alt:"empty library graphic"}))}renderEmptyTagInstructions(){const{currentTag:e}=this.state;return n.a.createElement("div",{className:"library-entries-page__empty-library"},n.a.createElement("div",{className:"library-entries-page__header"},'No Papers Tagged with "',e.name,'" Yet'),n.a.createElement("p",null,"To get started, add this tag to papers via the",n.a.createElement(Hc.a,{exact:!0,to:"LIBRARY"},"All Papers"),"page."),n.a.createElement("img",{src:"/img/empty_tag.png",srcSet:"/img/empty_tag_2x.png 2x",alt:"no tagged entries graphic"}))}renderLoading(){return n.a.createElement("div",{className:"loading-controls"},n.a.createElement(Ce.a,null)," Loading")}render(){const{currentQuery:e,currentTag:t,entries:r,isInitialLoading:a,isLoading:o,totalHits:i,totalPages:s}=this.state,{tagStore:l}=this.context,c=r.isEmpty()&&!t,u=r.isEmpty()&&t;return l.isLoading()||!l.currentTagName||l.getTagFromName(l.currentTagName)?a||o?n.a.createElement("div",{className:"library-entries-page",role:"main",id:"main-content"},this.renderLoading()):c&&""===e.q?n.a.createElement("div",{className:"library-entries-page",role:"main",id:"main-content"},this.renderEmptyListInstructions()):u?n.a.createElement("div",{className:"library-entries-page",role:"main",id:"main-content"},this.renderEmptyTagInstructions()):n.a.createElement("div",{className:"library-entries-page",role:"main",id:"main-content"},n.a.createElement(qc,{currentQuery:e,deleteEntries:this.deleteEntries,entries:r,fetchEntriesForQuery:this.fetchEntriesForQuery,isLoading:o,loadPage:this.loadPage,tag:t,totalHits:i,totalPages:s})):n.a.createElement(Xc,{to:"/me/library"})}}function ru(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-LibraryEntriesPage"),a.createElement(tu,e)}$c(tu,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,entryStore:W.a.instanceOf(zc.a).isRequired,messageStore:W.a.instanceOf(Uc.a).isRequired,tagStore:W.a.instanceOf(Pc.a).isRequired});class au extends a.Component{static async willRouteTo(e,t){let{tagStore:r}=e,{params:a}=t;const{tagName:n}=a;r.setCurrentTagName(n)}render(){return a.createElement(ru,null)}}var nu=r(380),ou=r(446);function iu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function su(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class lu extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r);const{tagStore:n}=this.context;this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?iu(Object(r),!0).forEach((function(t){su(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromTagStore()),n.registerComponent(this,()=>{this.setState(this.getStateFromTagStore())})}getStateFromTagStore(){const{tagStore:e}=this.context;return{isLoading:e.isLoading(),tags:e.getTags().sortBy(e=>e.name.toLowerCase())}}render(){const e=n.a.createElement(a.Fragment,null,this.state.tags.toList().map(e=>n.a.createElement(Ve.a,{className:"tag__item",key:e.id,to:"LIBRARY_TAG",params:{tagName:encodeURIComponent(e.name)}},e.name)),n.a.createElement(Ve.a,{className:"tag__manage",to:"LIBRARY_TAG_MANAGEMENT"},Object(f.b)(e=>e.library.tags.manage))),t=n.a.createElement("span",{className:"tag__label flex-justify-start flex-row-vcenter"},n.a.createElement(m.a,{icon:"tag-stack",width:"20",height:"20"}),n.a.createElement("span",null,Object(f.b)(e=>e.library.tags.tagButtonLabel))),r=this.props.location.pathname,o=new RegExp(ye.b.LIBRARY_TAG.replace(/:\w+/,"*")),i=r.includes(ye.b.LIBRARY_TAG_MANAGEMENT)||r.match(o);return n.a.createElement("div",{className:"library-sidebar__container"},n.a.createElement(Hc.a,{activeClassName:"is-active",className:"tag__section",exact:!0,to:"LIBRARY"},n.a.createElement("span",{className:"tag__label flex-justify-start flex-row-vcenter"},n.a.createElement(m.a,{icon:"fa-bookmark",width:"20",height:"20"}),n.a.createElement("span",null,Object(f.b)(e=>e.library.tags.libraryLink)))),n.a.createElement(ou.a,{className:"tag__section ".concat(i?"is-active":""),collapsibleContent:e,ignoreHash:!0,initialCollapseState:!i,label:t,showToggleIcon:!0}))}}su(lu,"contextTypes",{tagStore:W.a.instanceOf(Pc.a).isRequired});const cu={match:W.a.shape({params:W.a.object.isRequired,isExact:W.a.bool.isRequired,path:W.a.string.isRequired,url:W.a.string.isRequired}),location:W.a.shape({pathname:W.a.string.isRequired,search:W.a.string.isRequired,hash:W.a.string.isRequired,state:W.a.object}),history:W.a.shape({length:W.a.number.isRequired,action:W.a.string.isRequired,location:W.a.object.isRequired,search:W.a.string,hash:W.a.string,state:W.a.object,push:W.a.func.isRequired,replace:W.a.func.isRequired,go:W.a.func.isRequired,goBack:W.a.func.isRequired,goForward:W.a.func.isRequired,block:W.a.func.isRequired}),route:W.a.shape({component:W.a.func.isRequired,routes:W.a.arrayOf(W.a.object)})};function uu(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class du extends a.Component{render(){const{history:e}=this.context;return a.createElement(Pr.a,{className:"library-page"},a.createElement("div",{className:"library-page__header bg-light-gray"},a.createElement("h1",{className:"centered-max-width-content"},Object(f.b)(e=>e.library.headline))),a.createElement(Ec.a,{className:"library-page__container centered-max-width-content",layout:"row",position:"relative"},a.createElement(ie.c,{feature:ia.b.LibraryTags},a.createElement(ie.b,null,a.createElement(lu,{location:e.location}))),a.createElement(nu.a,null,Object(xr.b)(this.props.route.routes))))}}function hu(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-LibraryPage"),a.createElement(du,e)}function pu(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}uu(du,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,history:W.a.instanceOf(Ne.a).isRequired}),uu(du,"propTypes",cu);class mu extends a.Component{static async willRouteTo(e){let{tagStore:t,api:r}=e;if(t.isUninitialized())return r.getLibraryTags()}render(){return a.createElement(hu,this.props)}}pu(mu,"requiresAuthentication",()=>!0),pu(mu,"getPageTitle",()=>Object(f.b)(e=>e.library.pageTitle));var bu=r(571),gu=r(381);function fu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class yu extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r);const{tagStore:n}=this.context;this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fu(Object(r),!0).forEach((function(t){_u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({renameRequest:!1,renameTag:null},this.getStateFromTagStore()),n.registerComponent(this,()=>{this.setState(this.getStateFromTagStore())}),this.deleteLibraryTag=this.deleteLibraryTag.bind(this),this.focus=this.focus.bind(this),this.handleRenameBegin=this.handleRenameBegin.bind(this),this.handleRenameChange=this.handleRenameChange.bind(this),this.handleRenameKeyDown=this.handleRenameKeyDown.bind(this),this.handleRenameSubmit=this.handleRenameSubmit.bind(this),this.openDeleteModal=this.openDeleteModal.bind(this)}getStateFromTagStore(){const{tagStore:e}=this.context,{tag:t}=this.props;return{paperCount:e.getPaperCount(t.id)}}focus(){this.renameInput&&this.renameInput.focus()}deleteLibraryTag(e){const{api:t,messageStore:r}=this.context,{renameTag:a}=this.state,{DELETE_SUCCESS:n,DELETE_FAILURE:o}=Mi.a.Library.Tags;t.deleteLibraryTag(e).then(()=>{Object(qi.a)(gu.a.create(n,{tagId:e})),a&&a.id===e&&this.setState({renameTag:null})}).catch(()=>{Object(qi.a)(gu.a.create(o,{tagId:e}));const t=Object(f.b)(e=>e.library.message.errorDeleteTag.header),a=Object(f.b)(e=>e.library.message.errorDeleteTag.body);r.addError(a,t)})}updateLibraryTag(e){const{api:t,messageStore:r,tagStore:a}=this.context,{RENAME_SUCCESS:n,RENAME_FAILURE:o}=Mi.a.Library.Tags;if(a.hasTagByName(e.name)){const t=Object(f.b)(e=>e.library.message.duplicateTag.header),a=Object(f.b)(e=>e.library.message.duplicateTag.body,e.name);r.addWarning(a,t)}else this.setState({renameRequest:!0},()=>{t.updateLibraryTag({id:e.id,newName:e.name}).then(()=>{Object(qi.a)(gu.a.create(n,{tagId:e.id,tagName:e.name})),this.setState({renameRequest:!1,renameTag:null})}).catch(()=>{Object(qi.a)(gu.a.create(o,{tagId:e.id,tagName:e.name})),this.setState({renameRequest:!1});const t=Object(f.b)(e=>e.library.message.errorRenameTag.header),a=Object(f.b)(e=>e.library.message.errorRenameTag.body);r.addError(a,t)})})}openDeleteModal(e){this.context.dispatcher.dispatch(Object(Br.b)({id:Ur.b.DELETE_TAG,data:{deleteLibraryTag:this.deleteLibraryTag,tag:e}}))}handleRenameBegin(e){this.setState({renameTag:e}),this.focus()}handleRenameChange(e){const{renameTag:t}=this.state,r=Object(wc.a)(t);this.setState({renameTag:r.set("name",e.currentTarget.value)})}handleRenameKeyDown(e){13===e.keyCode?this.handleRenameSubmit():27===e.keyCode&&this.setState({renameTag:null})}handleRenameSubmit(){const{renameTag:e,renameRequest:t}=this.state;if(!e)return;const{tags:r}=this.props,a=r.get(e.id),n=e.name.replace(/\s+/g," ").trim();a.name===n?this.setState({renameTag:null}):""===n||t||this.updateLibraryTag(e)}renderRename(e){return n.a.createElement("div",{className:"flex-row-centered library-tags-page__rename"},n.a.createElement("input",{className:"legacy__input library-tags-page__rename-input",type:"text",ref:e=>this.renameInput=e,placeholder:"Rename Tag",value:e.name,onKeyDown:this.handleRenameKeyDown,onChange:this.handleRenameChange}),n.a.createElement("div",{className:"flex-row-centered library-tags-page__rename-update",onClick:this.handleRenameSubmit},Object(f.b)(e=>e.library.tags.updateNameButton)))}render(){const{tag:e}=this.props,{paperCount:t,renameTag:r}=this.state,o=r&&r.id===e.id;return n.a.createElement(Ec.a,{className:"library-tags-page__tag-row",layout:"row"},o?null:n.a.createElement("span",{className:"library-tags-page__tag"},e.name),n.a.createElement(Ec.a,{className:"flex-row-vcenter library-tags-page__tag-controls",layout:"row"},o?this.renderRename(r):n.a.createElement(a.Fragment,null,n.a.createElement("span",{className:"paper-count"},"".concat(t||"","\n                    ").concat(t&&1!==t?Object(f.b)(e=>e.library.tags.paperCountPlural):t?Object(f.b)(e=>e.library.tags.paperCountSingle):"")),n.a.createElement("div",{className:"rename-tag",onClick:()=>this.handleRenameBegin(e)},n.a.createElement(m.a,{icon:"pencil",width:"12",height:"12"}),n.a.createElement("span",null,Object(f.b)(e=>e.library.tags.renameButtonLabel)))),n.a.createElement("div",{className:"remove-tag",onClick:()=>this.openDeleteModal(e)},n.a.createElement(m.a,{icon:"small-x",width:"10",height:"10"}),n.a.createElement("span",null,Object(f.b)(e=>e.library.tags.removeButtonLabel)))))}}_u(yu,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,dispatcher:W.a.instanceOf(Vr.Dispatcher).isRequired,messageStore:W.a.instanceOf(Uc.a).isRequired,tagStore:W.a.instanceOf(Pc.a).isRequired});var Eu=Xc;function Ou(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Su(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class vu extends a.PureComponent{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r);const{tagStore:n}=this.context;this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ou(Object(r),!0).forEach((function(t){Su(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ou(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromTagStore()),n.registerComponent(this,()=>{this.setState(this.getStateFromTagStore())})}getStateFromTagStore(){const{tagStore:e}=this.context;return{isLoading:e.isLoading(),tags:e.getTags()}}renderEmptyTagList(){return n.a.createElement("div",{className:"library-entries-page__empty-tag-list"},n.a.createElement("div",{className:"library-entries-page__header"},"You Haven't Created Any Tags Yet"),n.a.createElement("p",null,"Tags help you organize the papers youve saved to your library. Once created, you can add multiple tags to a single paper, and filter by those tags."))}renderLoading(){return n.a.createElement("div",{className:"loading-controls"},n.a.createElement(Ce.a,null)," Loading")}render(){const{isLoading:e,tags:t}=this.state;return n.a.createElement(ie.c,{feature:ia.b.LibraryTags},n.a.createElement(ie.b,null,n.a.createElement("div",{className:"library-tags-page"},e?this.renderLoading():n.a.createElement(a.Fragment,null,t.isEmpty()?this.renderEmptyTagList():n.a.createElement("div",{className:"library-tags-page__header"},"Manage Tags"),n.a.createElement(bu.a,null),t.toList().map(e=>n.a.createElement(yu,{tag:e,tags:t,key:e.id}))))),n.a.createElement(ie.a,null,n.a.createElement(Eu,{to:ye.b.LIBRARY})))}}function Cu(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-LibraryTagManagementPage"),a.createElement(vu,e)}Su(vu,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,messageStore:W.a.instanceOf(Uc.a).isRequired,tagStore:W.a.instanceOf(Pc.a).isRequired});class wu extends a.Component{static async willRouteTo(e){let{api:t}=e;return t.getLibraryTagPaperCounts()}render(){return a.createElement(Cu,null)}}class Pu extends a.PureComponent{render(){const{navItems:e,activeRouteName:t}=this.props;return a.createElement("nav",{className:"moderation-nav"},a.createElement("ul",{className:"moderation-nav__list"},e.map((e,r)=>{let{routeName:n,params:o,label:i,itemCount:s}=e;const l=n===t;return a.createElement("li",{key:r,className:D()({"moderation-nav__item":!0,"moderation-nav__is-active":l})},a.createElement(Ve.a,{to:n,params:o||{}},i),"number"==typeof s&&a.createElement("div",{className:"moderation-nav__item__count"},s))})))}}function xu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Ru(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xu(Object(r),!0).forEach((function(t){Nu(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Nu(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ju extends a.Component{constructor(e,t){super(e,t),this.state=Ru({},this.getStateFromAuthorshipModerationStore(),{},this.getStateFromAuthorClaimModerationStore()),this.context.authorshipModerationStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorClaimModerationStore())}),this.context.claimModerationStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorClaimModerationStore())})}componentDidMount(){const{history:e}=this.context;if("MODERATION"===Object(ye.c)(e.location.pathname)){const t=new St.a(Ru({},this.pickRedirectRoute(),{replace:!0,status:302}));Object(Ot.a)({redirect:t,history:e})}}getStateFromAuthorshipModerationStore(){const{authorshipModerationStore:e}=this.context;return{numPendingAuthorshipCorrections:e.getPendingPaperAuthorCorrectionsCount()}}getStateFromAuthorClaimModerationStore(){const{claimModerationStore:e}=this.context;return{numPendingAuthorClaims:e.getPendingAuthorClaimCount()}}getActiveRouteName(){var e;const{history:t}=this.context,{route:r}=this.props,a=null!=(e=Object(xr.a)(r.routes,t.location.pathname))&&null!=(e=e[0])&&null!=(e=e.route)?e.path:e;return Object(ye.c)(a)||"MODERATION"}pickRedirectRoute(){return{routeName:"AUTHOR_CLAIM_MODERATION",params:{status:"pending"}}}getNavItems(){const{numPendingAuthorshipCorrections:e,numPendingAuthorClaims:t}=this.state;return[{routeName:"AUTHOR_CLAIM_MODERATION",params:{status:"pending"},label:Object(f.b)(e=>e.moderation.nav.authorClaimLabel),itemCount:t},{routeName:"AUTHOR_AUTHORSHIP_MODERATION",params:{status:"pending"},label:Object(f.b)(e=>e.moderation.nav.authorshipLabel),itemCount:e},{routeName:"AUTHOR_CORRECTIONS_TOOL",label:Object(f.b)(e=>e.moderation.nav.correctionsToolLabel),itemCount:null}]}render(){const{route:e}=this.props,t=this.getNavItems(),r=this.getActiveRouteName();return a.createElement(Pr.a,{header:a.createElement(wr.a,{isAdminPage:!0}),footer:!1},a.createElement("div",{className:"moderation",role:"main"},a.createElement("h2",{className:"moderation__header"},Object(f.b)(e=>e.moderation.headerLabel)),a.createElement(Pu,{navItems:t,activeRouteName:r}),a.createElement("div",{className:"moderation__sub-page"},Object(xr.b)(e.routes))))}}function Tu(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-ModerationPage"),a.createElement(ju,e)}function Au(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Nu(ju,"contextTypes",{authorshipModerationStore:W.a.instanceOf(Us.a).isRequired,claimModerationStore:W.a.instanceOf(Oa.a).isRequired,history:W.a.instanceOf(Ne.a).isRequired});class Iu extends a.Component{static async willRouteTo(e){let{api:t}=e;return t.fetchModerationStats()}render(){return a.createElement(Tu,this.props)}}Au(Iu,"getPageTitle",()=>Object(f.b)(e=>e.moderation.pageTitle)),Au(Iu,"requiresAuthentication",()=>!0);var Fu=r(388);function ku(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Du(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Lu extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),Du(this,"onSubmitForm",()=>{this.setState({isSending:!0}),this.verifyAuthorId().then(()=>{const{authorCorrectionsStore:e}=this.context,t=this.state.authorId;if(!this.state.errorMessage){t&&e.setModeratorCorrectionsAuthorId(t),e.setIsModeratorCorrecting(!0),this.setState({isSending:!1});const{history:r}=this.context;r.push(Object(ye.d)({routeName:"AUTHOR_CORRECTIONS_TOOL_CONTACT"}))}})}),Du(this,"onChangeInput",e=>{this.setState({authorId:parseInt(e,10)})}),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ku(Object(r),!0).forEach((function(t){Du(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ku(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({isSending:!1,errorMessage:null,successMessage:null,hasAttemptedSubmit:!1},this.getStateFromAuthorCorrectionsStore()),this.context.authorCorrectionsStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorCorrectionsStore())})}getStateFromAuthorCorrectionsStore(){const{authorCorrectionsStore:e}=this.context;return{authorId:e.getModeratorCorrectionsAuthorId()}}async verifyAuthorId(){const{api:e}=this.context,t=this.state.authorId;if(t)try{await e.fetchAuthorDetail(t,null,!1),this.setState({errorMessage:""})}catch(e){this.setState({errorMessage:"The author id is not valid"})}}renderMessage(){const{errorMessage:e}=this.state;return e?a.createElement("div",{className:"account__error-msg"},e):null}render(){const{authorId:e,isSending:t}=this.state;return a.createElement("div",{className:"moderator-corrections__author-id"},a.createElement(Fu.a,{name:"authorId",label:Object(f.b)(e=>e.moderatorCorrections.input.label),className:"standard-form",isRequired:!0,value:e?e.toString():"",onChange:this.onChangeInput,placeholder:"This author id will be used to make corrections"}),a.createElement(o,null,a.createElement(l,null,this.renderMessage()),a.createElement(s,null,t&&a.createElement(m.a,{className:"account__loading",icon:"gear"}),a.createElement("button",{className:"account-author-contact__submit-button button button--primary",onClick:this.onSubmitForm},Object(f.b)(e=>e.account.button.submit)))))}}function Mu(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-ModeratorAuthorCorrectionsInputPage"),a.createElement(Lu,e)}Du(Lu,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,authStore:W.a.instanceOf(xe.a).isRequired,authorCorrectionsStore:W.a.instanceOf(z.a).isRequired,history:W.a.instanceOf(Ne.a).isRequired});class qu extends a.Component{render(){return a.createElement(Mu,null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(qu,"getPageTitle",()=>Object(f.b)(e=>e.moderatorCorrections.input.pageTitle));var Hu=r(560);function zu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Uu(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Bu extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?zu(Object(r),!0).forEach((function(t){Uu(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.getStateFromAuthorCorrectionsStore()),this.context.authorCorrectionsStore.registerComponent(this,()=>{this.setState(this.getStateFromAuthorCorrectionsStore())})}getStateFromAuthorCorrectionsStore(){const{authorCorrectionsStore:e}=this.context;return{moderatorCorrectionsAuthorId:e.getModeratorCorrectionsAuthorId()||null}}componentWillUnmount(){const{authorCorrectionsStore:e}=this.context;e.resetModeratorCorrections()}getNavSections(){const{moderatorCorrectionsAuthorId:e}=this.state,t=[],r={label:Object(f.b)(e=>e.moderatorCorrections.authorCorrectionsTool.sectionLabel),links:[{routeName:"AUTHOR_CORRECTIONS_TOOL_AUTHOR_INPUT",label:Object(f.b)(e=>e.moderatorCorrections.authorCorrectionsTool.navLabel)}]},a=[{routeName:"AUTHOR_CORRECTIONS_TOOL_CONTACT",label:Object(f.b)(e=>e.account.page.authorContact.navLabel)},{routeName:"AUTHOR_CORRECTIONS_TOOL_REMOVE_PAPERS",label:Object(f.b)(e=>e.account.page.removePapers.navLabel)},{routeName:"AUTHOR_CORRECTIONS_TOOL_ADD_PAPERS",label:Object(f.b)(e=>e.account.page.addPapers.navLabel)},{routeName:"AUTHOR_CORRECTIONS_TOOL_STATUS",label:Object(f.b)(e=>e.account.page.corrections.navLabel)}];return e&&a.map(e=>r.links.push(e)),t.push(r),t}getActiveRouteName(){var e;const{history:t}=this.context,{route:r}=this.props,a=null!=(e=Object(xr.a)(r.routes,t.location.pathname))&&null!=(e=e[0])&&null!=(e=e.route)?e.path:e;return Object(ye.c)(a)||"AUTHOR_CORRECTIONS_TOOL"}render(){return a.createElement("div",{className:"author-corrections-tool"},a.createElement("div",{className:"account__columns"},a.createElement("div",{className:"account__column nav-bar__container"},a.createElement(Hu.a,{activeRouteName:this.getActiveRouteName(),navSections:this.getNavSections()})),a.createElement("div",{className:"account__column account__page"},Object(xr.b)(this.props.route.routes))))}}function Vu(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-ModeratorAuthorCorrectionsToolPage"),a.createElement(Bu,e)}Uu(Bu,"contextTypes",{api:W.a.instanceOf(fe.a).isRequired,authorCorrectionsStore:W.a.instanceOf(z.a).isRequired,history:W.a.instanceOf(Ne.a).isRequired});class Yu extends a.Component{render(){return a.createElement(Vu,this.props)}}var Wu=r(679),Ku=r(658),Qu=r(680),Gu=r(648),Xu=r(643),Ju=r(644);function Zu(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class $u extends a.PureComponent{trackShareEvent(e){const t=zi.a.create(Mi.a.SHARE,{socialType:e.id});Object(qi.a)(t)}onClickShareLink(e){this.trackShareEvent(e);const t=encodeURIComponent("".concat(window.location.href,"?utm_source=").concat(e.id)),r=encodeURIComponent(this.props.title),a=this.props.message?"".concat(encodeURIComponent(this.props.message),": ").concat(t):t;let n;switch(e){case Ju.a.EMAIL:n="mailto:?subject=".concat(r,"&body=").concat(a);break;case Ju.a.FACEBOOK:n=Object(Xu.a)(t);break;case Ju.a.REDDIT:n=Object(Xu.getRedditShareUrl)(t,r);break;case Ju.a.TWITTER:n=Object(Xu.c)(t,r)}e!==Ju.a.EMAIL?window.open(n,"_blank","left=100,top=100,width=800,height=500,toolbar=1,resizable=0"):window.location.href=n}render(){const e=Ju.a.shareOptions().map((e,t)=>{const r=D()("".concat(e.id," share-option flex-row-vcenter"),this.props.linkClassName);return n.a.createElement("li",{className:r,onClick:this.onClickShareLink.bind(this,e),key:t},n.a.createElement(m.a,{icon:e.id,width:"25",height:"25"}),e.name)});return n.a.createElement("ul",null,e)}}Zu($u,"propTypes",{className:W.a.string,linkClassName:W.a.string,message:W.a.string}),Zu($u,"contextTypes",{dispatcher:W.a.instanceOf(si.a).isRequired});var ed=r(392);function td(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class rd extends a.PureComponent{render(){const e=D()("share-button button",this.props.className);return n.a.createElement(ed.a,{tooltipContent:n.a.createElement($u,{message:this.props.message,title:this.props.title}),tooltipPosition:this.props.tooltipPosition,className:"share flex-row-vcenter",tooltipClassName:"share-tooltip"},n.a.createElement(Bs.a,{className:e,text:"Share",iconProps:{icon:"share",width:"15",height:"15"}}))}}td(rd,"propTypes",{title:W.a.string.isRequired,message:W.a.string,className:W.a.string,tooltipPosition:W.a.string}),td(rd,"defaultProps",{tooltipPosition:"bottom-left"});var ad=r(132),nd=r(632),od=r.n(nd);class id extends n.a.Component{constructor(){super(...arguments),this.onClickBackground=this.onClickBackground.bind(this),this.onClickClose=this.onClickClose.bind(this),this.onStartVideo=this.onStartVideo.bind(this)}onClickBackground(e){e.stopPropagation();const{target:t}=e;t instanceof HTMLElement&&t.className.split(" ").find(e=>"pdp-video"===e)&&this.closeModal()}onClickClose(e){e.stopPropagation(),this.closeModal()}onStartVideo(){const e=this.getVideo();if(!e)return;const{uniqueId:t,url:r}=e;Object(qi.a)(zi.a.create(Mi.a.PaperDetail.VIDEO_START,{uniqueId:t,url:r}))}closeModal(){const{history:e,paperStore:t}=this.context,{slug:r,id:a}=t.getPaperDetail().paper,n=Object(ye.d)({routeName:"PAPER_DETAIL",params:{slug:r,paperId:a}});e.replace(n)}getVideo(){const{paperStore:e}=this.context,{featuredContent:t}=e.getPaperDetail(),{uniqueId:r}=this.props;return r&&t.find(e=>e.uniqueId===r)||null}render(){const e=this.getVideo();if(!e)return null;const{title:t,url:r,summary:a,channel:o,datePosted:i}=e,s=Object(f.b)(e=>e.paperDetail.featured.video.shareTitle,t);return n.a.createElement("div",{className:"pdp-video",onClick:this.onClickBackground},n.a.createElement("a",{className:"close-modal-link flex-row-vcenter",onClick:this.onClickClose},n.a.createElement("span",null,Object(f.b)(e=>e.paperDetail.featured.video.closeButtonLabel)),n.a.createElement(m.a,{icon:"x",className:"flex-right",width:"30",height:"30"})),n.a.createElement("div",{className:"pdp-video__modal"},n.a.createElement(Ec.a,null,n.a.createElement(nu.a,null,n.a.createElement("h4",{className:"pdp-video__title text--lg"},t),n.a.createElement("div",{className:"flex-row flex-center flex-space-between pdp-video__publish-info"},n.a.createElement("ul",null,o&&n.a.createElement("li",{className:"pdp-video__publish-info-item"},o),i&&n.a.createElement("li",{className:"pdp-video__publish-info-item"},i.format("MMM Do, YYYY"))),n.a.createElement(rd,{title:s,className:"button--primary flex-right",tooltipPosition:"bottom-right"})))),n.a.createElement("div",{className:"pdp-video__video"},n.a.createElement(od.a,{controls:!0,url:r,height:480,width:800,onStart:this.onStartVideo})),n.a.createElement("div",{className:"pdp-video__summary"},a)))}}function sd(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-PaperDetailVideoPage"),a.createElement(id,e)}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(id,"contextTypes",{history:W.a.instanceOf(Ne.a).isRequired,paperStore:W.a.instanceOf(ad.a).isRequired});class ld extends a.Component{static getCanonicalUrl(e){if(e.params.slug){const{paperId:t,slug:r,uniqueId:a}=e.params;return Object(ye.d)({routeName:"PAPER_DETAIL_VIDEO",params:{paperId:t,slug:r,uniqueId:a}})}}render(){var e;const t=(null!=(e=this.props)&&null!=(e=e.match)&&null!=(e=e.params)?e.uniqueId:e)||null;return a.createElement(sd,{uniqueId:t})}}var cd=r(672);class ud extends a.PureComponent{static willRouteTo(){return new St.a({path:"https://research.semanticscholar.org",replace:!0,status:302})}render(){return null}}var dd=r(689),hd=r(449),pd=r(474);function md(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class bd extends a.PureComponent{constructor(){super(...arguments),this.state=this.getStateFromQueryStore(),this.handleToggleClick=this.handleToggleClick.bind(this),this.context.queryStore.registerComponent(this,()=>{this.setState(this.getStateFromQueryStore())})}getStateFromQueryStore(){const e=this.context.queryStore.getCurrentYearRange(),t=(new Date).getUTCFullYear(),r=t-5;return{isSelected:this.getIsSelected(e,r,t),isDisabled:this.getIsDisabled(r,t),currentYear:t,fiveYearsAgo:r}}getIsSelected(e,t,r){return e.min===t&&e.max===r}getIsDisabled(e,t){const{years:r,filteredYears:a}=this.props;return 0===(a.isEmpty()?r:a).filter(r=>r.year>=e&&r.year<=t).reduce((e,t)=>e+t.count,0)}handleToggleClick(){const{queryStore:e,router:t}=this.context,{currentYear:r,fiveYearsAgo:a,isSelected:n}=this.state;n?e.routeToYearRange(null,null,t):e.routeToYearRange(a,r,t)}render(){const{isSelected:e,isDisabled:t}=this.state;return n.a.createElement(pd.a,{isSelected:e,isDisabled:t,text:Object(f.b)(e=>e.serp.toggle.year.title),seleniumSelector:"last-five-years",onToggle:this.handleToggleClick})}}md(bd,"contextTypes",{router:W.a.object.isRequired,queryStore:W.a.instanceOf(Ki.a).isRequired}),md(bd,"propTypes",{filteredYears:W.a.instanceOf(ce.a.List).isRequired,years:W.a.instanceOf(ce.a.List).isRequired});var gd=r(543);function fd(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const _d=Yi.PUBLICATION_TYPE.id;class yd extends a.PureComponent{constructor(){super(...arguments),this.state=this.getStateFromQueryStore(),this.handleToggleClick=this.handleToggleClick.bind(this),this.context.queryStore.registerComponent(this,()=>{this.setState(this.getStateFromQueryStore())})}getDisabledStatus(){const e=this.props.publicationTypes.find(e=>"Reviews"===e.value);return!this.state.isSelected&&(!e||0===e.documentCount)}getStateFromQueryStore(){return{isSelected:this.context.queryStore.isFilterActive(_d,"Reviews")}}handleToggleClick(){const{queryStore:e,router:t}=this.context;e.routeToToggleFilter(_d,"Reviews",t)}render(){return n.a.createElement(pd.a,{isSelected:this.state.isSelected,isDisabled:this.getDisabledStatus(),text:Object(f.b)(e=>e.serp.toggle.review.title),seleniumSelector:"reviews",onToggle:this.handleToggleClick})}}function Ed(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}fd(yd,"contextTypes",{router:W.a.object.isRequired,queryStore:W.a.instanceOf(Ki.a).isRequired}),fd(yd,"propTypes",{publicationTypes:W.a.instanceOf(ce.a.OrderedSet).isRequired});const Od=Yi.EXTERNAL_CONTENT_TYPE.id;class Sd extends a.PureComponent{constructor(){super(...arguments),this.state=this.getStateFromQueryStore(),this.handleToggleClick=this.handleToggleClick.bind(this),this.context.queryStore.registerComponent(this,()=>{this.setState(this.getStateFromQueryStore())})}getDisabledStatus(){const e=this.props.externalContentTypes.find(e=>"video"===e.value);return!this.state.isSelected&&(!e||0===e.documentCount)}getStateFromQueryStore(){return{isSelected:this.context.queryStore.isFilterActive(Od,"video")}}handleToggleClick(){const{queryStore:e,router:t}=this.context;e.routeToToggleFilter(Od,"video",t)}render(){return n.a.createElement(pd.a,{isSelected:this.state.isSelected,isDisabled:this.getDisabledStatus(),text:Object(f.b)(e=>e.serp.toggle.video.title),seleniumSelector:"has-video-toggle",onToggle:this.handleToggleClick})}}function vd(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Ed(Sd,"contextTypes",{router:W.a.object.isRequired,queryStore:W.a.instanceOf(Ki.a).isRequired}),Ed(Sd,"propTypes",{externalContentTypes:W.a.instanceOf(ce.a.OrderedSet).isRequired});function Cd(e,t){return t.size>5?n.a.createElement(Ii.a,{label:Yi.findById(e).displayName,lessText:"Fewer"},r=>n.a.createElement(Fi.a,{maxLabelLength:30,collapsible:!1,filterType:e,displayDocCount:!0,filters:t.take(r?t.size:5)})):n.a.createElement(Fi.a,{maxLabelLength:30,displayDocCount:!0,collapsible:!1,filterType:e,filters:t})}class wd extends a.PureComponent{constructor(){super(...arguments),this.setYearRange=this.setYearRange.bind(this)}setYearRange(e,t){const{queryStore:r,router:a}=this.context;r.routeToYearRange(e,t,a)}render(){const{availableFilters:e}=this.props,t=e.get("publicationTypes"),r=e.get("authors"),a=e.get("venues"),o=e.get("externalContentTypes");return n.a.createElement(Ec.a,{className:"flex-row"},n.a.createElement(nu.a,{className:"fresh-filters__filter_container",width:"25"},t?Cd(Yi.PUBLICATION_TYPE.id,t):null),n.a.createElement(nu.a,{className:"fresh-filters__filter_container",width:"25"},o.isEmpty()?null:Cd(Yi.EXTERNAL_CONTENT_TYPE.id,o)),n.a.createElement(nu.a,{className:"fresh-filters__filter_container",width:"25"},r.isEmpty()?null:Cd(Yi.AUTHOR.id,r)),n.a.createElement(nu.a,{className:"fresh-filters__filter_container",width:"25"},a.isEmpty()?null:Cd(Yi.VENUE.id,a)))}}vd(wd,"propTypes",{availableFilters:W.a.object.isRequired}),vd(wd,"contextTypes",{queryStore:W.a.instanceOf(Ki.a).isRequired,router:W.a.object.isRequired});var Pd=r(542);function xd(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Rd extends a.PureComponent{constructor(){super(...arguments),this.state={filtersAreExpanded:!1},this.toggleFilters=this.toggleFilters.bind(this)}toggleFilters(){this.setState(e=>({filtersAreExpanded:!e.filtersAreExpanded}))}render(){const{response:e,layoutOptions:t,query:r}=this.props,{filtersAreExpanded:a}=this.state,o=e.stats.get("publicationTypes")||ce.a.OrderedSet(),i=e.stats.get("externalContentTypes")||ce.a.OrderedSet();return n.a.createElement("div",{className:"fresh-filters"},n.a.createElement("div",{className:"fresh-filters__controls"},n.a.createElement("div",{className:"centered-max-width-content"},n.a.createElement(Ec.a,{className:"flex-row-vcenter fresh-filters__flex-container"},n.a.createElement(nu.a,{className:"fresh-filters__filter_container fresh-filters__filter_container--has-right-border"},n.a.createElement(gd.a,{response:e})),n.a.createElement(bd,{years:e.stats.get("years"),filteredYears:e.stats.get("filteredYears")||new ce.a.List}),n.a.createElement(yd,{publicationTypes:o}),n.a.createElement(hd.a,{isToggle:!0}),n.a.createElement(Sd,{externalContentTypes:i}),n.a.createElement(nu.a,null,n.a.createElement("button",{"data-selenium-selector":"more-search-filters",onClick:this.toggleFilters,className:"link-button fresh-filters__filters_button button"},n.a.createElement("span",null,a?"Fewer":"More"," Filters"))),n.a.createElement("div",{className:"fresh-filters__display-controls"},n.a.createElement(nu.a,{className:"fresh-filters__sort-control"},n.a.createElement(Pd.a,{className:"select--no-styles",labelText:"Sort By",onChangeSort:this.props.onChangeSort,options:t.sorts,displayType:t.sortDisplayType,sort:r.sort})))))),a?n.a.createElement("div",{className:"fresh-filters__drawer","data-selenium-selector":"fresh-filters"},n.a.createElement("div",{className:"centered-max-width-content fresh-filters__drawer-pointer-container"},n.a.createElement("span",{className:"fresh-filters__drawer-pointer tooltip-pointer"},n.a.createElement("span",{className:"tooltip-pointer-arrow"})),n.a.createElement(wd,{availableFilters:e.stats}))):null)}}xd(Rd,"propTypes",{isFiltering:W.a.bool.isRequired,layoutOptions:W.a.object.isRequired,response:W.a.object.isRequired,query:W.a.object.isRequired,onChangeSort:W.a.func.isRequired}),xd(Rd,"contextTypes",{queryStore:W.a.instanceOf(Ki.a).isRequired,weblabStore:W.a.instanceOf(li.b).isRequired});var Nd=r(645),jd=r(675);function Td(e){let{title:t,authors:r,published:a,url:o}=e;return n.a.createElement("li",{className:"slide-item truncate-line"},n.a.createElement(ya.a,{className:"slide-title",href:o},t),n.a.createElement("p",{className:"slide-info"},function(e){return e.size>1?"".concat(e.first()," + ").concat(e.size-1," ").concat(""," "):1===e.size?"".concat(e.first()," ").concat(""," "):""}(r),$r.a.unix(a).utc().format("MMM DD, YYYY")))}Td.propTypes={title:W.a.string.isRequired,authors:W.a.instanceOf(ce.a.List).isRequired,published:W.a.number.isRequired,url:W.a.string.isRequired};var Ad=Td;class Id extends a.PureComponent{constructor(e,t){super(e,t),this.state={collapsed:!0,canToggle:e.slides.size>2},this.toggle=this.toggle.bind(this)}toggle(){this.setState(e=>{let{collapsed:t}=e;return{collapsed:!t}})}render(){const{slides:e}=this.props,{canToggle:t,collapsed:r}=this.state,a=e.take(r?3:e.size);return n.a.createElement("ul",{className:"slide-list"},a.map(e=>{let{id:t,title:r,authors:a,published:o,url:i}=e;return n.a.createElement(Ad,{key:t,title:r,authors:a,published:o,url:i})}),t?n.a.createElement("li",{className:"mod-clickable link-button",onClick:this.toggle},"Show ",r?"More":"Fewer"):null)}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Id,"propTypes",{slides:W.a.instanceOf(ce.a.List).isRequired});class Fd extends a.PureComponent{componentDidMount(){Object(qi.a)(ns.a.create(Mi.a.Serp.MATCHED_SLIDES))}render(){const{queryString:e,slides:t}=this.props;return n.a.createElement(rs.a,{title:"Slides related to ".concat(e),icon:"slides-list"},n.a.createElement(Id,{slides:t}))}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Fd,"propTypes",{queryString:W.a.string.isRequired,slides:W.a.instanceOf(ce.a.List).isRequired});var kd=r(646),Dd=r(541);class Ld extends a.PureComponent{render(){const e=this.props.sorts.map((e,t)=>n.a.createElement("div",{className:"sort-explanation-description",key:t},n.a.createElement("h4",{className:"flex-row-vcenter"},n.a.createElement(m.a,{icon:e.icon,width:"15",height:"15",className:"sort-explanation-icon"}),n.a.createElement("span",null,Li.a.getString("sort.".concat(e.id,".title")))),n.a.createElement("span",{className:"sort-explanation-text",dangerouslySetInnerHTML:{__html:Li.a.getString("sort.".concat(e.id,".description"))}}))),t=n.a.createElement("div",{className:"sort-explanation-tooltip-content"},e);return n.a.createElement(ed.a,{tooltipPosition:"bottom-right",className:"flex-right sort-explanation-tooltip",tooltipContent:t},n.a.createElement("div",{className:"flex-row-vcenter"},n.a.createElement("span",{className:"sort-explanation-text-label"},"Learn More"),n.a.createElement(Dd.a,null)))}}function Md(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Ld,"propTypes",{sorts:W.a.instanceOf(ce.a.List).isRequired});class qd extends a.PureComponent{constructor(){super(),this.onChangeSort=this.onChangeSort.bind(this)}onChangeSort(e){this.context.queryStore.routeToSort(e,this.context.router)}render(){return n.a.createElement("div",{className:"controls"},this.props.showResultCount?this.props.isFiltering?n.a.createElement("div",{className:"flex-row-vcenter"},n.a.createElement(Ce.a,{seleniumSelector:"icon-loading-serp"})," Updating results"):n.a.createElement(gd.a,{response:this.props.response}):null,n.a.createElement("div",{className:"controls-right flex-row"},n.a.createElement(Pd.a,{onChangeSort:this.onChangeSort,options:this.props.sorts,displayType:this.props.sortDisplayType,sort:this.props.query.sort})),this.props.showSortExplanation?n.a.createElement(Ld,{sorts:this.props.sorts}):null)}}Md(qd,"contextTypes",{queryStore:W.a.instanceOf(Ki.a).isRequired,router:W.a.object.isRequired}),Md(qd,"propTypes",{isFiltering:W.a.bool,query:W.a.object.isRequired,response:W.a.object.isRequired,showResultCount:W.a.bool,sortDisplayType:W.a.string,showSortExplanation:W.a.bool,sorts:W.a.instanceOf(ce.a.List)});var Hd=r(547);function zd(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ud extends a.PureComponent{constructor(e,t){super(e,t),this.state=this.stateFromQueryStore(),this.context.queryStore.registerComponent(this,()=>{this.setState(this.stateFromQueryStore())}),this.histogramCallback=this.histogramCallback.bind(this)}histogramCallback(e,t){const{queryStore:r,router:a}=this.context;r.routeToYearRange(e,t,a)}stateFromQueryStore(){return{yearFilter:this.context.queryStore.getQuery().yearFilter}}render(){const{availableFilters:e,isAuthorHomePage:t}=this.props,r=e.get("authors"),a=e.get("coAuthors"),o=e.get("venues"),i=e.get("publicationTypes"),s=e.get("externalContentTypes");return n.a.createElement("div",{className:"filters-wrapper"},n.a.createElement("h4",{className:"filter-header"},"Filter Results:"),n.a.createElement(hd.a,null),t&&n.a.createElement(Hd.a,{analyticsEvent:Mi.a.Serp.YEAR_SLIDER,years:e.get("years"),filteredYears:e.get("filteredYears")||new le.List,isMobile:!1,filterCallback:this.histogramCallback,histogramWidth:200,histogramHeight:50,yearFilter:this.state.yearFilter}),s.isEmpty()?null:n.a.createElement(Fi.a,{filterType:"externalContentType",filters:s}),i.isEmpty()?null:n.a.createElement(Fi.a,{filterType:"publicationType",filters:i}),r.isEmpty()?null:n.a.createElement(Fi.a,{filterType:"author",filters:r}),a.isEmpty()?null:n.a.createElement(Fi.a,{filterType:"coAuthor",filters:a}),o.isEmpty()?null:n.a.createElement(Fi.a,{maxLabelLength:qs.a.data.MAX_VENUE_LENGTH,filterType:"venue",filters:o}))}}zd(Ud,"contextTypes",{queryStore:W.a.instanceOf(Ki.a).isRequired,router:W.a.object.isRequired}),zd(Ud,"propTypes",{availableFilters:W.a.object.isRequired,isAuthorHomePage:W.a.bool});class Bd extends a.PureComponent{constructor(){super(...arguments)}render(){return a.createElement(ie.c,{feature:ia.b.RecommenderSerpAd},a.createElement(ie.b,null,a.createElement("a",{href:"https://s2-sanity.apps.allenai.org",target:"_blank","data-heap-id":"recommender-ad-call-to-action",className:"recommender-ad","data-selenium-selector":"recommender-ad"},a.createElement("div",{className:"recommender-ad__content-container"},a.createElement("div",{className:"recommender-ad__title"},"Start Your Personalized Research Feed"),a.createElement("div",{className:"recommender-ad__description"},"Want to stay up-to-date and spend less time searching for the latest Computer Science research? Get exclusive access to Semantic Sanity: a personalized adaptive arXiv feed created by Semantic Scholar."),a.createElement("span",{className:"recommender-ad__call-to-action button button--primary"},"TRY THE BETA")))))}}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Bd,"contextTypes",{iconStore:W.a.instanceOf(gi.a).isRequired});var Vd=r(103),Yd=r(61);function Wd(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Kd=a.createContext({isFirstFeedLink:!1});class Qd extends a.PureComponent{constructor(){super(...arguments),Wd(this,"trackSwap",(e,t)=>{const{query:{page:r},response:{results:a}}=this.props;if(this.context.weblabStore.isFeatureEnabled(ia.b.SerpSwapAtTen)&&1===r){const e=this.swapResults(a),r={swapIndex:this.state.swapIndex,clickIndex:t,rawCandidates:a.map(e=>e.id),swappedCandidates:e.map(e=>e.id)};Object(Vd.a)(Mi.a.Serp.SWAP,r)}}),Wd(this,"swapResults",e=>e),Wd(this,"loadPage",e=>{e!==this.props.query.page&&(ys.a.scrollTop(this.props.layoutOptions.scrollToTopOfPage?0:ys.a.offsetFromBody(Cs.a.findDOMNode(this))),this.context.queryStore.routeToPage(e,this.context.router))}),Wd(this,"onChangeSort",e=>{const{queryStore:t,router:r}=this.context;t.routeToSort(e,r)}),Wd(this,"onChangeYearFilter",(e,t)=>{const{queryStore:r,router:a}=this.context;r.routeToYearRange(e,t,a)});const e=this.props.response.results.size;this.state={swapIndex:Math.floor(Math.random()*Math.min(10,e))}}componentWillReceiveProps(e){const t=this.props.response.results,r=e.response.results;if(!t.equals(r)){const t=e.response.results.size;this.setState({swapIndex:Math.floor(Math.random()*Math.min(10,t))})}}componentDidUpdate(e){if(!ce.a.is(e.response,this.props.response)&&!this.props.response.results.isEmpty()){const e=ys.a.scrollTop(),t=this.refs["search-result-".concat(this.props.response.results.size-1)];if(t){const r=ys.a.offsetFromBody(t);r<e&&ys.a.scrollTop(r-20)}}}buildResultNodes(e){const{query:t,layoutOptions:{searchResultLayout:r}}=this.props;return e.map((e,n)=>a.createElement(Kd.Provider,{key:e.id,value:{isFirstFeedLink:0===n}},a.createElement(ie.c,{feature:ia.b.SharedPaperRow,key:e.id},a.createElement(ie.b,null,()=>a.createElement(Pi.c,{paper:e,eventData:{index:(t.page-1)*t.pageSize+n},onHoverStats:!0},a.createElement(Ri.default,{paper:e,className:"serp-papers__paper-row",controls:a.createElement(xi.default,{paper:e,actions:a.createElement(Ci.default,{paper:e,library:a.createElement(wi.default,{paper:e,seleniumSelector:"paper-action-save"})})})}))),a.createElement(ie.a,null,()=>a.createElement(gs,{result:e,key:e.id,index:(t.page-1)*t.pageSize+n,onTitleClick:this.trackSwap,layout:r})))))}renderResults(){const{response:{results:e},query:t}=this.props,r=this.context.weblabStore.isFeatureEnabled(ia.b.SerpSwapAtTen)&&1===t.page?this.swapResults(e):e;return this.buildResultNodes(r)}renderNoResults(){const{querySuggestions:e}=this.props.response,t=!(e&&!e.isEmpty())?void 0:e.first().text;return a.createElement(Ti.a,{query:this.props.query.queryString,hasFacets:this.props.response.hasFacets(),suggestedQuery:t})}renderAHPSerp(){const{response:e,isFiltering:t,layoutOptions:r,query:n,isAuthorHomePage:o}=this.props,{results:i,stats:s,matchedAuthors:l}=e;return a.createElement("section",{className:"content"},a.createElement(Ni.a,null,a.createElement(fs.a,{className:"filter",side:"left"},a.createElement("div",{ref:"filters"},e.hasFacets()?a.createElement(Ud,{availableFilters:s,isAuthorHomePage:o}):null)),a.createElement(ts.a,{className:"results"},l.isEmpty()?null:a.createElement(ls,{queryString:n.queryString,authors:l}),i.isEmpty()?null:a.createElement(qd,{query:n,response:e,isFiltering:t,showResultCount:r.showResultCount,sortDisplayType:r.sortDisplayType,showSortExplanation:r.showSortExplanation,sorts:r.sorts}),a.createElement("div",{className:D()("result-page",{"is-filtering":t})},i.isEmpty()?this.renderNoResults():this.renderResults()),a.createElement("div",{className:"flex-row"},a.createElement(cs.a,{className:"flex-right",loadPage:this.loadPage,pageNumber:n.page,totalPages:e.totalPages})))))}renderFreshSerpContent(){const{response:e,isFiltering:t,layoutOptions:r,isCompact:n,query:o}=this.props,{matchedAuthors:i,totalPages:s,stats:l,matchedEntity:c,modifiedQueryString:u,matchedPresentations:d}=e;return a.createElement("div",{className:D()("fresh-serp",{"fresh-serp--compact":n})},a.createElement(ji.a,{experiment:qr.b.SerpFilterRedesignPhase1},a.createElement(ji.b,null,a.createElement(Rd,{isFiltering:t,layoutOptions:r,onChangeSort:this.onChangeSort,onChangeYearFilter:this.onChangeYearFilter,query:o,response:e})),a.createElement(ji.c,{variation:qr.b.SerpFilterRedesignPhase1.Variation.DROPDOWN},a.createElement(dd.a,{isFiltering:t,layoutOptions:r,onChangeSort:this.onChangeSort,onChangeYearFilter:this.onChangeYearFilter,query:o,response:e}))),a.createElement(Ec.a,{layoutMed:"column-reverse",className:"centered-max-width-content",role:"main",id:"main-content"},a.createElement(nu.a,{width:"66",className:"flex-item__left-column",seleniumSelector:"results"},i.isEmpty()?null:a.createElement(Nd.a,{queryString:o.queryString,authors:i}),u?a.createElement(kd.a,{originalQuery:e.query.queryString,modifiedQuery:u}):null,a.createElement("div",{className:D()("result-page",{"is-filtering":t})},this.renderResults()),a.createElement(cs.a,{className:"flex-right",loadPage:this.loadPage,pageNumber:o.page,totalPages:s})),a.createElement(nu.a,{width:"33",className:"flex-item__right-column"},a.createElement(Bd,null),a.createElement(ji.a,{experiment:qr.b.SerpFilterRedesignPhase1,isolated:!0},a.createElement(ji.b,null,l.get("years").size>1?a.createElement(rs.a,{title:Li.a.getString("serp.histogram.title"),icon:"bar-chart",className:"histogram"},a.createElement(ki.a,{analyticsEvent:Mi.a.Serp.YEAR_SLIDER,filterCallback:this.onChangeYearFilter,filters:l,yearFilter:o.yearFilter,yearBuckets:null,showPresetButtons:!0})):null)),c?a.createElement(jd.a,{entity:c}):null,!d.isEmpty()&&i.isEmpty()?a.createElement(Fd,{queryString:o.queryString,slides:d}):null)))}renderFreshSerpNoResults(){const{isFiltering:e}=this.props;return a.createElement("div",{className:"fresh-serp"},a.createElement(Ec.a,{className:"centered-max-width-content",role:"main",id:"main-content"},a.createElement(nu.a,{width:"66",className:"flex-item__left-column"},a.createElement("div",{className:D()("result-page",{"is-filtering":e})},this.renderNoResults()))))}renderSerp(){return this.props.response.results.isEmpty()?this.renderFreshSerpNoResults():this.renderFreshSerpContent()}render(){return this.props.isAuthorHomePage?this.renderAHPSerp():this.renderSerp()}}function Gd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Xd(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Wd(Qd,"contextTypes",{queryStore:W.a.instanceOf(Ki.a).isRequired,router:W.a.object.isRequired,userPrefsStore:W.a.instanceOf(Yd.b).isRequired,weblabStore:W.a.instanceOf(li.b).isRequired}),Wd(Qd,"propTypes",{isAuthorHomePage:W.a.bool,isFiltering:W.a.bool,isCompact:W.a.bool.isRequired,query:W.a.object.isRequired,response:W.a.object.isRequired,layoutOptions:W.a.object.isRequired});class Jd extends a.PureComponent{constructor(){super(...arguments),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Gd(Object(r),!0).forEach((function(t){Xd(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gd(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.stateFromQueryStore()),this.context.queryStore.registerComponent(this,()=>{this.setState(this.stateFromQueryStore())})}stateFromQueryStore(){return{queryStoreState:this.context.queryStore._state,query:this.context.queryStore._query,response:this.context.queryStore._response,isCompact:!0}}render(){const{queryStoreState:e,query:t,response:r,isCompact:n}=this.state;return e===Ss.a.LOADING||e===Ss.a.INITIALIZED?a.createElement("section",{className:"content",role:"main",id:"main-content"},a.createElement("div",{className:"container loading-controls flex-row-vcenter"},a.createElement(Ce.a,{seleniumSelector:"icon-loading-serp"})," Loading results")):a.createElement(Qd,{isAuthorHomePage:this.props.isAuthorHomePage,isCompact:n,query:t,response:r,layoutOptions:this.props.layoutOptions,isFiltering:e===Ss.a.FILTERING})}}Xd(Jd,"contextTypes",{queryStore:W.a.instanceOf(Ki.a).isRequired,weblabStore:W.a.instanceOf(li.b).isRequired}),Xd(Jd,"propTypes",{isAuthorHomePage:W.a.bool,layoutOptions:W.a.object.isRequired});var Zd=r(130),$d=r(17);function eh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function th(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const rh=Object(Ns.a)(Mi.a.Serp)(wr.a),ah=Object(Ns.a)(Mi.a.Serp)(Jd);class nh extends a.Component{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];super(e,...r),this.state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?eh(Object(r),!0).forEach((function(t){th(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eh(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.stateFromQueryStore()),this.context.queryStore.registerComponent(this,()=>{this.setState(this.stateFromQueryStore())})}stateFromQueryStore(){return{isLoading:this.context.queryStore.isLoading()}}render(){const{isLoading:e}=this.state,t=new Ji;return a.createElement(Pr.a,{className:"search",header:a.createElement(rh,{showSearchBar:!0,submitSearchOnFieldOfStudyChange:!0}),footer:!e},a.createElement(ah,{layoutOptions:t}))}}function oh(e){const{bundlePreloader:t}=Object(ze.c)();return t.addChunkByName("desktop-SearchResultsPage"),a.createElement(nh,e)}th(nh,"contextTypes",{alertsStore:W.a.instanceOf(Zd.a).isRequired,api:W.a.instanceOf(fe.a).isRequired,authStore:W.a.instanceOf(xe.a).isRequired,feedApi:W.a.instanceOf($d.a).isRequired,queryStore:W.a.instanceOf(Ki.a).isRequired});class ih extends a.Component{static getPageTitle(e){let{queryStore:t}=e;const r=t.getQueryString();return r?Object(f.b)(e=>e.serp.pageTitleWithQuery,r):Object(f.b)(e=>e.serp.pageTitleWithoutQuery)}static async willRouteTo(e,t){const{api:r,authStore:a,feedApi:n}=e,{query:{serverSideSearch:o}}=t;if(!Object(De.a)()&&!o)return Ki.a.setQueryAndLoadingState(e,t);const i=a.hasAuthenticatedUser()?n.getFeeds():Promise.resolve(),s=Ki.a.executeSearchQuery(e,t),l=await Promise.all([s,i]),c=l[0];if(!c.resultData)return c;const{matchedEntity:u}=c.resultData;return a.hasAuthenticatedUser()&&u?[...l,r.findAlertByQueryTypeAndValue(Hs.c.ENTITY_PAPER,u.id)]:l}render(){return a.createElement(oh,null)}}var sh=r(681),lh=r(673),ch=r(674),uh=r(647);t.default=[Object(uh.a)({component:fa.a,routes:[Object(uh.a)({path:ye.b.HOME,exact:!0,component:_c}),Object(uh.a)({path:ye.b.ENTITY_LANDING,exact:!0,component:Ul.a}),Object(uh.a)({path:ye.b.ENTITY_BY_ID,exact:!0,component:Bl.a}),Object(uh.a)({path:ye.b.ENTITY,component:Vl.a}),Object(uh.a)({path:ye.b.SEARCH,component:ih}),Object(uh.a)({path:ye.b.PAPER_LANDING,exact:!0,component:cd.a}),Object(uh.a)({path:ye.b.PAPER_DETAIL_BY_ID,exact:!0,component:Qu.a}),Object(uh.a)({path:ye.b.PAPER_DETAIL_PDF_REDIRECT,exact:!0,component:Qu.a}),Object(uh.a)({path:ye.b.PAPER_DETAIL_CITED_BY,component:Qu.a}),Object(uh.a)({path:ye.b.PAPER_DETAIL_REFERENCES,component:Qu.a}),Object(uh.a)({path:ye.b.PAPER_DETAIL,component:Gu.a,routes:[Object(uh.a)({path:ye.b.PAPER_DETAIL_FIGURE,component:Ku.a}),Object(uh.a)({path:ye.b.PAPER_DETAIL_VIDEO,component:ld})]}),Object(uh.a)({path:ye.b.AUTHOR_ONBOARDING,component:bi,routes:[Object(uh.a)({path:ye.b.AUTHOR_ONBOARDING_PROFILE,component:Xo}),Object(uh.a)({path:ye.b.AUTHOR_ONBOARDING_REMOVE_PAPERS,component:ai}),Object(uh.a)({path:ye.b.AUTHOR_ONBOARDING_ADD_PAPERS,component:ko}),Object(uh.a)({path:ye.b.AUTHOR_ONBOARDING_COMPLETE,component:Uo})]}),Object(uh.a)({path:ye.b.ADMIN_EXPERIMENT_AUDIT,component:oa}),Object(uh.a)({path:ye.b.ADMIN,component:Ir,routes:[Object(uh.a)({path:ye.b.ADMIN_EXPERIMENTS,component:Jr}),Object(uh.a)({path:ye.b.ADMIN_FEATURE_FLAGS,component:pa})]}),Object(uh.a)({path:ye.b.MODERATION,component:Iu,routes:[Object(uh.a)({path:ye.b.AUTHOR_CLAIM_MODERATION,component:yo}),Object(uh.a)({path:ye.b.AUTHOR_AUTHORSHIP_MODERATION,component:Zs}),Object(uh.a)({path:ye.b.AUTHOR_CORRECTIONS_TOOL,component:Yu,routes:[Object(uh.a)({path:ye.b.AUTHOR_CORRECTIONS_TOOL_AUTHOR_INPUT,component:qu}),Object(uh.a)({path:ye.b.AUTHOR_CORRECTIONS_TOOL_CONTACT,component:jt}),Object(uh.a)({path:ye.b.AUTHOR_CORRECTIONS_TOOL_REMOVE_PAPERS,component:Sr}),Object(uh.a)({path:ye.b.AUTHOR_CORRECTIONS_TOOL_ADD_PAPERS,component:Be}),Object(uh.a)({path:ye.b.AUTHOR_CORRECTIONS_TOOL_STATUS,component:$t})]})]}),Object(uh.a)({path:ye.b.AUTHOR_LANDING,exact:!0,component:So.a}),Object(uh.a)({path:ye.b.AUTHOR_PROFILE_BY_CLAIMED,component:Oo.a}),Object(uh.a)({path:ye.b.AUTHOR_CLAIM,component:Eo.a}),Object(uh.a)({path:ye.b.AUTHOR_CLAIM_COMPLETE,component:_a.a}),Object(uh.a)({path:ye.b.AUTHOR_PROFILE_BY_ID,exact:!0,component:zs}),Object(uh.a)({path:ye.b.AUTHOR_PROFILE,component:zs}),Object(uh.a)({path:ye.b.CREATE_ALERT,component:ul}),Object(uh.a)({path:ye.b.ALERTS,component:ga}),Object(uh.a)({path:ye.b.ALERTS_UNSUBSCRIBE,component:lh.a}),Object(uh.a)({path:ye.b.ALERTS_UNSUBSCRIBE_ALL,component:lh.a}),Object(uh.a)({path:ye.b.LIBRARY,component:mu,routes:[Object(uh.a)({path:ye.b.LIBRARY,exact:!0,component:au}),Object(uh.a)({path:ye.b.LIBRARY_TAG_MANAGEMENT,exact:!0,component:wu}),Object(uh.a)({path:ye.b.LIBRARY_TAG,component:au})]}),Object(uh.a)({path:ye.b.FEEDS,exact:!0,component:Ql.a}),Object(uh.a)({path:ye.b.FEEDS_FEED,component:Gl.a,routes:[Object(uh.a)({path:ye.b.FEEDS_RATED,component:Xl.a}),Object(uh.a)({path:ye.b.FEEDS_RECOMMENDATIONS,component:Zl.a})]}),Object(uh.a)({path:ye.b.FEEDS_FTUE,component:Jl.a}),Object(uh.a)({path:ye.b.ACCOUNT,component:rr.a,routes:[Object(uh.a)({path:ye.b.ACCOUNT_AUTHOR_CLAIM_PENDING,component:Ge}),Object(uh.a)({path:ye.b.ACCOUNT_AUTHOR_UNCLAIM_SUCCESS,component:It}),Object(uh.a)({path:ye.b.ACCOUNT_AUTHOR_CONTACT,component:jt}),Object(uh.a)({path:ye.b.ACCOUNT_ALERTS,component:ma.a}),Object(uh.a)({path:ye.b.ACCOUNT_REMOVE_PAPERS,component:Sr}),Object(uh.a)({path:ye.b.ACCOUNT_ADD_PAPERS,component:Be}),Object(uh.a)({path:ye.b.ACCOUNT_CORRECTIONS,component:$t}),Object(uh.a)({path:ye.b.ACCOUNT_CONTACT,component:er.a}),Object(uh.a)({path:ye.b.ACCOUNT_MANAGE,component:tr.a})]}),Object(uh.a)({path:ye.b.USER_VERIFY_EMAIL,component:ch.a}),Object(uh.a)({path:ye.b.SIGN_IN,component:sh.a}),Object(uh.a)({path:ye.b.ADD_ENROLLMENT_REDIRECT,component:vr.a}),Object(uh.a)({path:ye.b.CRAWLER,component:il}),Object(uh.a)({path:ye.b.FAQ,component:Kl}),Object(uh.a)({path:ye.b.CORD19_HOME,exact:!0,component:$s.a}),Object(uh.a)({path:ye.b.CORD19_ABOUT,component:el.a}),Object(uh.a)({path:ye.b.CORD19_GET_STARTED,component:rl.a}),Object(uh.a)({path:ye.b.CORD19_DOWNLOAD,component:tl.a}),Object(uh.a)({path:ye.b.DEBUG_COMPONENT_LIBRARY,exact:!0,component:Dl}),Object(uh.a)({path:ye.b.DEBUG_COMPONENT_LIBRARY_COMPONENT,component:Dl}),Object(uh.a)({path:ye.b.DEBUG_COMPONENT_LIBRARY_PREVIEW,component:Ll.a}),Object(uh.a)({path:ye.b.DEBUG_SILO_VIEWER,component:yc.a}),Object(uh.a)({path:ye.b.DEBUG_SPRITES,component:zl}),Object(uh.a)({path:ye.b.RESEARCH,exact:!0,component:ud}),Object(uh.a)({path:ye.b.NOT_FOUND,exact:!0,component:Wu.a}),Object(uh.a)({component:Wu.a})]})]}}]);
//# sourceMappingURL=bundle-5.js.map